<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title><![CDATA[å¯’æµâ€˜s Blog]]></title>
  <subtitle><![CDATA[ç¼–ç¨‹ä¸ç”Ÿæ´»]]></subtitle>
  <link href="/atom.xml" rel="self"/>
  <link href="http://koalahl.github.io/"/>
  <updated>2017-09-05T13:40:55.000Z</updated>
  <id>http://koalahl.github.io/</id>
  
  <author>
    <name><![CDATA[Han Liu]]></name>
    <email><![CDATA[hanangellove@icloud.com]]></email>
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title><![CDATA[è…¾è®¯SNGæŸéƒ¨é—¨iOSé¢è¯•ç»å†]]></title>
    <link href="http://koalahl.github.io/2017/09/05/%E8%85%BE%E8%AE%AFSNG%E6%9F%90%E9%83%A8%E9%97%A8iOS%E9%9D%A2%E8%AF%95%E7%BB%8F%E5%8E%86/"/>
    <id>http://koalahl.github.io/2017/09/05/è…¾è®¯SNGæŸéƒ¨é—¨iOSé¢è¯•ç»å†/</id>
    <published>2017-09-05T13:30:55.000Z</published>
    <updated>2017-09-05T13:40:55.000Z</updated>
    <content type="html"><![CDATA[<p>è…¾è®¯SNGé¢è¯•ï¼Œç®—æ˜¯ç§¯æ”’ä¸€æ¬¡é¢è¯•ç»éªŒäº†ã€‚å¯ä»¥çœ‹å‡ºï¼Œé«˜çº§å·¥ç¨‹å¸ˆä¸ä»…è¦ä¼šç”¨ä¸€äº›å¸¸ç”¨åº“ï¼Œè¿˜è¦æ‡‚å¾—å®ƒä»¬çš„åŸç†ã€‚</p>
<a id="more"></a>
<p>1.APPæ€§èƒ½ä¼˜åŒ–ï¼šå†…å­˜æ³„éœ²æ£€æµ‹ï¼Œ è‡ªå·±åšåº”è¯¥æ€ä¹ˆåšï¼Ÿå¡é¡¿æ£€æµ‹-CADisplayLink</p>
<p>å¼€æºå·¥å…·ï¼š</p>
<ul>
<li><a href="https://github.com/facebook/FBRetainCycleDetector" target="_blank" rel="external">FBRetainCycleDetector</a></li>
<li><a href="http://blog.csdn.net/qq_29696849/article/details/51374165" target="_blank" rel="external">MLeaksFinder</a></li>
</ul>
<p><a href="https://wereadteam.github.io/2016/05/03/WeRead-Performance/" target="_blank" rel="external">å¾®ä¿¡è¯»ä¹¦ iOS æ€§èƒ½ä¼˜åŒ–æ€»ç»“</a></p>
<p>2.AsycDisplayKit åŸç†ã€‚</p>
<p><a href="https://github.com/facebookarchive/AsyncDisplayKit" target="_blank" rel="external">AsyncDisplayKit</a>æ˜¯ Facebook æ¨å‡ºçš„ç”¨äºä¿æŒç•Œé¢æµç•…æ€§çš„æ¡†æ¶ï¼Œå…¶åŸç†å¤§è‡´å¦‚ä¸‹ï¼š<br>UI çº¿ç¨‹ä¸­ä¸€æ—¦å‡ºç°ç¹é‡çš„ä»»åŠ¡å°±ä¼šå¯¼è‡´ç•Œé¢å¡é¡¿ï¼Œè¿™ç±»ä»»åŠ¡é€šå¸¸åˆ†ä¸º3ç±»ï¼šæ’ç‰ˆï¼Œç»˜åˆ¶ï¼ŒUIå¯¹è±¡æ“ä½œã€‚<br>æ’ç‰ˆé€šå¸¸åŒ…æ‹¬è®¡ç®—è§†å›¾å¤§å°ã€è®¡ç®—æ–‡æœ¬é«˜åº¦ã€é‡æ–°è®¡ç®—å­å¼å›¾çš„æ’ç‰ˆç­‰æ“ä½œã€‚</p>
<p>ç»˜åˆ¶ä¸€èˆ¬æœ‰æ–‡æœ¬ç»˜åˆ¶ (ä¾‹å¦‚ CoreText)ã€å›¾ç‰‡ç»˜åˆ¶ (ä¾‹å¦‚é¢„å…ˆè§£å‹)ã€å…ƒç´ ç»˜åˆ¶ (Quartz)ç­‰æ“ä½œã€‚<br>UIå¯¹è±¡æ“ä½œé€šå¸¸åŒ…æ‹¬ UIView/CALayer ç­‰ UI å¯¹è±¡çš„åˆ›å»ºã€è®¾ç½®å±æ€§å’Œé”€æ¯ã€‚</p>
<p>å…¶ä¸­å‰ä¸¤ç±»æ“ä½œå¯ä»¥é€šè¿‡å„ç§æ–¹æ³•æ‰”åˆ°åå°çº¿ç¨‹æ‰§è¡Œï¼Œè€Œæœ€åä¸€ç±»æ“ä½œåªèƒ½åœ¨ä¸»çº¿ç¨‹å®Œæˆï¼Œå¹¶ä¸”æœ‰æ—¶åé¢çš„æ“ä½œéœ€è¦ä¾èµ–å‰é¢æ“ä½œçš„ç»“æœ ï¼ˆä¾‹å¦‚TextViewåˆ›å»ºæ—¶å¯èƒ½éœ€è¦æå‰è®¡ç®—å‡ºæ–‡æœ¬çš„å¤§å°ï¼‰ã€‚ASDK æ‰€åšçš„ï¼Œå°±æ˜¯å°½é‡å°†èƒ½æ”¾å…¥åå°çš„ä»»åŠ¡æ”¾å…¥åå°ï¼Œä¸èƒ½çš„åˆ™å°½é‡æ¨è¿Ÿ (ä¾‹å¦‚è§†å›¾çš„åˆ›å»ºã€å±æ€§çš„è°ƒæ•´)ã€‚<br>ä¸ºæ­¤ï¼ŒASDK åˆ›å»ºäº†ä¸€ä¸ªåä¸º ASDisplayNode çš„å¯¹è±¡ï¼Œå¹¶åœ¨å†…éƒ¨å°è£…äº† UIView/CALayerï¼Œå®ƒå…·æœ‰å’Œ UIView/CALayer ç›¸ä¼¼çš„å±æ€§ï¼Œä¾‹å¦‚ frameã€backgroundColorç­‰ã€‚æ‰€æœ‰è¿™äº›å±æ€§éƒ½å¯ä»¥åœ¨åå°çº¿ç¨‹æ›´æ”¹ï¼Œå¼€å‘è€…å¯ä»¥åªé€šè¿‡ Node æ¥æ“ä½œå…¶å†…éƒ¨çš„ UIView/CALayerï¼Œè¿™æ ·å°±å¯ä»¥å°†æ’ç‰ˆå’Œç»˜åˆ¶æ”¾å…¥äº†åå°çº¿ç¨‹ã€‚ä½†æ˜¯æ— è®ºæ€ä¹ˆæ“ä½œï¼Œè¿™äº›å±æ€§æ€»éœ€è¦åœ¨æŸä¸ªæ—¶åˆ»åŒæ­¥åˆ°ä¸»çº¿ç¨‹çš„ UIView/CALayer å»ã€‚</p>
<p>ASDK ä»¿ç…§ QuartzCore/UIKit æ¡†æ¶çš„æ¨¡å¼ï¼Œå®ç°äº†ä¸€å¥—ç±»ä¼¼çš„ç•Œé¢æ›´æ–°çš„æœºåˆ¶ï¼šå³åœ¨ä¸»çº¿ç¨‹çš„ RunLoop ä¸­æ·»åŠ ä¸€ä¸ª Observerï¼Œç›‘å¬äº† kCFRunLoopBeforeWaiting å’Œ kCFRunLoopExit äº‹ä»¶ï¼Œåœ¨æ”¶åˆ°å›è°ƒæ—¶ï¼Œéå†æ‰€æœ‰ä¹‹å‰æ”¾å…¥é˜Ÿåˆ—çš„å¾…å¤„ç†çš„ä»»åŠ¡ï¼Œç„¶åä¸€ä¸€æ‰§è¡Œã€‚</p>
<p>å…·ä½“çš„ä»£ç å¯ä»¥çœ‹è¿™é‡Œï¼š_ASAsyncTransactionGroupã€‚</p>
<p>3.Crash ï¼ŒBugæ”¶é›† SDKçš„åŸç†ï¼Œè‡ªå·±åšåº”è¯¥æ€ä¹ˆåšï¼Ÿ</p>
<p>æ³¨å†ŒNSSetUncaughtExceptionHandlerï¼ŒåŒ…æ‹¬ä¸¤ç§ï¼š</p>
<ol>
<li>HandleException</li>
<li>SignalHandler</li>
</ol>
<p><a href="http://www.cocoachina.com/ios/20150701/12301.html" target="_blank" rel="external">æ¼«è°ˆiOS Crashæ”¶é›†æ¡†æ¶ </a><br><a href="http://blog.csdn.net/skylin19840101/article/details/50955808#t2" target="_blank" rel="external">iOSå´©æºƒæ•è·ä»¥åŠæ”¶é›†åŸç†</a></p>
<p>4.Core animation åŠ¨ç”»ä¸UIViewåŠ¨ç”»çš„åŒºåˆ«,åŠ¨ç”»æ‰§è¡Œè¿‡ç¨‹ä¸­æ˜¯å¦å“åº”äº‹ä»¶ï¼Ÿ</p>
<ul>
<li>UIView animation ç”±CPUæ‰§è¡Œï¼ŒCore Animationç”±GPUæ‰§è¡Œã€‚</li>
<li>CALayeræœ¬èº«ä¸èƒ½å“åº”äº‹ä»¶ï¼ŒUIViewæ˜¯åœ¨CAlayerä¹‹ä¸Šï¼Œå¢åŠ äº†è§¦æ‘¸å“åº”,æ‰‹åŠ¿è¯†åˆ«ç­‰äº‹ä»¶å“åº”ã€‚</li>
</ul>
<blockquote><p>Core Animation is not executed on the CPU. Their commands are more offloaded to the GPU and used to create the graphics that are shown on the screen, powered by the GPU hardware.</p>
<p>Core Graphics is entirely done on the CPU, and cannot be performed on the GPU. Because it is an entirely CPU-bound operation, it is sometimes slower on older devices (e.g. the iPad 2 or the iPad 3rd Generation). This is something you need to keep in mind when using it in your apps. But, the good thing about Core Graphics is you can combine it with Core Animation.</p>
</blockquote>
<p><a href="https://academy.realm.io/posts/tryswift-tim-oliver-advanced-graphics-with-core-animation/" target="_blank" rel="external">Advanced Graphics with Core Animation</a></p>
<blockquote><p>Core Animation does the rest, handing most of the actual drawing work off to the onboard graphics hardware to accelerate the rendering. This automatic graphics acceleration results in high frame rates and smooth animations without burdening the CPU and slowing down your app.</p>
</blockquote>
<p><a href="https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/CoreAnimation_guide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40004514" target="_blank" rel="external">Core Animation Programming Guide</a></p>
<p>åŠ¨ç”»æ‰§è¡Œè¿‡ç¨‹ä¸­æ˜¯å¦å“åº”äº‹ä»¶ï¼Ÿ<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)touchesBegan:(<span class="built_in">NSSet</span>&lt;<span class="built_in">UITouch</span> *&gt; *)touches withEvent:(<span class="built_in">UIEvent</span> *)event &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%s"</span>,__func__);</span><br><span class="line">    <span class="built_in">UITouch</span> *touch = [touches anyObject];</span><br><span class="line">    <span class="built_in">CGPoint</span> point = [touch locationInView:<span class="keyword">self</span><span class="variable">.view</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">CGRectContainsPoint</span>(<span class="keyword">self</span><span class="variable">.colorLayer</span><span class="variable">.presentationLayer</span><span class="variable">.frame</span>, point)) &#123;</span><br><span class="line">        [<span class="keyword">self</span> startAnimation];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">CGRectContainsPoint</span>(<span class="keyword">self</span><span class="variable">.myView</span><span class="variable">.frame</span>, point)) &#123;</span><br><span class="line">        [<span class="keyword">self</span> start<span class="built_in">UIViewAnimation</span>:<span class="literal">nil</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>ç»è¿‡æµ‹è¯•ï¼ŒCALayeræ˜¯å¯ä»¥å“åº”touchäº‹ä»¶çš„,è€ŒUIViewçš„block animationåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä¸èƒ½å“åº”å…¶è‡ªèº«çš„è§¦æ‘¸äº‹ä»¶ã€‚</p>
<p><em>æ³¨æ„CALayeråœ¨åŠ¨ç”»æ‰§è¡Œè¿‡ç¨‹ä¸­è¦æ˜¯ç”¨presentationLayerå±æ€§æ‰èƒ½è·å–åˆ°ä¸­é—´çŠ¶æ€çš„layer</em><br><em>Core Animation çš„removedOnCompletion å±æ€§é»˜è®¤æ˜¯YESï¼Œå³åŠ¨ç”»ç»“æŸä¹‹åä¼šç§»é™¤åŠ¨ç”»ï¼ŒCALayerä¼šå›åˆ°åŸæ¥çš„çŠ¶æ€</em></p>
<p>å¯ä»¥æŸ¥çœ‹Core Animation Programming Guide çš„æ˜¾å¼åŠ¨ç”»ä¸€ç« ã€‚</p>
<p>å¦å¤–é™„ä¸€ç¯‡æœ‰æ„æ€çš„æ–‡ç«  <a href="https://yalantis.com/blog/uidynamics-uikit-or-opengl-3-types-of-ios-animations-for-the-star-wars/" target="_blank" rel="external">UIDynamics, UIKit or OpenGL? 3 Types of iOS Animations for the Star Wars</a><br>,å€¼å¾—ä¸€è¯»ã€‚</p>
<p>5.Httpsæ¦‚å¿µï¼ŒiOSä¸­è®¾ç½®httpsã€‚<br>ç•¥</p>
<p>6.100Wæ•°æ®ä¸­æ‰¾åˆ°æœ€å¤§çš„10Wï¼Œä½¿ç”¨ä»€ä¹ˆæ•°æ®ç»“æ„ï¼Ÿ</p>
<p>å †</p>
<p><a href="http://blog.csdn.net/zyq522376829/article/details/47686867" target="_blank" rel="external">æµ·é‡æ•°æ®å¤„ç† - 10äº¿ä¸ªæ•°ä¸­æ‰¾å‡ºæœ€å¤§çš„10000ä¸ªæ•°ï¼ˆtop Ké—®é¢˜ï¼‰</a></p>
<p>7.éŸ³è§†é¢‘å¼€å‘ï¼Œæ²¡åšè¿‡ï¼Œç„¶åæåˆ°ç®€å†ä¸Šçš„äºŒç»´ç æ‰«æåº“ - AVFoundationã€‚<br>å½±å“äºŒç»´ç æ‰«æé€Ÿåº¦çš„éš¾ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿæˆ‘å›ç­”æ˜¯äºŒç»´ç å›¾åƒçš„æ¸…æ™°åº¦ï¼Œé¢è¯•å®˜è¿˜æåˆ°äº†äºŒç»´ç å›¾åƒçš„è§’åº¦ï¼Œè¯¥å¦‚ä½•ä¼˜åŒ–ã€‚</p>
<p>å¯¹äºAVFoundationæ¥è¯´ï¼Œæœ‰ä¸¤ä¸ªå› ç´ ï¼š</p>
<ol>
<li><p>å›¾åƒåˆ†è¾¨ç‡<br> AVCaptureSession å¯ä»¥è®¾ç½® sessionPreset å±æ€§ï¼Œè¿™ä¸ªå†³å®šäº†è§†é¢‘è¾“å…¥æ¯ä¸€å¸§å›¾åƒè´¨é‡çš„å¤§å°ã€‚</p>
<ul>
<li>AVCaptureSessionPreset320x240</li>
<li>AVCaptureSessionPreset352x288</li>
<li>AVCaptureSessionPreset640x480</li>
<li>AVCaptureSessionPreset960x540</li>
<li>AVCaptureSessionPreset1280x720</li>
<li>AVCaptureSessionPreset1920x1080</li>
</ul>
</li>
<li><p>æ‰«æèŒƒå›´<br> AVCaptureMetadataOutput çš„ rectOfInterest å±æ€§æ¥é…ç½®è§£æèŒƒå›´</p>
</li>
</ol>
<p>8.ç¦»å±æ¸²æŸ“é—®é¢˜çš„æœ¬è´¨æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p>é¦–å…ˆç¦»å±æ¸²æŸ“æŒ‡çš„æ˜¯åœ¨GPUåœ¨å½“å‰å±å¹•ç¼“å†²åŒºä»¥å¤–å¼€è¾Ÿä¸€ä¸ªç¼“å†²åŒºè¿›è¡Œæ¸²æŸ“æ“ä½œ.</p>
<p>å½“ä½¿ç”¨åœ†è§’ï¼Œé˜´å½±ï¼Œé®ç½©çš„æ—¶å€™ï¼Œå›¾å±‚å±æ€§çš„æ··åˆä½“è¢«æŒ‡å®šä¸ºåœ¨æœªé¢„åˆæˆä¹‹å‰(ä¸‹ä¸€ä¸ªHSyncä¿¡å·å¼€å§‹å‰)ä¸èƒ½ç›´æ¥åœ¨å±å¹•ä¸­ç»˜åˆ¶ï¼Œæ‰€ä»¥å°±éœ€è¦å±å¹•å¤–æ¸²æŸ“ã€‚</p>
<p>å…·ä½“å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼š<a href="http://www.jianshu.com/p/57e2ec17585b" target="_blank" rel="external">iOS-ç¦»å±æ¸²æŸ“è¯¦è§£</a></p>
<h4>æ€»ç»“ï¼š</h4>

<p>æœ¬æ¬¡é¢è¯•é—®é¢˜ä¾§é‡äºå®é™…é¡¹ç›®ï¼Œå¾ˆå¤šä¸œè¥¿ä¹‹å‰æœ‰çœ‹è¿‡ï¼Œä½†éƒ½å¿˜äº†å¤§æ¦‚ï¼Œç”¨åˆ°ä½†æ²¡æœ‰æ·±å…¥ç ”ç©¶æ˜¯ä¸€å¤§åŠ£åŠ¿ã€‚</p>
<p>æ‰€ä»¥è¯´å¤šå¤šé¢è¯•è¿˜æ˜¯æœ‰å¸®åŠ©çš„ğŸ˜†ï¼</p>
<p>é¢è¯•å¿…çœ‹æ–‡ç« ï¼š<br><a href="https://blog.ibireme.com/2015/11/12/smooth_user_interfaces_for_ios/" target="_blank" rel="external">iOS ä¿æŒç•Œé¢æµç•…çš„æŠ€å·§</a><br><a href="http://www.liuhaihua.cn/archives/497294.html" target="_blank" rel="external">iOS åº”ç”¨ç¨³å®šæ€§ç›‘æµ‹å’ŒæŒ‡æ ‡é—®é¢˜</a></p>
<p><a href="https://mp.weixin.qq.com/s?__biz=MzI1MTE2NTE1Ng==&amp;mid=2649516390&amp;idx=1&amp;sn=afb306c7de96e7dabd38a9d4e72bb699&amp;chksm=f1efe9edc69860fb98c41a77af9a3bf5795b11ae039411e571bbc46cb501a006beeb11310cde&amp;scene=21#wechat_redirect" target="_blank" rel="external">iOS æ€§èƒ½ç›‘æ§æ–¹æ¡ˆï¼ˆä¸Šç¯‡ï¼‰</a><br><a href="https://mp.weixin.qq.com/s?__biz=MzI1MTE2NTE1Ng==&amp;mid=2649516402&amp;idx=1&amp;sn=6b294858aea8710faded49e429e0ae79&amp;chksm=f1efe9f9c69860efca1d72ca85aa34583a7a3c8fd2595c6b8dbae5c925893e52c61fe56eb276#rd" target="_blank" rel="external">iOS æ€§èƒ½ç›‘æ§æ–¹æ¡ˆï¼ˆä¸‹ç¯‡ï¼‰</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>è…¾è®¯SNGé¢è¯•ï¼Œç®—æ˜¯ç§¯æ”’ä¸€æ¬¡é¢è¯•ç»éªŒäº†ã€‚å¯ä»¥çœ‹å‡ºï¼Œé«˜çº§å·¥ç¨‹å¸ˆä¸ä»…è¦ä¼šç”¨ä¸€äº›å¸¸ç”¨åº“ï¼Œè¿˜è¦æ‡‚å¾—å®ƒä»¬çš„åŸç†ã€‚</p>]]>
    
    </summary>
    
      <category term="é¢è¯•" scheme="http://koalahl.github.io/tags/%E9%9D%A2%E8%AF%95/"/>
    
      <category term="iOS" scheme="http://koalahl.github.io/categories/iOS/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[MVVM in Practice]]></title>
    <link href="http://koalahl.github.io/2017/08/30/MVVM-in-Practice/"/>
    <id>http://koalahl.github.io/2017/08/30/MVVM-in-Practice/</id>
    <published>2017-08-30T14:07:42.000Z</published>
    <updated>2017-08-30T14:07:42.000Z</updated>
    <content type="html"><![CDATA[<p><a href="https://www.youtube.com/watch?v=sWx8TtRBOfk&amp;t=497s" target="_blank" rel="external">MVVM in Practice - RWDevCon Session - raywenderlich.com</a>  </p>
<p>MVVMå·²ç»è¢«è°ˆè®ºå¾ˆå¤šäº†ï¼Œå´ä¸€ç›´æ²¡æœ‰æ·±å…¥ç†è§£å’Œå®è·µï¼Œæœ¬ç¯‡æ˜¯åœ¨è§‚çœ‹è¯¥è§†é¢‘åçš„å°ç»“ã€‚</p>
<p>è¯¥è§†é¢‘ä¸­è®²è§£äº†MVCåˆ°MVVMçš„è¿ç§»é‡æ„å’Œé‡ç‚¹ï¼Œå¹¶æ²¡æœ‰æ¶‰åŠåˆ°FRPï¼Œåˆå­¦è€…å¯ä»¥å¾ˆå¿«è¿›å…¥MVVMä¸­ã€‚</p>
<a id="more"></a>
<p></p><h4>æ¦‚å¿µ</h4><br>MVVMï¼š Model-View-ViewModelã€‚é€šè¿‡åˆ†ç¦»ViewControllerä¸­é€»è¾‘ä»£ç åˆ°ç‹¬ç«‹çš„ViewModelä¸­ï¼Œå®ç°ä¸šåŠ¡é€»è¾‘åˆ†ç¦»å’ŒVCç˜¦èº«ã€‚<p></p>
<p></p><h4>é‡ç‚¹ï¼šData Binding</h4><br>iOSä¸­çš„æ•°æ®ç»‘å®šæ–¹å¼ï¼š<p></p>
<ol>
<li>KVO</li>
<li>Delegate</li>
<li>Funtional Reactive Programming</li>
<li>Property Observer  <figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">"Hello, playground"</span> &#123;</span><br><span class="line">    <span class="keyword">didSet</span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"new str : <span class="subst">\(str)</span>"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">str = <span class="string">"hello swift"</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>å®ç°ä¸€ä¸ªData Bindingç±»:Box<br>    <figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Box</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">typealias</span> <span class="type">Listener</span> = (<span class="type">T</span>) -&gt; <span class="type">Void</span></span><br><span class="line">    <span class="keyword">var</span> listener : <span class="type">Listener</span>?</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> value:<span class="type">T</span> &#123;</span><br><span class="line">        <span class="keyword">didSet</span> &#123;</span><br><span class="line">            listener?(value)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">init</span>(<span class="number">_</span> value:<span class="type">T</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.value = value</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="func"><span class="keyword">func</span> <span class="title">bind</span><span class="params">(listener:Listener?)</span></span>  &#123;</span><br><span class="line">        <span class="keyword">self</span>.listener = listener</span><br><span class="line">        listener?(value)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> bindedObj = <span class="type">Box</span>(<span class="string">""</span>)</span><br><span class="line"></span><br><span class="line">bindedObj.bind &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"new value:<span class="subst">\($<span class="number">0</span>)</span>"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">bindedObj.value = <span class="string">"2017"</span></span><br></pre></td></tr></table></figure></p>
<p>å¯ä»¥çœ‹å‡ºæ˜¯ä½¿ç”¨äº†closureæ¥å®ç°bingdingçš„ã€‚åŒç†ï¼ŒCocoaä¸­çš„å…¶ä»–ç±»éƒ½å¯ä»¥å†™ä¸€ä¸ªextensionå®ç°ç»‘å®šã€‚</p>
<p></p><h4>æé—®ç¯èŠ‚</h4><br>ï¼ˆåªç»™å‡ºå›ç­”ä¸­çš„é‡ç‚¹å†…å®¹ï¼‰<p></p>
<ol>
<li>ä¸ºä»€ä¹ˆViewModelä½¿ç”¨çš„æ˜¯classè€Œä¸æ˜¯structï¼Ÿ<br> Ashï¼šè¯´æ˜¯å› ä¸ºä»–è®¤ä¸ºè¿™ä¸ªViewModelä¸­ä¸ä»…æ˜¯æ•°æ®é€»è¾‘ï¼Œè¿˜åŒ…å«æœ‰å…¶ä»–åŠŸèƒ½é€»è¾‘ä»£ç ã€‚</li>
<li>ä¸ºä»€ä¹ˆdispatchAfterä¸­ä½¿ç”¨weak selfï¼Œè€ŒviewControllerä¸­ä½¿ç”¨unowned selfï¼Ÿ<br> Ashï¼šé€šå¸¸æ¥è¯´ï¼Œweakä¿®é¥°çš„å˜é‡æœ‰å¯èƒ½æ˜¯ä¸ºnilçš„ï¼Œè€Œunownedä¿®é¥°çš„å˜é‡ä½ ä¼šä¿è¯å®ƒä¸æ˜¯optionalçš„ã€‚</li>
</ol>
<p></p><h4>MVVMçš„Benifitså’ŒLimitation</h4><p></p>
<ol>
<li><p>Benifits:</p>
<ul>
<li>Breaks up code by responsibility</li>
<li>Simplifies Testing</li>
<li>Code reusablibity</li>
</ul>
</li>
<li><p>Limitation:</p>
<ul>
<li>Requires binding(or other workarounds)</li>
<li>Potential for boilerplate code</li>
<li>Sometimes feels like overkill</li>
<li>Doesnâ€™t cover every case</li>
</ul>
</li>
</ol>
<p></p><h4>å»¶ä¼¸é˜…è¯»</h4><p></p>
<ol>
<li><a href="https://github.com/ReactiveX/RxSwift" target="_blank" rel="external">ReactiveCocoa/RxSwift</a></li>
<li><a href="http://southpeak.github.io/2017/01/16/Getting-Started-With-RxSwift-and-RxCocoa/" target="_blank" rel="external">Getting Started With RxSwift and RxCocoa</a></li>
</ol>
]]></content>
    <summary type="html">
    <![CDATA[<p><a href="https://www.youtube.com/watch?v=sWx8TtRBOfk&amp;t=497s">MVVM in Practice - RWDevCon Session - raywenderlich.com</a>  </p>
<p>MVVMå·²ç»è¢«è°ˆè®ºå¾ˆå¤šäº†ï¼Œå´ä¸€ç›´æ²¡æœ‰æ·±å…¥ç†è§£å’Œå®è·µï¼Œæœ¬ç¯‡æ˜¯åœ¨è§‚çœ‹è¯¥è§†é¢‘åçš„å°ç»“ã€‚</p>
<p>è¯¥è§†é¢‘ä¸­è®²è§£äº†MVCåˆ°MVVMçš„è¿ç§»é‡æ„å’Œé‡ç‚¹ï¼Œå¹¶æ²¡æœ‰æ¶‰åŠåˆ°FRPï¼Œåˆå­¦è€…å¯ä»¥å¾ˆå¿«è¿›å…¥MVVMä¸­ã€‚</p>]]>
    
    </summary>
    
      <category term="MVVM" scheme="http://koalahl.github.io/tags/MVVM/"/>
    
      <category term="iOS" scheme="http://koalahl.github.io/tags/iOS/"/>
    
      <category term="swift" scheme="http://koalahl.github.io/tags/swift/"/>
    
      <category term="iOS" scheme="http://koalahl.github.io/categories/iOS/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[ç®€è®° - è®°å½•ä½ çš„ç”Ÿæ´»]]></title>
    <link href="http://koalahl.github.io/2017/03/11/%E7%AE%80%E8%AE%B0-%E8%AE%B0%E5%BD%95%E4%BD%A0%E7%9A%84%E7%94%9F%E6%B4%BB/"/>
    <id>http://koalahl.github.io/2017/03/11/ç®€è®°-è®°å½•ä½ çš„ç”Ÿæ´»/</id>
    <published>2017-03-11T07:37:11.000Z</published>
    <updated>2017-03-11T07:37:11.000Z</updated>
    <content type="html"><![CDATA[<p>ç®€è®° â€”â€” è®°å½•ä½ çš„ç”Ÿæ´»<br><blockquote><p>æœ€ç®€å•çš„æ–‡å­—è®°å½•appï¼Œå¸¦ç»™ä½ æ¸…æ–°ï¼Œç®€çº¦çš„æ°”æ¯ã€‚</p>
</blockquote></p>
<p>æ²¡ä»€ä¹ˆç‰¹ç‚¹çš„æ–‡å­—ç¼–è¾‘appã€‚</p>
<a id="more"></a>
<p>â€”â€”â€”æˆ‘æ˜¯åˆ†å‰²çº¿â€”â€”â€”â€“<br>ç‰¹ç‚¹ï¼š<br>(âŠ™vâŠ™)å—¯ï¼Œå°±æ˜¯ç®€å•ã€‚</p>
<p>æ–‡é›†åˆ†ç±»ç®¡ç†æ—¥è®°ã€‚<br>å¿«é€Ÿåˆ›å»ºæ—¥è®°ã€‚<br>åˆ†äº«ç»™å¥½å‹å•¦ã€‚</p>
<p><img src="http://oh51ob42d.bkt.clouddn.com/mynotes-launchpage.png" alt="ç®€è®°"><br><img src="http://oh51ob42d.bkt.clouddn.com/mynotes-mainpage.png" alt="ç®€è®°"><br><img src="http://oh51ob42d.bkt.clouddn.com/mynotes-homepage.png" alt="ç®€è®°"></p>
<p>è”ç³»é‚®ç®±: hanangellove@icloud.com</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>ç®€è®° â€”â€” è®°å½•ä½ çš„ç”Ÿæ´»<br><blockquote><p>æœ€ç®€å•çš„æ–‡å­—è®°å½•appï¼Œå¸¦ç»™ä½ æ¸…æ–°ï¼Œç®€çº¦çš„æ°”æ¯ã€‚</p>
</blockquote></p>
<p>æ²¡ä»€ä¹ˆç‰¹ç‚¹çš„æ–‡å­—ç¼–è¾‘appã€‚</p>]]>
    
    </summary>
    
      <category term="ç®€è®°" scheme="http://koalahl.github.io/tags/%E7%AE%80%E8%AE%B0/"/>
    
      <category term="app" scheme="http://koalahl.github.io/categories/app/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[iOSå¼€å‘æŠ€æœ¯æ ˆ]]></title>
    <link href="http://koalahl.github.io/2016/12/12/iOS%E5%BC%80%E5%8F%91%E6%8A%80%E6%9C%AF%E6%A0%88/"/>
    <id>http://koalahl.github.io/2016/12/12/iOSå¼€å‘æŠ€æœ¯æ ˆ/</id>
    <published>2016-12-12T15:04:57.000Z</published>
    <updated>2016-12-12T15:04:57.000Z</updated>
    <content type="html"><![CDATA[<p>æé†’è‡ªå·±ï¼š</p>
<p></p><h3 id="objc">Objective-C</h3><br>â€¢ objective-cè¯­è¨€åŸºç¡€<br>â€¢ library,frameworkçš„åˆ¶ä½œ<br>â€¢ Runtimeç¼–ç¨‹<br>â€¢ LLVMåŸç†å’Œè°ƒä¼˜<p></p>
<a id="more"></a>
<p></p><h3 id="OS">æ“ä½œç³»ç»Ÿ</h3><br>â€¢ iOSå†…å­˜ç®¡ç†å’Œè°ƒä¼˜<br>â€¢ iOSçš„æ–‡ä»¶ç³»ç»Ÿå’Œæ²™ç›’æœºåˆ¶<br>â€¢ iOSå¤šçº¿ç¨‹ç¼–ç¨‹ï¼ˆThread,GCD,NSOperationï¼‰<br>â€¢ iOSç½‘ç»œå’ŒæœåŠ¡å™¨ç¼–ç¨‹ï¼ˆNSURLConnection,NSURLSessionï¼‰<br>â€¢ iOSç³»ç»Ÿçš„å„ç§å®‰å…¨æœºåˆ¶<p></p>
<p></p><h3 id="netpro">ç½‘ç»œç¼–ç¨‹</h3><br>â€¢ iOSç½‘ç»œå‘é€æœºåˆ¶è°ƒæ•´å’Œä¼˜åŒ–ï¼ˆNSURLSessionï¼‰<br>â€¢ Socketç¼–ç¨‹<br>â€¢ç½‘ç»œä¼ è¾“ä¸­çš„å„ç§ä¿éšœ<br>â€¢å¯¹ä¼ è¾“åè®®çš„è°ƒæ•´ä¼˜åŒ–<p></p>
<p></p><h3 id="sql">æ•°æ®åº“&amp;æŒä¹…åŒ–æ–¹æ¡ˆ</h3><br>â€¢ å¸¸è§„æŒä¹…åŒ–æ–¹æ¡ˆï¼ˆKeychain,NSUserDefaults,Sqlite,CoreDataï¼‰<br>â€¢æ•°æ®åº“çš„ä½¿ç”¨å’Œè®¾è®¡ï¼ˆSqliteï¼‰<br>â€¢æ•°æ®ç»“æ„ä¼˜åŒ–ï¼ŒSqlè°ƒä¼˜<p></p>
<p></p><h3 id="graphic">å›¾å½¢å›¾åƒç¼–ç¨‹</h3><br>â€¢ UIKit,Core Animationå’ŒCore Textçš„ç»˜åˆ¶<br>â€¢ Core Graphics, Quartz 2D, Media Player, AV Foundation<br>â€¢ OpenGL ES, GLKit, SpriteKit, SceneKit, Metal<p></p>
<p></p><h3 id="alog">æ•°æ®ç»“æ„ &amp; ç®—æ³•</h3><br>â€¢åŸºæœ¬çš„ç®—æ³•å’Œæ•°æ®ç»“æ„ï¼ˆæ’åºæœç´¢ç®—æ³•, æ•°ç»„, é˜Ÿåˆ—ï¼‰<br>â€¢è¾ƒå¤æ‚æ•°æ®ç»“æ„çš„çµæ´»åº”ç”¨ï¼ˆäºŒå‰æ ‘, å›¾ç­‰ï¼‰<br>â€¢å¤æ‚çš„ä¸“é¡¹ç®—æ³•ï¼ˆå›¾åƒè¯†åˆ«ç®—æ³•, æ‹“æ‰‘å®šä½ç­‰ç­‰ï¼‰<p></p>
<p></p><h3 id="safe">å®‰å…¨æ–¹æ¡ˆ</h3><br>â€¢ æœ¬åœ°æ•°æ®å­˜å‚¨å®‰å…¨ï¼ˆKeychainï¼‰<br>â€¢æˆæƒå’Œèº«ä»½éªŒè¯<br>â€¢ä¼ è¾“å®‰å…¨ï¼ˆå¯¹ç§°, éå¯¹ç§°, SSLï¼‰<br>â€¢ Appä»£ç å®‰å…¨<p></p>
<p></p><h3 id="bussiness">ä¸šåŠ¡èƒ½åŠ›</h3><br>â€¢ä¸€èˆ¬æ€§ä¸šåŠ¡åŠŸèƒ½éœ€æ±‚åˆ†æåŠå®ç°<br>â€¢é‡è¦ä¸šåŠ¡æ¨¡å—çš„éœ€æ±‚åˆ†æåŠå®ç°<br>â€¢ä¸­å°è§„æ¨¡äº§å“çš„æ¶æ„ï¼Œç³»ç»Ÿè®¾è®¡å’Œå®ç°<br>â€¢å¤§è§„æ¨¡äº§å“æˆ–äº§å“çº¿çš„æ¶æ„ï¼Œç³»ç»Ÿè®¾è®¡å’Œå®ç°<br>â€¢å¹³å°çº§äº§å“çš„æ¶æ„ï¼Œç³»ç»Ÿè®¾è®¡å’Œå®ç°<p></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>æé†’è‡ªå·±ï¼š</p>
<p><h3 id = "objc">Objective-C</h3><br>â€¢ objective-cè¯­è¨€åŸºç¡€<br>â€¢ library,frameworkçš„åˆ¶ä½œ<br>â€¢ Runtimeç¼–ç¨‹<br>â€¢ LLVMåŸç†å’Œè°ƒä¼˜</p>]]>
    
    </summary>
    
      <category term="skills" scheme="http://koalahl.github.io/tags/skills/"/>
    
      <category term="iOS" scheme="http://koalahl.github.io/categories/iOS/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[iOSè‡ªåŠ¨æ‰“åŒ…è„šæœ¬]]></title>
    <link href="http://koalahl.github.io/2016/11/30/iOS%E8%87%AA%E5%8A%A8%E6%89%93%E5%8C%85%E8%84%9A%E6%9C%AC/"/>
    <id>http://koalahl.github.io/2016/11/30/iOSè‡ªåŠ¨æ‰“åŒ…è„šæœ¬/</id>
    <published>2016-11-30T06:17:21.000Z</published>
    <updated>2016-11-30T06:17:21.000Z</updated>
    <content type="html"><![CDATA[<p>ä½¿ç”¨Xcodebuildå’Œxcrunå‘½ä»¤ç”Ÿæˆã€‚å…·ä½“å‚æ•°å¯ä»¥è‡ªå·±é…ç½®ã€‚</p>
<a id="more"></a>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash&#10;#Author hanliu&#10;&#10;#Global declaration&#10;SCHEMENAME=&#34;hongmeng&#34;&#10;#if use git&#10;#BRANCHNAME = master&#10;&#10;DATE=`date &#34;+%Y%m%d&#34;`&#10;SOURCEPATH=$(CD &#34;$(dirname $0)&#34; &#38;&#38; pwd)&#10;BUILDPATH=$(dirname $(dirname $SOURCEPATH))/AutoBuildIPA&#10;BUILDAPPPATH=$BUILDPATH/Build/Products/Debug-iphoneos&#10;IPAPATH=$(dirname $(dirname $SOURCEPATH))/IPA&#10;IPANAME=$SCHEMENAME_$DATE.ipa&#10;&#10;echo &#34;DATE is &#34; $DATE&#10;echo &#34;SOURCEPATH:&#34;$SOURCEPATH&#10;echo &#34;BUILDPATH:&#34;$BUILDPATH&#10;echo &#34;IPAPATH:&#34;$IPAPATH&#10;&#10;echo &#34;Press any key to continue!&#34;&#10;read -p &#34;press any &#34; c&#10;if $c;then&#10;    xcodebuild -list&#10;else&#10;    echo &#34;ddd&#34;&#10;fi&#10;#&#10;#Information about project &#34;xxxxx&#34;:&#10;#    Targets:&#10;#        xxxxxx&#10;#&#10;#    Build Configurations:&#10;#        Debug&#10;#        Release&#10;#&#10;#    If no build configuration is specified and -scheme is not passed then &#34;Release&#34; is used.&#10;#&#10;#    Schemes:&#10;#        xxxxxx&#10;#&#10;&#10;#&#19981;&#25351;&#23450;configuration&#65292;&#25171;&#21253;&#20026;debug&#27169;&#24335;&#10;#xcodebuild -workspace hongmeng.xcworkspace -scheme hongmeng -configuration Debug clean build -derivedDataPath $BUILDPATH&#10;&#10;xcodebuild -workspace $SCHEMENAME.xcworkspace -scheme $SCHEMENAME -configuration Debug clean build -derivedDataPath $BUILDPATH&#10;if [ -e $BUILDPATH ]; then&#10;    echo &#34;xcodebuild Successful!&#34;&#10;else&#10;    echo &#34;xcodebuild failure!&#34;&#10;    exit 1&#10;fi&#10;&#10;&#10;#&#25171;&#21253;ipa&#10;#xcrun  -sdk iphoneos PackageApplication -v AutoBuildIPA/Build/Products/Debug-iphoneos/$SCHEMENAME.app -o $BUILDPATH/$SCHEMENAME_$DATE.ipa&#10;xcrun  -sdk iphoneos PackageApplication -v $BUILDAPPPATH/$SCHEMENAME.app -o $IPAPATH/$IPANAME&#10;&#10;if [ -e $IPAPATH/$IPANAME ]; then&#10;    echo &#34;\n--------------\n\n&#34;&#10;    echo &#34;Congratulations! Build Successful!&#34;&#10;    open $IPAPATH&#10;else&#10;    echo &#34;Build failure!&#34;&#10;fi</span><br></pre></td></tr></table></figure>
]]></content>
    <summary type="html">
    <![CDATA[<p>ä½¿ç”¨Xcodebuildå’Œxcrunå‘½ä»¤ç”Ÿæˆã€‚å…·ä½“å‚æ•°å¯ä»¥è‡ªå·±é…ç½®ã€‚</p>]]>
    
    </summary>
    
      <category term="shell" scheme="http://koalahl.github.io/tags/shell/"/>
    
      <category term="iOS" scheme="http://koalahl.github.io/categories/iOS/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Objc Runtime å†æ¬¡å®è·µ]]></title>
    <link href="http://koalahl.github.io/2016/11/22/OBJC-RUNTIME-%E5%86%8D%E6%AC%A1%E5%AE%9E%E8%B7%B5/"/>
    <id>http://koalahl.github.io/2016/11/22/OBJC-RUNTIME-å†æ¬¡å®è·µ/</id>
    <published>2016-11-22T06:47:05.000Z</published>
    <updated>2016-11-22T06:47:05.000Z</updated>
    <content type="html"><![CDATA[<p>å¥½ä¹…ä¸ç”¨ï¼Œå†æ¬¡ä½¿ç”¨runtimeé‡å†™ä»£ç ã€‚å°±ç”¨é«˜æ€§èƒ½æ·»åŠ å›¾ç‰‡åœ†è§’æ¥å†ä¸€æ¬¡å®è·µä¸€ä¸‹runtimeçš„åŸºæœ¬ç”¨æ³•ã€‚</p>
<p>runtimeä½¿ç”¨åœºæ™¯ï¼š</p>
<ul>
<li>categoryæ·»åŠ å…³è”å±æ€§</li>
<li>MethodSwizzleæ›¿æ¢/äº¤æ¢ç³»ç»Ÿæ–¹æ³•</li>
</ul>
<p>å¹³å¸¸ä½¿ç”¨cornerRadiuså’ŒmaskToBoundsç»„åˆè®¾ç½®åœ†è§’</p>
<a id="more"></a>
<div align="center"><br>    <img src="http://oh51ob42d.bkt.clouddn.com/blended layer.png" width="225" height="408" alt="girl"><br></div>

<p></p><h2 id="category">categoryæ·»åŠ å…³è”å±æ€§</h2><br>åºŸè¯ä¸å¤šè¯´ï¼Œç›´æ¥ä¸Šä»£ç <br>åˆ›å»ºä¸€ä¸ª<code>NSError</code>çš„categoryï¼Œæ·»åŠ ä¸€ä¸ª<code>errorMsg</code>çš„å±æ€§ã€‚å› ä¸ºcategoryæœ¬èº«ä¸èƒ½æ·»åŠ å±æ€§ï¼Œè¿™é‡Œæ˜¯ä½¿ç”¨runtimeåŠ¨æ€æ·»åŠ å…³è”å±æ€§<p></p>
<p><img src="http://oh51ob42d.bkt.clouddn.com/NSError+Msg_h.png" alt="NSError+Msg_h"></p>
<p><img src="http://oh51ob42d.bkt.clouddn.com/NSError+Msg_m.png" alt="NSError+Msg_m"></p>
<p></p><h2 id="methodSwizzle">MethodSwizzleäº¤æ¢ç³»ç»Ÿæ–¹æ³•</h2><br>åˆ›å»ºä¸€ä¸ª<code>UIImageView</code>çš„categoryï¼Œåœ¨åˆ†ç±»ä¸­äº¤æ¢ï¼ˆexchangeï¼Œæ³¨æ„è¿™é‡Œä¸æ˜¯æ›¿æ¢replaceï¼‰ç³»ç»Ÿçš„<code>setImage:</code> æ–¹æ³•.<p></p>
<p>æˆ‘ä»¬è¦äº¤æ¢ä¸€ä¸ªç±»çš„ç³»ç»Ÿæ–¹æ³•ï¼Œé‚£ä¹ˆé¦–å…ˆæƒ³æƒ³åœ¨å“ªä¸ªæ–¹æ³•ä¸­äº¤æ¢æœ€åˆé€‚å‘¢ï¼Ÿ<br>æˆ‘ä»¬çŸ¥é“appåœ¨å¯åŠ¨ä¹‹åï¼Œä¼šè¿›è¡Œç±»æ³¨å†Œï¼Œè°ƒç”¨ç±»çš„<code>+load()</code>æ–¹æ³•ï¼Œä¸”åªè°ƒç”¨ä¸€æ¬¡ã€‚ï¼ˆæ³¨æ„ä¸<code>+initialize</code>çš„åŒºåˆ«ï¼‰<a href="http://polomana.com/2016/03/23/Effective-Objective-C-2-0-è¦ç‚¹/" target="_blank" rel="external">ç¬¬51æ¡:loadä¸initializeçš„åŒºåˆ«</a>æ‰€ä»¥æˆ‘ä»¬åœ¨åˆ†ç±»ä¸­é‡å†™<code>load</code>æ–¹æ³•ä¸­æ·»åŠ äº¤æ¢æ–¹æ³•ã€‚</p>
<p>é¦–å…ˆæˆ‘ä»¬å€Ÿç”¨AFNetworkingä¸­AFURLSessionManagerä¸­å®šä¹‰çš„swizzleçš„å†…è”å‡½æ•°<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">void</span> hl_swizzleSelector(Class theClass, SEL originalSelector, SEL swizzledSelector) &#123;</span><br><span class="line">    Method originalMethod = class_getInstanceMethod(theClass, originalSelector);</span><br><span class="line">    Method swizzledMethod = class_getInstanceMethod(theClass, swizzledSelector);</span><br><span class="line">    method_exchangeImplementations(originalMethod, swizzledMethod);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="built_in">BOOL</span> hl_addMethod(Class theClass, SEL selector, Method method) &#123;</span><br><span class="line">    <span class="comment">/*</span><br><span class="line">    YES if the method was added successfully, otherwise NO (for example, the class already contains a method implementation with that name)</span><br><span class="line">    */</span></span><br><span class="line">    <span class="keyword">return</span> class_addMethod(theClass, selector,  method_getImplementation(method),  method_getTypeEncoding(method));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>ç„¶ååœ¨<code>+load</code>æ–¹æ³•ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hl_swizzleSelector([<span class="keyword">self</span> class], <span class="keyword">@selector</span>(setImage:), <span class="keyword">@selector</span>(hl_setImage:));</span><br></pre></td></tr></table></figure></p>
<p>/* è¿™é‡Œå‚è€ƒçš„æ˜¯AFURLSessionManagerä¸­çš„æ–¹å¼æ¥æ·»åŠ æ–¹æ³•ï¼Œä½†æ˜¯å®é™…ä¸Šåœ¨è¿™ä¸ªæƒ…å†µä¸‹æ˜¯æ°¸è¿œè¿”å›NOçš„</p>
<ul>
<li>åŸå› ï¼šå› ä¸ºæˆ‘ä»¬æ˜¯åœ¨UIImageViewçš„categoryä¸­æ·»åŠ äº†hl_setImage:ï¼Œæ‰€ä»¥åœ¨UIImageViewä¸­å·²ç»å­˜åœ¨äº†è¯¥æ–¹æ³•ï¼Œå†è°ƒç”¨class_addMethodå°±ä¼šè¿”å›NOã€‚</li>
<li>å› æ­¤ä¸‹é¢è¿™äº›ä»£ç å¦‚æœå†™åœ¨categoryä¸­æ˜¯ä¸éœ€è¦çš„äº†ã€‚<br>*/<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Method hlSetImageMethod = class_getInstanceMethod([<span class="keyword">self</span> class],<span class="keyword">@selector</span>(hl_setImage:));</span><br><span class="line"></span><br><span class="line"><span class="built_in">BOOL</span> result = hl_addMethod([<span class="keyword">self</span> class],<span class="keyword">@selector</span>(hl_setImage:), hlSetImageMethod);</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"%d"</span>,result);</span><br><span class="line"><span class="keyword">if</span> (result) &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>æµ‹è¯•ä¸€ä¸‹ä»£ç ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">UIImageView</span> * v = [[<span class="built_in">UIImageView</span> alloc]initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">240</span>, <span class="number">240</span>)];</span><br><span class="line">v<span class="variable">.center</span> = <span class="keyword">self</span><span class="variable">.view</span><span class="variable">.center</span>;</span><br><span class="line">[<span class="keyword">self</span><span class="variable">.view</span> addSubview:v];</span><br><span class="line"></span><br><span class="line"><span class="built_in">UIImage</span> * image = [<span class="built_in">UIImage</span> imageNamed:<span class="string">@"IMG_0730.jpg"</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¼šäº§ç”Ÿæ··åˆå›¾å±‚</span></span><br><span class="line">v<span class="variable">.layer</span><span class="variable">.cornerRadius</span> = v<span class="variable">.frame</span><span class="variable">.size</span><span class="variable">.width</span> / <span class="number">2</span>;</span><br><span class="line">v<span class="variable">.layer</span><span class="variable">.masksToBounds</span> = <span class="literal">YES</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//é‡‡ç”¨UIGraphicImageContexté‡ç»˜å,è§£å†³æ··åˆå›¾å±‚é—®é¢˜</span></span><br><span class="line">[v setImage:[image hl_imageByCroppingForSize:<span class="built_in">CGSizeMake</span>(<span class="number">240</span>, <span class="number">240</span>) fillColor:[<span class="built_in">UIColor</span> whiteColor]]];</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä½¿ç”¨Method swizzleäº¤æ¢setImageå’Œhl_setImage:ä¹‹åï¼š</span></span><br><span class="line">v<span class="variable">.image</span> = image;</span><br></pre></td></tr></table></figure></p>
<div align="center"><br>    <img src="http://oh51ob42d.bkt.clouddn.com/No blended layer.png" width="225" height="408" alt="girls"><br></div>


<p></p><h2 id="æ€§èƒ½">å…¶ä¸­çš„æ€§èƒ½é—®é¢˜</h2><br>æˆ‘ä»¬åœ¨UIImage+HLAddåˆ†ç±»ä¸­ä½¿ç”¨UIGraphicImageContextæ¥é‡æ–°ç»˜å›¾ï¼Œè¿™è‚¯å®šæ˜¯è¦è€—æ—¶çš„æ“ä½œã€‚<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">CFTimeInterval</span> start = <span class="built_in">CACurrentMediaTime</span>();</span><br><span class="line">...</span><br><span class="line"><span class="comment">//ç»˜å›¾</span></span><br><span class="line">...</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"%f"</span>,<span class="built_in">CACurrentMediaTime</span>() - start);</span><br></pre></td></tr></table></figure><p></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2016</span>-<span class="number">11</span>-<span class="number">22</span> <span class="number">17</span>:<span class="number">53</span>:<span class="number">42.614</span> iOS-Kick-On[<span class="number">47630</span>:<span class="number">2598373</span>] <span class="number">0.003525</span></span><br></pre></td></tr></table></figure>
<p>å¤§æ¦‚è€—æ—¶åœ¨0.003~0.006ä¹‹é—´ï¼Œä»¥çº³ç§’è¿›è¡Œè¿ç®—çš„cpuæ¥è¯´ï¼Œè¿˜æ˜¯ä¸€ä¸ªç¨å¾®è€—æ—¶çš„æ“ä½œï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥æŠŠå®ƒæ”¾åœ¨åå°çº¿ç¨‹æ¥åšï¼Œç„¶åé‡‡ç”¨å›è°ƒæ¥è·å–è¿”å›çš„image<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">dispatch_async</span>(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, <span class="number">0</span>), ^&#123;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">UIImage</span> * result = [<span class="keyword">self</span> hl_imageByCroppingCorner:radius forSize:targetSize fillColor:[<span class="built_in">UIColor</span> whiteColor]];</span><br><span class="line"></span><br><span class="line">    <span class="built_in">dispatch_async</span>(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">        <span class="keyword">if</span> (completion) &#123;</span><br><span class="line">            completion(result);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p><a href="https://github.com/koalahl/UIImageViewHack" target="_blank" rel="external">æœ¬ç¯‡æ–‡ç« ä»£ç </a></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>å¥½ä¹…ä¸ç”¨ï¼Œå†æ¬¡ä½¿ç”¨runtimeé‡å†™ä»£ç ã€‚å°±ç”¨é«˜æ€§èƒ½æ·»åŠ å›¾ç‰‡åœ†è§’æ¥å†ä¸€æ¬¡å®è·µä¸€ä¸‹runtimeçš„åŸºæœ¬ç”¨æ³•ã€‚</p>
<p>runtimeä½¿ç”¨åœºæ™¯ï¼š</p>
<ul>
<li>categoryæ·»åŠ å…³è”å±æ€§</li>
<li>MethodSwizzleæ›¿æ¢/äº¤æ¢ç³»ç»Ÿæ–¹æ³•</li>
</ul>
<p>å¹³å¸¸ä½¿ç”¨cornerRadiuså’ŒmaskToBoundsç»„åˆè®¾ç½®åœ†è§’</p>]]>
    
    </summary>
    
      <category term="iOS" scheme="http://koalahl.github.io/tags/iOS/"/>
    
      <category term="runtime" scheme="http://koalahl.github.io/tags/runtime/"/>
    
      <category term="iOS" scheme="http://koalahl.github.io/categories/iOS/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[ä¸€èµ·å”±ï¼Œå›¢ç»“å°±æ˜¯åŠ›é‡]]></title>
    <link href="http://koalahl.github.io/2016/11/18/%E4%B8%80%E8%B5%B7%E5%94%B1%EF%BC%8C%E5%9B%A2%E7%BB%93%E5%B0%B1%E6%98%AF%E5%8A%9B%E9%87%8F/"/>
    <id>http://koalahl.github.io/2016/11/18/ä¸€èµ·å”±ï¼Œå›¢ç»“å°±æ˜¯åŠ›é‡/</id>
    <published>2016-11-18T03:06:17.000Z</published>
    <updated>2016-11-18T03:06:17.000Z</updated>
    <content type="html"><![CDATA[<p>ä¸¤ä¸ªäººæ¥åˆ°æ²³è¾¹ï¼Œæƒ³è¦æ¸¡æ²³ï¼Œäºæ˜¯åŒä¹˜ä¸€æ¡èˆ¹ã€‚ä¸€äººèˆ¹å°¾ï¼Œä¸€äººèˆ¹è‰ï¼Œå„è‡ªæ‹¿èµ·ä¸€å¯¹æ¡¨å¥‹åŠ›åœ°åˆ’ç€ã€‚å¯æ˜¯è¿‡äº†è€åŠå¤©ä¹Ÿä¸è§å°èˆ¹é©¶å‘å¯¹å²¸ï¼Œä¸¤äººè½¬å¤´ä¸€çœ‹ï¼ŒåŸæ¥å„è‡ªæŠŠè‡ªå·±çš„ä½ç½®å½“æˆèˆ¹è‰äº†ï¼Œæœç€ç›¸åçš„æ–¹å‘åˆ’å»äº†ã€‚ä»–ä»¬äº’ç›¸æŒ‡è´£å¯¹æ–¹çš„è¿‡å¤±ï¼Œåˆ°äº†å¤ªé˜³è½å±±ä¾ç„¶è¿˜åœç•™åœ¨åŸåœ°ã€‚</p>
<a id="more"></a>
]]></content>
    <summary type="html">
    <![CDATA[<p>ä¸¤ä¸ªäººæ¥åˆ°æ²³è¾¹ï¼Œæƒ³è¦æ¸¡æ²³ï¼Œäºæ˜¯åŒä¹˜ä¸€æ¡èˆ¹ã€‚ä¸€äººèˆ¹å°¾ï¼Œä¸€äººèˆ¹è‰ï¼Œå„è‡ªæ‹¿èµ·ä¸€å¯¹æ¡¨å¥‹åŠ›åœ°åˆ’ç€ã€‚å¯æ˜¯è¿‡äº†è€åŠå¤©ä¹Ÿä¸è§å°èˆ¹é©¶å‘å¯¹å²¸ï¼Œä¸¤äººè½¬å¤´ä¸€çœ‹ï¼ŒåŸæ¥å„è‡ªæŠŠè‡ªå·±çš„ä½ç½®å½“æˆèˆ¹è‰äº†ï¼Œæœç€ç›¸åçš„æ–¹å‘åˆ’å»äº†ã€‚ä»–ä»¬äº’ç›¸æŒ‡è´£å¯¹æ–¹çš„è¿‡å¤±ï¼Œåˆ°äº†å¤ªé˜³è½å±±ä¾ç„¶è¿˜åœç•™åœ¨åŸåœ°ã€‚</p>]]>
    
    </summary>
    
      <category term="ç”Ÿæ´»" scheme="http://koalahl.github.io/categories/%E7%94%9F%E6%B4%BB/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Xcode8ä¸­NavigationBaræ’å…¥èƒŒæ™¯å‡ºé”™çš„è§£å†³æ–¹æ³•]]></title>
    <link href="http://koalahl.github.io/2016/10/05/Xcode8%E4%B8%ADNavigationBar%E6%8F%92%E5%85%A5%E8%83%8C%E6%99%AF%E5%87%BA%E9%94%99%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/"/>
    <id>http://koalahl.github.io/2016/10/05/Xcode8ä¸­NavigationBaræ’å…¥èƒŒæ™¯å‡ºé”™çš„è§£å†³æ–¹æ³•/</id>
    <published>2016-10-05T01:50:47.000Z</published>
    <updated>2017-08-18T09:25:31.000Z</updated>
    <content type="html"><![CDATA[<p>insertSubviewæ˜¯æŠŠbackgroundViewæ’å…¥åˆ°UINavigationBarä¸­ï¼ŒUINavigationBarä½œä¸ºå…¶superviewã€‚æ¯æ¬¡è·³è½¬å›æ¥ä¹‹åï¼Œä¼šé‡æ–°èµ‹å€¼ï¼ˆå¯èƒ½ï¼‰<br>æ‰€ä»¥æˆ‘ä»¬è¦æŠŠbackgroundViewæ”¾å…¥åˆ°UIBarBackgroundä¸­ã€‚</p>
<a id="more"></a>
<p>ä»¥å‰å†™è¿‡ä¸€ä¸ªå¯¼èˆªæ ä¸­æ’å…¥èƒŒæ™¯æ”¹å˜å¯¼èˆªæ èƒŒæ™¯è‰²çš„ç±»ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">insertSubview(backgroundView!, at: <span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<p>åœ¨xcode8 çš„view hierarchayè¡¨ç°ä¸ºï¼š<br><img src="/img/background1.png" alt="xcode8"></p>
<p>ä½†æ˜¯ç°åœ¨å‡ºç°çš„é—®é¢˜æ˜¯è¿”å›åˆ°é¦–é¡µåï¼Œå¯¼èˆªæ è¢«èƒŒæ™¯viewé®ç›–äº†</p>
<p><img src="/img/background2.png" alt="xcode8"></p>
<p>è§£å†³æ–¹æ³•ï¼š<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">self</span>.subviews[<span class="number">0</span>].insertSubview(backgroundView!, at: <span class="number">0</span>)</span><br></pre></td></tr></table></figure></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>insertSubviewæ˜¯æŠŠbackgroundViewæ’å…¥åˆ°UINavigationBarä¸­ï¼ŒUINavigationBarä½œä¸ºå…¶superviewã€‚æ¯æ¬¡è·³è½¬å›æ¥ä¹‹åï¼Œä¼šé‡æ–°èµ‹å€¼ï¼ˆå¯èƒ½ï¼‰<br>æ‰€ä»¥æˆ‘ä»¬è¦æŠŠbackgroundViewæ”¾å…¥åˆ°UIBarBackgroundä¸­ã€‚</p>]]>
    
    </summary>
    
      <category term="NavigationBar" scheme="http://koalahl.github.io/tags/NavigationBar/"/>
    
      <category term="Xcode8" scheme="http://koalahl.github.io/tags/Xcode8/"/>
    
      <category term="swift" scheme="http://koalahl.github.io/tags/swift/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[pythonä»£ç è¿è¡Œåœ¨iOSå·¥ç¨‹ä¸­çš„æ–¹æ¡ˆ]]></title>
    <link href="http://koalahl.github.io/2016/07/11/python%E4%BB%A3%E7%A0%81%E8%BF%90%E8%A1%8C%E5%9C%A8iOS%E5%B7%A5%E7%A8%8B%E4%B8%AD%E7%9A%84%E6%96%B9%E6%A1%88/"/>
    <id>http://koalahl.github.io/2016/07/11/pythonä»£ç è¿è¡Œåœ¨iOSå·¥ç¨‹ä¸­çš„æ–¹æ¡ˆ/</id>
    <published>2016-07-11T02:37:06.000Z</published>
    <updated>2017-08-01T13:33:35.000Z</updated>
    <content type="html"><![CDATA[<p>ä¸€ç§Xcodeå·¥ç¨‹å†…æ‰§è¡Œpythonè„šæœ¬çš„æ–¹æ³•ï¼Œè¯¦è§ä¸‹æ–‡ã€‚</p>
<a id="more"></a>
<p>1.ä¸‹è½½è§£å‹Python-iOS.zipæ–‡ä»¶ï¼Œæ‰“å¼€python-ios.xcworkspaceã€‚<br>2.Command+Rè¿è¡Œï¼Œæ­¤æ—¶åœ¨æ¨¡æ‹Ÿå™¨ä¸Šä¼šæœ‰appç”Ÿæˆï¼›å¹¶ä¸”Xcodeçš„consoleä¸­ä¼šæœ‰logæ‰“å°<br>3.å¯ä»¥ç‚¹å‡»Send MsgæŒ‰é’®ï¼Œä¼šæœ‰å¦‚ä¸‹log</p>
<p>å½“ç„¶ï¼Œä¹Ÿå¯ä»¥æ‰“å¼€æµè§ˆå™¨ï¼Œè¾“å…¥127.0.0.1:8000</p>
<p>å®ç°æ–¹æ³•ï¼š<br>1.ä¸»è¦é›†æˆäº†pythonåŸºç¡€åº“libPythonå’Œé™æ€åº“liblibpython.a<br><img src="/img/python lib.png" alt="python lib"><br>2.include python.h,ä»¥åŠpython å‡½æ•°çš„ä½¿ç”¨æ–¹å¼ï¼š<br><img src="/img/python env init.png" alt="python env init"><br>çº¢è‰²æ¡†ä¸­server.pyè„šæœ¬è¢«æ”¾åˆ°äº†å…¶ä»–çº¿ç¨‹æ‰§è¡Œï¼Œè§£å†³äº†å¡ä½ä¸»çº¿ç¨‹çš„é—®é¢˜ã€‚</p>
<p>3.åŒæ—¶æˆ‘ä¹Ÿç»™å‡ºäº†ä¸€ä¸ªåœ¨ç”¨æˆ·ç•Œé¢å‘æœ¬åœ°æœåŠ¡å™¨æ¶ˆæ¯äº¤äº’çš„ä¾‹å­ï¼Œä½¿ç”¨socketã€‚<br><img src="/img/socket.png" alt="socket"></p>
<p>ä¾‹å­æ¯”è¾ƒç®€å•ï¼Œå®ç°äº†æœ€åŸºç¡€çš„åœ¨ç”¨æˆ·ç•Œé¢ä¸æœ¬åœ°æœåŠ¡å™¨é€šä¿¡çš„ä¾‹å­ã€‚å¹¶ä¸”ä¸å½±å“iOSç›¸å…³ä»£ç çš„ç¼–å†™ã€‚</p>
<p>ç”±äºé™„ä»¶è¾ƒå¤§ï¼Œä¸Šä¼ åˆ°äº†Githubã€‚<a href="https://github.com/koalahl/PythonIniOS" target="_blank" rel="external">https://github.com/koalahl/PythonIniOS</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>ä¸€ç§Xcodeå·¥ç¨‹å†…æ‰§è¡Œpythonè„šæœ¬çš„æ–¹æ³•ï¼Œè¯¦è§ä¸‹æ–‡ã€‚</p>]]>
    
    </summary>
    
      <category term="iOS" scheme="http://koalahl.github.io/tags/iOS/"/>
    
      <category term="python" scheme="http://koalahl.github.io/tags/python/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[ã€Šç¨‹åºå‘˜çš„è‡ªæˆ‘ä¿®å…»ã€‹è¯»ä¹¦ç¬”è®°-ç¼–è¯‘å’Œé“¾æ¥]]></title>
    <link href="http://koalahl.github.io/2016/05/10/%E3%80%8A%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-%E7%BC%96%E8%AF%91%E5%92%8C%E9%93%BE%E6%8E%A5/"/>
    <id>http://koalahl.github.io/2016/05/10/ã€Šç¨‹åºå‘˜çš„è‡ªæˆ‘ä¿®å…»ã€‹è¯»ä¹¦ç¬”è®°-ç¼–è¯‘å’Œé“¾æ¥/</id>
    <published>2016-05-10T12:27:06.000Z</published>
    <updated>2016-05-10T12:27:06.000Z</updated>
    <content type="html"><![CDATA[<p>ä¸€ä¸ªHelloWorld.cç¨‹åºæ˜¯å¦‚ä½•è¢«å¤„ç†ï¼Œå¾—åˆ°ä¸€ä¸ªa.outå¯æ‰§è¡Œç¨‹åºçš„å‘¢ï¼Ÿ<br><code>$gcc HelloWorld.c</code>å‘½ä»¤ï¼Œå¾—åˆ°a.out<br><code>$./a.out</code> æ‰§è¡Œ</p>
<p>è¯¥è¿‡ç¨‹å¯åˆ†ä¸ºå››ä¸ªæ­¥éª¤ï¼šé¢„å¤„ç†ï¼ˆPreprocessï¼‰æˆ–è€…å«é¢„ç¼–è¯‘ã€ç¼–è¯‘ï¼ˆCompileï¼‰ã€æ±‡ç¼–ï¼ˆAssemblyï¼‰å’Œé“¾æ¥ï¼ˆLinkingï¼‰ã€‚</p>
<a id="more"></a>
<p><img src="/img/gcc compile process.jpeg" alt=""></p>
<h3 id="preprocess">é¢„ç¼–è¯‘</h3>

<p>é¢„ç¼–è¯‘çš„å‘½ä»¤<code>$gcc -E HelloWorld.c -o HelloWorld.i</code>ã€‚<br>é¢„ç¼–è¯‘ä¸­çš„ä¸»è¦è§„åˆ™ï¼š</p>
<ul>
<li>å°†æ‰€æœ‰çš„<code>#define</code>åˆ é™¤ï¼Œå±•å¼€æ‰€æœ‰çš„å®å®šä¹‰</li>
<li>å¤„ç†æ‰€æœ‰çš„æ¡ä»¶é¢„ç¼–è¯‘æŒ‡ä»¤ï¼Œæ¯”å¦‚<code>#if</code>,<code>#ifdef</code>,<code>#endif</code>,<code>#elif</code>,<code>#else</code>.</li>
<li>å¤„ç†<code>#include</code>æŒ‡ä»¤ï¼Œå°†è¢«åŒ…å«çš„æ–‡ä»¶æ’å…¥åˆ°è¯¥é¢„ç¼–è¯‘æŒ‡ä»¤çš„ä½ç½®ã€‚è¿™ä¸ªè¿‡ç¨‹æ˜¯é€’å½’è¿›è¡Œçš„</li>
<li>åˆ é™¤æ‰€æœ‰çš„æ³¨é‡Š<code>//</code>å’Œ<code>/**/</code>.</li>
<li>æ·»åŠ è¡Œå·å’Œæ–‡ä»¶åæ ‡è¯†ã€‚</li>
<li>ä¿ç•™æ‰€æœ‰çš„<code>#pragma</code>ç¼–è¯‘å™¨æŒ‡ä»¤ï¼Œå› ä¸ºç¼–è¯‘å™¨è¦ä½¿ç”¨å®ƒã€‚</li>
</ul>
<h3 id="compile">ç¼–è¯‘</h3>

<p>ç¼–è¯‘å™¨ ï¼šcc1ç¨‹åº<br>ç¼–è¯‘è¿‡ç¨‹å°±æ˜¯æŠŠé¢„å¤„ç†å®Œçš„.iæ–‡ä»¶è¿›è¡Œä¸€ç³»åˆ—çš„è¯æ³•åˆ†æã€è¯­æ³•åˆ†æã€è¯­ä¹‰åˆ†æä»¥åŠä»£ç ä¼˜åŒ–åäº§ç”Ÿç›¸åº”çš„æ±‡ç¼–ä»£ç <br>ç¼–è¯‘çš„å‘½ä»¤<code>$gcc -S HelloWorld.c -o HelloWorld.s</code>ã€‚</p>
<p><img src="/img/compile process.png" alt="ç¼–è¯‘è¿‡ç¨‹"></p>
<h3 id="assembly">æ±‡ç¼–</h3>

<p>æ±‡ç¼–å™¨ as<br>æ±‡ç¼–è¿‡ç¨‹å°†æ±‡ç¼–ä»£ç è½¬æ¢æˆæœºå™¨ä»£ç ã€‚æ ¹æ®æ±‡ç¼–æŒ‡ä»¤å’Œæœºå™¨ä»£ç çš„å¯¹ç…§è¡¨ä¸€ä¸€ç¿»è¯‘ã€‚<br>æ±‡ç¼–çš„å‘½ä»¤<code>$gcc -c HelloWorld.c -o HelloWorld.o</code>ã€‚</p>
<h3 id="linking">é“¾æ¥</h3>

<p>é“¾æ¥å™¨ ld<br>ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œé“¾æ¥å™¨ä¸»è¦æ˜¯æŠŠä»£ç çš„.oæ–‡ä»¶ä¸é™æ€åº“é“¾æ¥åœ¨ä¸€èµ·ã€‚</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>ä¸€ä¸ªHelloWorld.cç¨‹åºæ˜¯å¦‚ä½•è¢«å¤„ç†ï¼Œå¾—åˆ°ä¸€ä¸ªa.outå¯æ‰§è¡Œç¨‹åºçš„å‘¢ï¼Ÿ<br><code>$gcc HelloWorld.c</code>å‘½ä»¤ï¼Œå¾—åˆ°a.out<br><code>$./a.out</code> æ‰§è¡Œ</p>
<p>è¯¥è¿‡ç¨‹å¯åˆ†ä¸ºå››ä¸ªæ­¥éª¤ï¼šé¢„å¤„ç†ï¼ˆPreprocessï¼‰æˆ–è€…å«é¢„ç¼–è¯‘ã€ç¼–è¯‘ï¼ˆCompileï¼‰ã€æ±‡ç¼–ï¼ˆAssemblyï¼‰å’Œé“¾æ¥ï¼ˆLinkingï¼‰ã€‚</p>]]>
    
    </summary>
    
      <category term="ç¼–è¯‘" scheme="http://koalahl.github.io/tags/%E7%BC%96%E8%AF%91/"/>
    
      <category term="é“¾æ¥" scheme="http://koalahl.github.io/tags/%E9%93%BE%E6%8E%A5/"/>
    
      <category term="ç¨‹åºå‘˜çš„è‡ªæˆ‘ä¿®å…»" scheme="http://koalahl.github.io/categories/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[ã€Šç¨‹åºå‘˜çš„è‡ªæˆ‘ä¿®å…»ã€‹è¯»ä¹¦ç¬”è®°-æ¸©æ•…çŸ¥æ–°]]></title>
    <link href="http://koalahl.github.io/2016/05/10/%E3%80%8A%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-%E6%B8%A9%E6%95%85%E7%9F%A5%E6%96%B0/"/>
    <id>http://koalahl.github.io/2016/05/10/ã€Šç¨‹åºå‘˜çš„è‡ªæˆ‘ä¿®å…»ã€‹è¯»ä¹¦ç¬”è®°-æ¸©æ•…çŸ¥æ–°/</id>
    <published>2016-05-10T11:10:56.000Z</published>
    <updated>2016-05-10T11:10:56.000Z</updated>
    <content type="html"><![CDATA[<p>åŸºç¡€ç¯‡å›é¡¾ä¸€ä¸‹ä¸¤ä¸ªåŸºç¡€ï¼š<br>å†…å­˜<br>çº¿ç¨‹</p>
<h2 id="memory">å†…å­˜</h2><br>æ—©æœŸçš„è®¡ç®—æœºï¼Œç¨‹åºç›´æ¥è¿è¡Œåœ¨ç‰©ç†å†…å­˜ä¸Šã€‚é‚£ä¹ˆä¹…å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼šå¦‚ä½•å°½å¯èƒ½çš„å°†æœ‰é™çš„ç‰©ç†å†…å­˜åˆ†é…ç»™å¤šä¸ªç¨‹åºä½¿ç”¨ã€‚<br><br><br>å†…å­˜ä½¿ç”¨å­˜åœ¨çš„é—®é¢˜ï¼š<br>  1.åœ°å€ç©ºé—´ä¸è¶³<br>  2.å†…å­˜ä½¿ç”¨æ•ˆç‡ä½<br>  3.ç¨‹åºè¿è¡Œçš„åœ°å€ä¸ç¡®å®š-é‡å®šä½é—®é¢˜ã€‚<br><br>é‚£ä¹ˆé’ˆå¯¹è¿™ä¸‰ä¸ªé—®é¢˜ï¼Œåˆ©ç”¨<code>ä¸­é—´å±‚</code>,è®©ç¨‹åºé—´æ¥çš„è®¿é—®ç‰©ç†åœ°å€ï¼Œæ¥è§£å†³ä»¥ä¸Šå‡ ä¸ªé—®é¢˜ã€‚<br><br><br><a id="more"></a><br><br>- åˆ†æ®µï¼šï¼ˆsegmentï¼‰å°†ç¨‹åºéœ€è¦çš„åœ°å€ç©ºé—´æ˜ å°„åˆ°ä¸€æ®µè™šæ‹Ÿç©ºé—´ä¸Šã€‚ä»¥æ­¤å°†ç¨‹åºé—´éš”ç¦»ã€‚æ­¤æ–¹æ³•è§£å†³ç¬¬ä¸€ä¸ªå’Œç¬¬ä¸‰ä¸ªé—®é¢˜ã€‚<br>- åˆ†é¡µï¼šï¼ˆpagingï¼‰å°†åœ°å€ç©ºé—´äººä¸ºåˆ†ä¸ºå›ºå®šå¤§å°çš„é¡µï¼ˆpageï¼‰ã€‚ä¸€èˆ¬ä¸º4KBå¤§å°ã€‚è™šæ‹Ÿå†…å­˜çš„å®ç°éœ€è¦ä¾é ç¡¬ä»¶æ”¯æŒã€‚é€šå¸¸é‡‡ç”¨<code>MMU(Memory Management Unit)</code>æ¥è¿›è¡Œpage mappingï¼Œå°†CPUä½¿ç”¨çš„è™šæ‹Ÿåœ°å€æ˜ å°„ä¸ºå®é™…çš„ç‰©ç†åœ°å€ã€‚<br><br><img src="/img/VPandPP.jpg" alt="è¿›ç¨‹è™šæ‹Ÿç©ºé—´ã€ç‰©ç†ç©ºé—´çš„æ˜ å°„"><br><br><h2 id="thread">çº¿ç¨‹</h2>

<p>çº¿ç¨‹ç»“æ„ï¼šçº¿ç¨‹IDã€æŒ‡ä»¤æŒ‡é’ˆPCã€çº¿ç¨‹å†…æ ˆå’Œå¯„å­˜å™¨<br><img src="/img/thread2.jpeg" alt="çº¿ç¨‹ç»“æ„"></p>
<p>ç°åœ¨åŸºæœ¬éƒ½æ˜¯å¤šçº¿ç¨‹ã€‚</p>
<p>çº¿ç¨‹çš„è®¿é—®æƒé™ã€‚</p>
<table>
<thead>
<tr>
<th>çº¿ç¨‹ç§æœ‰</th>
<th style="text-align:center">çº¿ç¨‹é—´å…±äº«</th>
</tr>
</thead>
<tbody>
<tr>
<td>- å±€éƒ¨å˜é‡</td>
<td style="text-align:center">å…¨å±€å˜é‡</td>
</tr>
<tr>
<td>- å‡½æ•°çš„å‚æ•°</td>
<td style="text-align:center">å †ä¸Šçš„æ•°æ®</td>
</tr>
<tr>
<td>- TLSæ•°æ®</td>
<td style="text-align:center">å‡½æ•°ä¸­çš„é™æ€å˜é‡</td>
</tr>
<tr>
<td></td>
<td style="text-align:center">ç¨‹åºä»£ç </td>
</tr>
<tr>
<td></td>
<td style="text-align:center">æ‰“å¼€çš„æ–‡ä»¶ã€‚çº¿ç¨‹Aæ‰“å¼€çš„æ–‡ä»¶å¯ä»¥ç”±çº¿ç¨‹Bè¯»å†™</td>
</tr>
</tbody>
</table>
<p>çº¿ç¨‹å®‰å…¨</p>
<ul>
<li>å•æŒ‡ä»¤æ“ä½œç§°ä¸ºåŸå­çš„Atomicã€‚ç®€å•æƒ…å†µä¸‹å¯ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œä½†æ˜¯åœ¨å¤æ‚çš„æ•°æ®ç»“æ„ä¸­ï¼Œå°±æœ‰å¯èƒ½ä¸èƒ½ä¿è¯ã€‚æ­¤æ—¶éœ€è¦æ›´åŠ é€šç”¨çš„æ‰‹æ®µï¼šé”</li>
<li>åŒæ­¥ä¸é”ã€‚ä½†æ˜¯è¿˜æ˜¯æœ‰å¯èƒ½å‡ºç°é—®é¢˜ï¼ŒåŸå› æ¥è‡ªäºCPUæ‰§è¡ŒæŒ‡ä»¤çš„æ¢åºï¼ˆCPUæœ‰å¯èƒ½å°†åé¢çš„ä»£ç å…ˆæ‰§è¡Œï¼‰ã€‚</li>
<li>barrieré˜»å¡æœºåˆ¶ã€‚barrieræŒ‡ä»¤ä¼šé˜»æ­¢CPUå°†barrieræŒ‡ä»¤ä¹‹å‰çš„æŒ‡ä»¤äº¤æ¢åˆ°barrierä¹‹åï¼Œåä¹‹äº¦ç„¶ã€‚</li>
</ul>
]]></content>
    <summary type="html">
    <![CDATA[<p>åŸºç¡€ç¯‡å›é¡¾ä¸€ä¸‹ä¸¤ä¸ªåŸºç¡€ï¼š<br>å†…å­˜<br>çº¿ç¨‹</p>
<h2 id = "memory">å†…å­˜</h2><br>æ—©æœŸçš„è®¡ç®—æœºï¼Œç¨‹åºç›´æ¥è¿è¡Œåœ¨ç‰©ç†å†…å­˜ä¸Šã€‚é‚£ä¹ˆä¹…å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼šå¦‚ä½•å°½å¯èƒ½çš„å°†æœ‰é™çš„ç‰©ç†å†…å­˜åˆ†é…ç»™å¤šä¸ªç¨‹åºä½¿ç”¨ã€‚<br><br><br>å†…å­˜ä½¿ç”¨å­˜åœ¨çš„é—®é¢˜ï¼š<br>  1.åœ°å€ç©ºé—´ä¸è¶³<br>  2.å†…å­˜ä½¿ç”¨æ•ˆç‡ä½<br>  3.ç¨‹åºè¿è¡Œçš„åœ°å€ä¸ç¡®å®š-é‡å®šä½é—®é¢˜ã€‚<br><br>é‚£ä¹ˆé’ˆå¯¹è¿™ä¸‰ä¸ªé—®é¢˜ï¼Œåˆ©ç”¨<code>ä¸­é—´å±‚</code>,è®©ç¨‹åºé—´æ¥çš„è®¿é—®ç‰©ç†åœ°å€ï¼Œæ¥è§£å†³ä»¥ä¸Šå‡ ä¸ªé—®é¢˜ã€‚<br><br><br>]]>
    
    </summary>
    
      <category term="å†…å­˜" scheme="http://koalahl.github.io/tags/%E5%86%85%E5%AD%98/"/>
    
      <category term="ç¨‹åºå‘˜çš„è‡ªæˆ‘ä¿®å…»" scheme="http://koalahl.github.io/categories/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[LearnSwift-å°ç™½å­¦ä¹ mapï¼Œreduceæ–¹æ³•]]></title>
    <link href="http://koalahl.github.io/2016/05/06/LearnSwift-%E5%B0%8F%E7%99%BD%E5%AD%A6%E4%B9%A0map%EF%BC%8Creduce%E6%96%B9%E6%B3%95/"/>
    <id>http://koalahl.github.io/2016/05/06/LearnSwift-å°ç™½å­¦ä¹ mapï¼Œreduceæ–¹æ³•/</id>
    <published>2016-05-06T13:30:01.000Z</published>
    <updated>2016-05-06T13:30:01.000Z</updated>
    <content type="html"><![CDATA[<p>æ•°ç»„çš„mapã€reduceæ–¹æ³•</p>
<a id="more"></a>
<p>mapæ–¹æ³•å°†éå†åºåˆ—ä¸­æ¯ä¸ªå…ƒç´ <br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>].<span class="built_in">map</span> &#123; (i) -&gt; <span class="type">Int</span> <span class="keyword">in</span></span><br><span class="line">    <span class="keyword">return</span> i * <span class="number">2</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>ç®€åŒ–ç‰ˆ<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>].<span class="built_in">map</span>(&#123;$<span class="number">0</span> * <span class="number">2</span>&#125;)</span><br></pre></td></tr></table></figure></p>
<p>reduce: i è¿™é‡Œæ˜¯ä¸€ä¸ªç´¯åŠ å™¨ï¼ˆå¹¶ä¸è¡¨ç¤ºç›¸åŠ ï¼‰ï¼Œä¿å­˜äº†å‰ä¸€æ¬¡è¿ç®—çš„ç»“æœã€‚<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>].<span class="built_in">reduce</span>(<span class="number">1</span>) &#123; (i, element) -&gt; <span class="type">Int</span> <span class="keyword">in</span></span><br><span class="line">    <span class="built_in">print</span>(i,element)</span><br><span class="line">    <span class="keyword">return</span> i * element</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>ä¸Šé¢çš„reduceæ–¹æ³•å¯ä»¥ç®€åŒ–ä¸º<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>].<span class="built_in">reduce</span>(<span class="number">1</span>, combine: *)</span><br></pre></td></tr></table></figure></p>
<p>ä¸‹é¢æ¥çœ‹çœ‹flatMap,è¯¥å‡½æ•°ä¼šå¿½ç•¥ä¸ºnilçš„é›†åˆå…ƒç´ ã€‚<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> persons: [[<span class="type">String</span>: <span class="type">AnyObject</span>]] = [[<span class="string">"name"</span>: <span class="string">"Carl Saxon"</span>, <span class="string">"city"</span>: <span class="string">"New York, NY"</span>, <span class="string">"age"</span>: <span class="number">44</span>],</span><br><span class="line">                                      [<span class="string">"name"</span>: <span class="string">"Travis Downing"</span>, <span class="string">"city"</span>: <span class="string">"El Segundo, CA"</span>, <span class="string">"age"</span>: <span class="number">34</span>],</span><br><span class="line">                                      [<span class="string">"name"</span>: <span class="string">"Liz Parker"</span>, <span class="string">"city"</span>: <span class="string">"San Francisco, CA"</span>, <span class="string">"age"</span>: <span class="number">32</span>],</span><br><span class="line">                                      [<span class="string">"name"</span>: <span class="string">"John Newden"</span>, <span class="string">"city"</span>: <span class="string">"New Jersey, NY"</span>, <span class="string">"age"</span>: <span class="number">21</span>],</span><br><span class="line">                                      [<span class="string">"name"</span>: <span class="string">"Hector Simons"</span>, <span class="string">"city"</span>: <span class="string">"San Diego, CA"</span>, <span class="string">"age"</span>: <span class="number">37</span>],</span><br><span class="line">                                      [<span class="string">"name"</span>: <span class="string">"Brian Neo"</span>, <span class="string">"age"</span>: <span class="number">27</span>]] <span class="comment">//æ³¨æ„è¿™å®¶ä¼™æ²¡æœ‰ city é”®å€¼</span></span><br><span class="line"><span class="comment">//æ‰¾åˆ°ä½åœ¨CAçš„å±…æ°‘ã€‚</span></span><br><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">peopleFromState</span><span class="params">(state:String,persons:[[String:AnyObject]])</span></span> -&gt; <span class="type">Int</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> persons.flatMap &#123; $<span class="number">0</span>[<span class="string">"city"</span>]?.componentsSeparatedByString(<span class="string">", "</span>).last&#125;.<span class="built_in">filter</span> &#123; $<span class="number">0</span> == state&#125;.<span class="built_in">count</span></span><br><span class="line">&#125;</span><br><span class="line">peopleFromState(<span class="string">"CA"</span>, persons: persons)</span><br></pre></td></tr></table></figure></p>
<p>ç”¨reduceå®ç°mapã€flatMap<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">rmap</span><span class="params">(element:[Int],transform:<span class="params">(Int)</span></span></span>-&gt;<span class="type">Int</span> ) -&gt;[<span class="type">Int</span>]&#123;</span><br><span class="line">    <span class="keyword">return</span> element.<span class="built_in">reduce</span>([<span class="type">Int</span>](), combine: &#123; (<span class="keyword">var</span> accemulator:[<span class="type">Int</span>], obj:<span class="type">Int</span>) -&gt; [<span class="type">Int</span>] <span class="keyword">in</span></span><br><span class="line">        <span class="built_in">print</span>(accemulator,obj)</span><br><span class="line">        accemulator.append(transform(obj))</span><br><span class="line">        <span class="keyword">return</span> accemulator</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">rmap([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>], transform: &#123;$<span class="number">0</span> * <span class="number">2</span>&#125;)</span><br></pre></td></tr></table></figure></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">rmap2</span><span class="params">(element:[Int],transform:<span class="params">(Int)</span></span></span>-&gt;<span class="type">Int</span>) -&gt; [<span class="type">Int</span>] &#123;</span><br><span class="line">    <span class="keyword">return</span> element.<span class="built_in">reduce</span>([<span class="type">Int</span>](), combine: &#123;$<span class="number">0</span>  + [transform($<span class="number">1</span>)]&#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> array = rmap2([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>], transform: &#123;$<span class="number">0</span> * <span class="number">2</span>&#125;)</span><br><span class="line"><span class="built_in">print</span>(array)</span><br><span class="line"></span><br><span class="line">ç»“æœéƒ½æ˜¯[<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">12</span>]</span><br></pre></td></tr></table></figure>
<p>ç†è§£ <code>$0, $1</code><br>$0,$1æ˜¯ä¸€ä¸ªå¸¸é‡ï¼Œç±»å‹æ ¹æ®æ‰€åœ¨å‡½æ•°çš„å‚æ•°ç±»å‹å†³å®šã€‚<br><img src="/img/ï¿¥0ç±»å‹.png" alt=""><br><img src="/img/$1ç±»å‹.png" alt=""><br>ä¸ºä½•å®ƒä»¬æ˜¯è¿™ä¸ªç±»å‹å‘¢ï¼Ÿ<br>å…¶æ‰€åœ¨å‡½æ•°æ˜¯combineï¼Œé‚£ä¹ˆ$0å’Œ$1çš„ç±»å‹éƒ½æ˜¯ç”±combineè¿™ä¸ª(å‡½æ•°/é—­åŒ…/æ–¹æ³•)çš„ç¬¬äºŒä¸ªå‚æ•°ç±»å‹å†³å®šçš„ã€‚æ‰€ä»¥æˆ‘ä»¬æ¥çœ‹çœ‹reduceå‡½æ•°çš„å®šä¹‰ï¼š<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="func"><span class="keyword">func</span> <span class="title">reduce</span><span class="generics">&lt;T&gt;</span><span class="params">(initial: T, @noescape combine: <span class="params">(T, <span class="keyword">Self</span>.Generator.Element)</span></span></span> <span class="keyword">throws</span> -&gt; <span class="type">T</span>) <span class="keyword">rethrows</span></span><br></pre></td></tr></table></figure></p>
<p>$0ä»£è¡¨ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå…¶ç±»å‹è¿™é‡Œæ˜¯[Int],$1ä»£è¡¨çš„æ˜¯combineå†…çš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œæ‰€ä»¥å…¶ç±»å‹å°±æ˜¯Intçš„ã€‚</p>
<p>ç”¨reduceå®ç°filter<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">rfilter</span><span class="params">(element:[Int],<span class="built_in">filter</span>:<span class="params">(Int)</span></span></span>-&gt;<span class="type">Bool</span>)-&gt; [<span class="type">Int</span>]&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> element.<span class="built_in">reduce</span>([<span class="type">Int</span>](), combine: &#123; (<span class="keyword">var</span> acc:[<span class="type">Int</span>], value:<span class="type">Int</span>) -&gt; [<span class="type">Int</span>] <span class="keyword">in</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">filter</span>(value)&#123;</span><br><span class="line">            acc.append(value)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> acc</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> xxc = rfilter([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>], <span class="built_in">filter</span>: &#123; $<span class="number">0</span> &gt; <span class="number">3</span>&#125;)</span><br><span class="line"><span class="built_in">print</span>(xxc)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">rfilter2</span><span class="params">(element:[Int],<span class="built_in">filter</span>:<span class="params">(Int)</span></span></span>-&gt;<span class="type">Bool</span>)-&gt; [<span class="type">Int</span>]&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> element.<span class="built_in">reduce</span>([<span class="type">Int</span>](), combine: &#123; <span class="keyword">guard</span> <span class="built_in">filter</span>($<span class="number">1</span>) <span class="keyword">else</span>&#123; <span class="keyword">return</span> $<span class="number">0</span>&#125;</span><br><span class="line">        <span class="keyword">return</span> $<span class="number">0</span> + [$<span class="number">1</span>]</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> oos = rfilter2([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>], <span class="built_in">filter</span>: &#123;$<span class="number">0</span> &gt; <span class="number">3</span> &#125;)</span><br><span class="line"><span class="built_in">print</span>(oos)</span><br></pre></td></tr></table></figure></p>
<p>å†çœ‹å‰é¢æè¿‡çš„é—®é¢˜ï¼šæ‰¾åˆ°ä½åœ¨CAçš„å±…æ°‘ã€‚å¹¶ä¸”è®¡ç®—ä»–ä»¬çš„å¹³å‡å¹´é¾„<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">peopleFromState</span><span class="params">(state:String,persons:[[String:AnyObject]])</span></span> -&gt; (population:<span class="type">Int</span>,averageAge:<span class="type">CGFloat</span>)&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//return persons.flatMap &#123; $0["city"]?.componentsSeparatedByString(", ").last&#125;.filter &#123; $0 == state&#125;.count</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">typealias</span> <span class="type">Result</span> = (population:<span class="type">Int</span>,averageAge:<span class="type">CGFloat</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> u = persons.<span class="built_in">reduce</span>((populatoin:<span class="number">0</span>,averageAge:<span class="number">0.0</span>)) &#123; (<span class="keyword">var</span> result:<span class="type">Result</span>, dic:[<span class="type">String</span>:<span class="type">AnyObject</span>]) -&gt; <span class="type">Result</span> <span class="keyword">in</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> locationStr = dic[<span class="string">"city"</span>]?.componentsSeparatedByString(<span class="string">", "</span>).last,<span class="keyword">let</span> personAge = dic[<span class="string">"age"</span>] <span class="keyword">where</span> locationStr == state <span class="keyword">else</span>&#123; <span class="keyword">return</span> result&#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> (result.population + <span class="number">1</span>,result.averageAge + <span class="type">CGFloat</span>(personAge <span class="keyword">as</span>! <span class="type">NSNumber</span>))</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (u.populatoin,u.averageAge / <span class="type">CGFloat</span>(u.populatoin))</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> result = peopleFromState(<span class="string">"CA"</span>, persons: persons)</span><br><span class="line">result.population <span class="comment">// 3</span></span><br><span class="line">result.averageAge <span class="comment">// 34.333333334</span></span><br></pre></td></tr></table></figure></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>æ•°ç»„çš„mapã€reduceæ–¹æ³•</p>]]>
    
    </summary>
    
      <category term="LearnSwift" scheme="http://koalahl.github.io/tags/LearnSwift/"/>
    
      <category term="Swift" scheme="http://koalahl.github.io/categories/Swift/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Learn Swift - Section 4th æ‰©å±•ã€åè®®ã€æ³›å‹]]></title>
    <link href="http://koalahl.github.io/2016/04/28/Learn-Swift-Section-Four-%E6%89%A9%E5%B1%95%E3%80%81%E5%8D%8F%E8%AE%AE%E3%80%81%E6%B3%9B%E5%9E%8B/"/>
    <id>http://koalahl.github.io/2016/04/28/Learn-Swift-Section-Four-æ‰©å±•ã€åè®®ã€æ³›å‹/</id>
    <published>2016-04-28T08:50:42.000Z</published>
    <updated>2016-04-28T08:50:42.000Z</updated>
    <content type="html"><![CDATA[<h2 id="extension">æ‰©å±• Extension</h2><br>æ‰©å±•<code>Extension</code>å°±æ˜¯å‘ä¸€ä¸ªå·²æœ‰çš„ç±»ã€ç»“æ„ä½“ã€æšä¸¾ç±»å‹æˆ–è€…åè®®ç±»å‹æ·»åŠ æ–°åŠŸèƒ½ï¼ˆfunctionalityï¼‰ã€‚è¿™åŒ…æ‹¬åœ¨æ²¡æœ‰æƒé™è·å–åŸå§‹æºä»£ç çš„æƒ…å†µä¸‹æ‰©å±•ç±»å‹çš„èƒ½åŠ›ï¼ˆå³é€†å‘å»ºæ¨¡ï¼‰ã€‚æ‰©å±•å’Œ Objective-C ä¸­çš„åˆ†ç±»ï¼ˆcategoriesï¼‰ç±»ä¼¼ã€‚ï¼ˆä¸è¿‡ä¸ Objective-C ä¸åŒçš„æ˜¯ï¼ŒSwift çš„æ‰©å±•æ²¡æœ‰åå­—ã€‚ï¼‰<br><br>Swift ä¸­çš„æ‰©å±•å¯ä»¥ï¼š<br>- æ·»åŠ è®¡ç®—å‹å±æ€§å’Œè®¡ç®—å‹é™æ€å±æ€§<br>- å®šä¹‰å®ä¾‹æ–¹æ³•å’Œç±»å‹æ–¹æ³•<br>- æä¾›æ–°çš„æ„é€ å™¨<br>- å®šä¹‰ä¸‹æ ‡<br>- å®šä¹‰å’Œä½¿ç”¨æ–°çš„åµŒå¥—ç±»å‹<br>- ä½¿ä¸€ä¸ªå·²æœ‰ç±»å‹ç¬¦åˆæŸä¸ªåè®®<br>- ä¹Ÿå¯ä»¥å¯¹ä¸€ä¸ªåè®®è¿›è¡Œæ‰©å±•<br><br><a id="more"></a><br><br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Int</span></span>&#123;</span><br><span class="line">    <span class="comment">//è½¬æ¢æˆå°æ—¶</span></span><br><span class="line">    <span class="keyword">var</span> hours : <span class="type">Int</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span>/<span class="number">3600</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> ago : <span class="type">Int</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> -<span class="keyword">self</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//xä¹‹å‰çš„æ—¶é—´</span></span><br><span class="line">    <span class="func"><span class="keyword">func</span> <span class="title">ago</span><span class="params">(x:Int)</span></span> -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span> - x</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> currentTime = <span class="number">7200</span></span><br><span class="line"><span class="number">3</span>.hours</span><br><span class="line"><span class="number">3</span>.hours.ago</span><br><span class="line"><span class="number">3</span>.ago + currentTime</span><br><span class="line"><span class="comment">//5ç§’ä¹‹å‰</span></span><br><span class="line">currentTime.ago(<span class="number">5</span>)</span><br><span class="line"><span class="comment">//1å°æ—¶ä¹‹å‰</span></span><br><span class="line">currentTime.hours.ago(<span class="number">1</span>)</span><br><span class="line">currentTime.hours.ago(<span class="number">3600</span>.hours)</span><br><span class="line"><span class="built_in">print</span>(<span class="number">3</span>.ago)</span><br></pre></td></tr></table></figure><br><br><h2 id="protocol">åè®® Protocol</h2><br>åè®®å®šä¹‰äº†ä¸€ä¸ªè“å›¾ï¼Œè§„å®šäº†ç”¨æ¥å®ç°æŸä¸€ç‰¹å®šå·¥ä½œæˆ–è€…åŠŸèƒ½æ‰€å¿…éœ€çš„æ–¹æ³•å’Œå±æ€§ã€‚ç±»ï¼Œç»“æ„ä½“æˆ–æšä¸¾ç±»å‹éƒ½å¯ä»¥éµå¾ªåè®®ï¼Œå¹¶æä¾›å…·ä½“å®ç°æ¥å®Œæˆåè®®å®šä¹‰çš„æ–¹æ³•å’ŒåŠŸèƒ½ã€‚ä»»æ„èƒ½å¤Ÿæ»¡è¶³åè®®è¦æ±‚çš„ç±»å‹è¢«ç§°ä¸ºéµå¾ª(conform)è¿™ä¸ªåè®®ã€‚<br><br>é™¤äº†éµå¾ªåè®®çš„ç±»å‹å¿…é¡»å®ç°é‚£äº›æŒ‡å®šçš„è§„å®šä»¥å¤–ï¼Œè¿˜å¯ä»¥å¯¹åè®®è¿›è¡Œæ‰©å±•ï¼Œå®ç°ä¸€äº›ç‰¹æ®Šçš„è§„å®šæˆ–è€…ä¸€äº›é™„åŠ çš„åŠŸèƒ½ï¼Œä½¿å¾—éµå¾ªçš„ç±»å‹èƒ½å¤Ÿæ”¶ç›Šã€‚<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">SellProducts</span></span>&#123;</span><br><span class="line">    <span class="func"><span class="keyword">func</span> <span class="title">sellProducts</span><span class="params">(product:String)</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> name:<span class="type">String</span></span><br><span class="line">    <span class="keyword">weak</span> <span class="keyword">var</span> delegate:<span class="type">Seller</span>?</span><br><span class="line">    <span class="built_in">lazy</span> <span class="keyword">var</span> someClosure:(<span class="type">Int</span>,<span class="type">String</span>)-&gt;<span class="type">String</span> = &#123;</span><br><span class="line">        <span class="comment">//åœ¨é—­åŒ…ä¸­å°†selfä¿®é¥°ä¸ºæ— ä¸»å¼•ç”¨ã€‚å°†delegate ä¿®é¥°ä¸º å¼±å¼•ç”¨</span></span><br><span class="line">        [<span class="keyword">unowned</span> <span class="keyword">self</span>,<span class="keyword">weak</span> delegate = <span class="keyword">self</span>.delegate!]<span class="comment">//æ•è·åˆ—è¡¨</span></span><br><span class="line">        (index:<span class="type">Int</span>,strToProcess:<span class="type">String</span>)-&gt;<span class="type">String</span> <span class="keyword">in</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">"<span class="subst">\(<span class="keyword">self</span>.name)</span>,<span class="subst">\(<span class="keyword">self</span>.delegate)</span>,<span class="subst">\(delegate)</span>"</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">init</span>(name:<span class="type">String</span>,delegate:<span class="type">Seller</span>?)&#123;</span><br><span class="line">        <span class="keyword">self</span>.name = name;</span><br><span class="line">        <span class="keyword">self</span>.delegate = delegate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="func"><span class="keyword">func</span> <span class="title">giveSellerProducts</span><span class="params">(product:String )</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">self</span>.delegate?.sellProducts(product)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Seller</span> : <span class="title">SellProducts</span></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> product:<span class="type">String</span>?</span><br><span class="line">    <span class="func"><span class="keyword">func</span> <span class="title">sellProducts</span><span class="params">( product: String)</span></span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.product = product</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> seller = <span class="type">Seller</span>()</span><br><span class="line"><span class="keyword">var</span> person = <span class="type">Person</span> (name: <span class="string">"Hanliu"</span>, delegate: seller)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆšå¼€å§‹selleræ˜¯æ²¡æœ‰å•†å“çš„ï¼Œè¦ç­‰åˆ°Personç»™seller</span></span><br><span class="line"><span class="built_in">print</span>(seller.product)</span><br><span class="line"><span class="comment">//personå‘Šè¯‰sellerï¼Œå¸®æˆ‘å–è‹¹æœ</span></span><br><span class="line">person.giveSellerProducts(<span class="string">"apple"</span>)</span><br><span class="line"><span class="comment">//ç°åœ¨selleræ‰‹ä¸­å°±æœ‰äº†å•†å“äº†</span></span><br><span class="line"><span class="built_in">print</span>(seller.product!)</span><br><span class="line"></span><br><span class="line">person.someClosure(<span class="number">1</span>,<span class="string">"haha"</span>)</span><br></pre></td></tr></table></figure><br><br>åè®®ä¸­çš„å±æ€§ä¸€å®šè¦æŒ‡æ˜è¯»å†™çŠ¶æ€<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">SomeProtocol</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> mustBeSettable:<span class="type">Int</span>&#123;<span class="keyword">get</span> <span class="keyword">set</span>&#125;<span class="comment">//è¡¨ç¤ºè¯¥å±æ€§æ˜¯å¯è¯»å¯å†™</span></span><br><span class="line">    <span class="keyword">var</span> notNeededForSetable:<span class="type">String</span>&#123;<span class="keyword">get</span>&#125;<span class="comment">//è¡¨ç¤ºåªè¯»</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> someTypedProperty:<span class="type">String</span>&#123;<span class="keyword">get</span> <span class="keyword">set</span>&#125;<span class="comment">//ç±»å±æ€§(å½“åè®®éµå¾ªè€…æ˜¯classæ˜¯ï¼Œå¯ä»¥ç”¨classå…³é”®å­—)</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">FullyName</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> fullname:<span class="type">String</span>&#123;<span class="keyword">get</span>&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">PersonName</span>:<span class="title">FullyName</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> fullname: <span class="type">String</span></span><br><span class="line">    <span class="keyword">var</span> shortName :<span class="type">String</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> person = <span class="type">PersonName</span>(fullname: <span class="string">"Levi John"</span>,shortName: <span class="string">"LJ"</span>)</span><br><span class="line">person.fullname</span><br></pre></td></tr></table></figure><br><br>åè®®æœ¬èº«å¹¶ä¸å®ç°ä»»ä½•åŠŸèƒ½ï¼Œä½†æ˜¯åè®®å¯ä»¥è¢«ä½œä¸ºç±»å‹ä½¿ç”¨ã€‚å°±æ˜¯ä¸Stringã€Intè¿™äº›ç±»å‹çš„ä½œç”¨ç›¸åŒã€‚<br>- ä½œä¸ºå‡½æ•°ã€æ–¹æ³•æˆ–æ„é€ å™¨ä¸­çš„å‚æ•°ç±»å‹æˆ–è¿”å›å€¼ç±»å‹<br>- ä½œä¸ºå¸¸é‡ã€å˜é‡æˆ–å±æ€§çš„ç±»å‹<br>- ä½œä¸ºæ•°ç»„ã€å­—å…¸æˆ–å…¶ä»–å®¹å™¨ä¸­çš„å…ƒç´ çš„ç±»å‹<br><br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">RandomGenerator</span> </span>&#123;</span><br><span class="line">    <span class="func"><span class="keyword">func</span> <span class="title">random</span><span class="params">()</span></span>-&gt;<span class="type">Double</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LinerGenerator</span>:<span class="title">RandomGenerator</span> </span>&#123;</span><br><span class="line">    <span class="func"><span class="keyword">func</span> <span class="title">random</span><span class="params">()</span></span> -&gt; <span class="type">Double</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">11.0011</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dice</span></span>&#123;</span><br><span class="line">    <span class="keyword">let</span> slides:<span class="type">Int</span></span><br><span class="line">    <span class="keyword">var</span> generator:<span class="type">RandomGenerator</span><span class="comment">//ä½œä¸ºå±æ€§ç±»å‹</span></span><br><span class="line">    <span class="keyword">init</span>(slides:<span class="type">Int</span>,generator:<span class="type">RandomGenerator</span>)&#123;<span class="comment">//ä½œä¸ºå‚æ•°ç±»å‹</span></span><br><span class="line">        <span class="keyword">self</span>.slides = slides</span><br><span class="line">        <span class="keyword">self</span>.generator = generator</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="func"><span class="keyword">func</span> <span class="title">roll</span><span class="params">()</span></span> -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">Int</span>(<span class="keyword">self</span>.generator.random() * <span class="type">Double</span>(slides))+<span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><br>åœ¨æ‰©å±•ä¸­éµå¾ªåè®®ï¼Œå¢åŠ åè®®æˆå‘˜ï¼ˆè¿™ç§æ–¹æ³•ä¸ç›´æ¥åœ¨ç±»åé¢éµå¾ªåè®®çš„æ•ˆæœç›¸åŒï¼‰ã€‚<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">TextRepresentable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> textDescription :<span class="type">String</span>&#123;<span class="keyword">get</span>&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Dice</span>:<span class="title">TextRepresentable</span></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> textDescription:<span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"<span class="subst">\(slides)</span> - slides"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> dice = <span class="type">Dice</span>(slides: <span class="number">8</span>, generator: <span class="type">LinerGenerator</span>())</span><br><span class="line">dice.textDescription<span class="comment">//ç°åœ¨Diceçš„æ‰€æœ‰å®ä¾‹éƒ½å¯ä»¥ä½¿ç”¨textDescriptionå±æ€§äº†ã€‚</span></span><br></pre></td></tr></table></figure><br><br>åè®®ç±»å‹çš„é›†åˆ<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> sir  = <span class="type">Dice</span>(slides: <span class="number">1</span>, generator: <span class="type">LinerGenerator</span>())</span><br><span class="line"><span class="keyword">let</span> sime = <span class="type">Dice</span>(slides: <span class="number">2</span>, generator: <span class="type">LinerGenerator</span>())</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> arrayOfProtocolElements:[<span class="type">TextRepresentable</span>] = [dice,sir,sime]</span><br><span class="line"><span class="keyword">for</span> element <span class="keyword">in</span> arrayOfProtocolElements&#123;</span><br><span class="line">    <span class="built_in">print</span>(element.textDescription)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><br>åè®®èƒ½å¤Ÿç»§æ‰¿.<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">TextGo</span>:<span class="title">TextRepresentable</span></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> prettyTextDescription:<span class="type">String</span>&#123;<span class="keyword">get</span>&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Dice</span>:<span class="title">TextGo</span></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> prettyTextDescription:<span class="type">String</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> textDescription + <span class="string">"hello"</span><span class="comment">//å¯ä»¥ä½¿ç”¨ä¸Šå±‚åè®®çš„å±æ€§</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><br>ç±»ä¸“å±åè®®.åœ¨åè®®ç»§æ‰¿åˆ—è¡¨ä¸­çš„é¦–ä½æ·»åŠ classå…³é”®å­—,ç„¶åè¿™ä¸ªåè®®å°±åªèƒ½è¢«ç±»éµå¾ªï¼Œè€Œä¸èƒ½è¢«ç»“æ„ä½“æˆ–è€…æšä¸¾éµå¾ªã€‚<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">ClassOnlyProtocol</span>:<span class="title">class</span></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> mylove:<span class="type">String</span>&#123;<span class="keyword">get</span>&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><br>æ£€æŸ¥åè®®ä¸€è‡´æ€§<br>ä½¿ç”¨<code>is</code>ã€<code>as?</code>ã€<code>as!</code><br><br>åè®®æœ¬èº«ä¹Ÿå¯ä»¥è¢«æ‰©å±•<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">TextRepresentable</span></span>&#123;<span class="comment">//TextRepresentableæ˜¯ä¸ªåè®®</span></span><br><span class="line">    <span class="keyword">var</span> longTextDescription:<span class="type">String</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"<span class="subst">\(textDescription)</span> + long"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><br>ä¸ºåè®®æ‰©å±•æ·»åŠ é™åˆ¶æ¡ä»¶ where<br>æ‰©å±•<code>CollectionType</code>åè®®ï¼Œè®©å…¶éµå¾ªè€…çš„å…ƒç´ å¿…é¡»éµå¾ª<code>TextRepresentable</code>åè®®<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">CollectionType</span> <span class="title">where</span> <span class="title">Generator</span>.<span class="title">Element</span>:<span class="title">TextRepresentable</span></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> textDescription:<span class="type">String</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> items = <span class="keyword">self</span>.<span class="built_in">map</span>&#123;$<span class="number">0</span>.textDescription&#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"A hamster named <span class="subst">\(items)</span>"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Hamster</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span></span><br><span class="line">    <span class="keyword">var</span> textDescription: <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"a hamster named <span class="subst">\(name)</span>"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Hamster</span>: <span class="title">TextRepresentable</span> </span>&#123;&#125;<span class="comment">//è®©Hamsteréµå¾ªTextRepresentableåè®®</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> murrayTheHamster = <span class="type">Hamster</span>(name: <span class="string">"Murray"</span>)</span><br><span class="line"><span class="keyword">let</span> morganTheHamster = <span class="type">Hamster</span>(name: <span class="string">"Morgan"</span>)</span><br><span class="line"><span class="keyword">let</span> mauriceTheHamster = <span class="type">Hamster</span>(name: <span class="string">"Maurice"</span>)</span><br><span class="line"><span class="keyword">let</span> hamsters = [murrayTheHamster, morganTheHamster, mauriceTheHamster]</span><br><span class="line"></span><br><span class="line">å› ä¸º<span class="type">Array</span>éµå¾ªäº†`<span class="type">CollectionType</span>`åè®®ï¼Œè€Œhamsteråˆéµå¾ªäº†`<span class="type">TextRepresentable</span>`åè®®ï¼Œæ‰€ä»¥å°±æ»¡è¶³äº†æ¡ä»¶ï¼Œæ­¤æ—¶ arrayå¯ä»¥ä½¿ç”¨`textDescription`å±æ€§</span><br><span class="line"><span class="built_in">print</span>(hamsters.textDescription)</span><br><span class="line"></span><br><span class="line">ç»“æœï¼š<span class="type">A</span> hamster named [<span class="string">"a hamster named Murray"</span>, <span class="string">"a hamster named Morgan"</span>, <span class="string">"a hamster named Maurice"</span>]</span><br></pre></td></tr></table></figure><br><br><h2 id="Generics">æ³›å‹ Generics</h2>

<p>æ³›å‹ä»£ç å¯ä»¥è®©ä½ å†™å‡ºæ ¹æ®è‡ªæˆ‘éœ€æ±‚å®šä¹‰ã€é€‚ç”¨äºä»»ä½•ç±»å‹çš„ï¼Œçµæ´»ä¸”å¯é‡ç”¨çš„å‡½æ•°å’Œç±»å‹ã€‚å®ƒçš„å¯ä»¥è®©ä½ é¿å…é‡å¤çš„ä»£ç ï¼Œç”¨ä¸€ç§æ¸…æ™°å’ŒæŠ½è±¡çš„æ–¹å¼æ¥è¡¨è¾¾ä»£ç çš„æ„å›¾ã€‚</p>
<p>æ³›å‹æ˜¯ Swift å¼ºå¤§ç‰¹å¾ä¸­çš„å…¶ä¸­ä¸€ä¸ªï¼Œè®¸å¤š Swift æ ‡å‡†åº“æ˜¯é€šè¿‡æ³›å‹ä»£ç æ„å»ºå‡ºæ¥çš„ã€‚äº‹å®ä¸Šï¼Œæ³›å‹çš„ä½¿ç”¨è´¯ç©¿äº†æ•´æœ¬è¯­è¨€æ‰‹å†Œï¼Œåªæ˜¯ä½ æ²¡æœ‰å‘ç°è€Œå·²ã€‚ä¾‹å¦‚ï¼ŒSwift çš„æ•°ç»„å’Œå­—å…¸ç±»å‹éƒ½æ˜¯æ³›å‹é›†ã€‚ä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªIntæ•°ç»„ï¼Œä¹Ÿå¯åˆ›å»ºä¸€ä¸ªStringæ•°ç»„ï¼Œæˆ–è€…ç”šè‡³äºå¯ä»¥æ˜¯ä»»ä½•å…¶ä»– Swift çš„ç±»å‹æ•°æ®æ•°ç»„ã€‚åŒæ ·çš„ï¼Œä½ ä¹Ÿå¯ä»¥åˆ›å»ºå­˜å‚¨ä»»ä½•æŒ‡å®šç±»å‹çš„å­—å…¸ï¼ˆdictionaryï¼‰ï¼Œè€Œä¸”è¿™äº›ç±»å‹å¯ä»¥æ˜¯æ²¡æœ‰é™åˆ¶çš„</p>
<p></p><h3 id="func">æ³›å‹å‡½æ•°</h3><br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">swapTwoValues</span><span class="generics">&lt;T&gt;</span><span class="params">(<span class="keyword">inout</span> a:T,<span class="keyword">inout</span> b:T)</span></span>&#123;</span><br><span class="line">    <span class="keyword">let</span> tempValue = a</span><br><span class="line">    a = b</span><br><span class="line">    b = tempValue</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p>
<ul>
<li>T è¡¨ç¤ºä¸€ä¸ªå ä½å‘½åç±»å‹</li>
<li>å°–æ‹¬å·<t>è¡¨ç¤ºå®ƒé‡Œé¢çš„Tæ˜¯ç”±å‡½æ•°<code>swapTwoValues</code>å®šä¹‰çš„ä¸€ä¸ªç±»å‹ï¼Œswiftä¸ä¼šå»æŸ¥æ‰¾å‘½åä¸ºTçš„å®é™…ç±»å‹</t></li>
<li>å‚æ•°åˆ—è¡¨ä¸­çš„Tæ²¡æœ‰å®é™…ç±»å‹ï¼Œä»…è¡¨ç¤ºä¸¤ä¸ªå‚æ•°çš„ç±»å‹éœ€è¦ç›¸åŒ</li>
</ul>
<p></p><h3 id="generic stack">å®ç°ä¸€ä¸ªæ³›å‹ç‰ˆæœ¬çš„æ ˆ</h3><br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Stack</span>&lt;<span class="title">T</span>&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> items = [<span class="type">T</span>]()</span><br><span class="line">    <span class="keyword">mutating</span> <span class="func"><span class="keyword">func</span> <span class="title">push</span><span class="params">(item:T)</span></span>&#123;</span><br><span class="line">        items.append(item)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">mutating</span> <span class="func"><span class="keyword">func</span> <span class="title">pop</span><span class="params">()</span></span>&#123;</span><br><span class="line">        items.removeLast()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æ³›å‹å®ä¾‹çš„åˆ›å»º,éƒ½å¿…é¡»æŒ‡å®šTçš„ç±»å‹</span></span><br><span class="line"><span class="keyword">var</span> stack = <span class="type">Stack</span>(items: [<span class="string">""</span>])</span><br><span class="line"><span class="keyword">var</span> stack2 = <span class="type">Stack</span>&lt;<span class="type">String</span>&gt;()</span><br></pre></td></tr></table></figure><p></p>
<p>//æ‰©å±•ä¸€ä¸ªæ³›å‹ç±»å‹:æ·»åŠ ä¸€ä¸ªå±æ€§<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Stack</span></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> topItem:<span class="type">T</span>?&#123;</span><br><span class="line">        <span class="keyword">return</span> items.isEmpty ? <span class="literal">nil</span> : items[items.<span class="built_in">count</span> - <span class="number">1</span>]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">stack2.topItem</span><br></pre></td></tr></table></figure></p>
<p></p><h3 id="associated type">å…³è”ç±»å‹ï¼ˆAssociated Typeï¼‰ </h3><br>swift2.2è²Œä¼¼ä¿®æ”¹äº†ã€‚å£°æ˜çš„æ—¶å€™ç”¨associatedtype å®ç°çš„æ—¶å€™ç”¨typealias<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">Container</span></span>&#123;</span><br><span class="line">    associatedtype <span class="type">ItemType</span></span><br><span class="line">    <span class="keyword">var</span> <span class="built_in">count</span>:<span class="type">Int</span>&#123;<span class="keyword">get</span>&#125;</span><br><span class="line">    <span class="keyword">mutating</span> <span class="func"><span class="keyword">func</span> <span class="title">append</span><span class="params">(item:ItemType)</span></span></span><br><span class="line">    <span class="keyword">subscript</span> (i:<span class="type">Int</span>)-&gt;<span class="type">ItemType</span>&#123;<span class="keyword">get</span>&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è®©æ³›å‹Stackéµå¾ªContaineråè®®</span></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Stack</span>:<span class="title">Container</span></span>&#123;</span><br><span class="line">    <span class="comment">//typealias ItemType = T //è¿™ä¸€è¡Œä¹Ÿæ˜¯å¯ä»¥å»æ‰ï¼Œå› ä¸ºswifté€šè¿‡ç±»å‹æ¨æ–­å¯ä»¥åˆ¤æ–­å‡ºTçš„ç±»å‹</span></span><br><span class="line">    <span class="keyword">mutating</span> <span class="func"><span class="keyword">func</span> <span class="title">append</span><span class="params">(item: T)</span></span> &#123;</span><br><span class="line">        <span class="keyword">return</span>  <span class="keyword">self</span>.push(item)<span class="comment">//æˆ–è€…ï¼šitems.append(item)</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> <span class="built_in">count</span>:<span class="type">Int</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> items.<span class="built_in">count</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">subscript</span>(i:<span class="type">Int</span>)-&gt;<span class="type">T</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> items[i]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p>
]]></content>
    <summary type="html">
    <![CDATA[<h2 id = "extension">æ‰©å±• Extension</h2><br>æ‰©å±•<code>Extension</code>å°±æ˜¯å‘ä¸€ä¸ªå·²æœ‰çš„ç±»ã€ç»“æ„ä½“ã€æšä¸¾ç±»å‹æˆ–è€…åè®®ç±»å‹æ·»åŠ æ–°åŠŸèƒ½ï¼ˆfunctionalityï¼‰ã€‚è¿™åŒ…æ‹¬åœ¨æ²¡æœ‰æƒé™è·å–åŸå§‹æºä»£ç çš„æƒ…å†µä¸‹æ‰©å±•ç±»å‹çš„èƒ½åŠ›ï¼ˆå³é€†å‘å»ºæ¨¡ï¼‰ã€‚æ‰©å±•å’Œ Objective-C ä¸­çš„åˆ†ç±»ï¼ˆcategoriesï¼‰ç±»ä¼¼ã€‚ï¼ˆä¸è¿‡ä¸ Objective-C ä¸åŒçš„æ˜¯ï¼ŒSwift çš„æ‰©å±•æ²¡æœ‰åå­—ã€‚ï¼‰<br><br>Swift ä¸­çš„æ‰©å±•å¯ä»¥ï¼š<br>- æ·»åŠ è®¡ç®—å‹å±æ€§å’Œè®¡ç®—å‹é™æ€å±æ€§<br>- å®šä¹‰å®ä¾‹æ–¹æ³•å’Œç±»å‹æ–¹æ³•<br>- æä¾›æ–°çš„æ„é€ å™¨<br>- å®šä¹‰ä¸‹æ ‡<br>- å®šä¹‰å’Œä½¿ç”¨æ–°çš„åµŒå¥—ç±»å‹<br>- ä½¿ä¸€ä¸ªå·²æœ‰ç±»å‹ç¬¦åˆæŸä¸ªåè®®<br>- ä¹Ÿå¯ä»¥å¯¹ä¸€ä¸ªåè®®è¿›è¡Œæ‰©å±•<br><br>]]>
    
    </summary>
    
      <category term="LearnSwift" scheme="http://koalahl.github.io/tags/LearnSwift/"/>
    
      <category term="Swift" scheme="http://koalahl.github.io/categories/Swift/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Learn Swift - Section 3rd ç±»ä¸ç»“æ„ä½“]]></title>
    <link href="http://koalahl.github.io/2016/04/26/Learn-Swift-Section-Three/"/>
    <id>http://koalahl.github.io/2016/04/26/Learn-Swift-Section-Three/</id>
    <published>2016-04-26T08:21:59.000Z</published>
    <updated>2016-04-26T08:21:59.000Z</updated>
    <content type="html"><![CDATA[<p>ç±»ä¸ç»“æ„ä½“çš„å…±åŒç‚¹ï¼š</p>
<ul>
<li>å®šä¹‰å±æ€§ç”¨äºå­˜å‚¨å€¼</li>
<li>å®šä¹‰æ–¹æ³•ç”¨äºæä¾›åŠŸèƒ½</li>
<li>å®šä¹‰é™„å±è„šæœ¬ç”¨äºè®¿é—®å€¼</li>
<li>å®šä¹‰æ„é€ å™¨ç”¨äºç”Ÿæˆåˆå§‹åŒ–å€¼</li>
<li>é€šè¿‡æ‰©å±•ä»¥å¢åŠ é»˜è®¤å®ç°çš„åŠŸèƒ½</li>
<li>å®ç°åè®®ä»¥æä¾›æŸç§æ ‡å‡†åŠŸèƒ½</li>
</ul>
<p>ä¸ç»“æ„ä½“ç›¸æ¯”ï¼Œç±»è¿˜æœ‰å¦‚ä¸‹çš„é™„åŠ åŠŸèƒ½ï¼š</p>
<ul>
<li>ç»§æ‰¿å…è®¸ä¸€ä¸ªç±»ç»§æ‰¿å¦ä¸€ä¸ªç±»çš„ç‰¹å¾</li>
<li>ç±»å‹è½¬æ¢å…è®¸åœ¨è¿è¡Œæ—¶æ£€æŸ¥å’Œè§£é‡Šä¸€ä¸ªç±»å®ä¾‹çš„ç±»å‹</li>
<li>è§£æ„å™¨å…è®¸ä¸€ä¸ªç±»å®ä¾‹é‡Šæ”¾ä»»ä½•å…¶æ‰€è¢«åˆ†é…çš„èµ„æº</li>
<li>å¼•ç”¨è®¡æ•°å…è®¸å¯¹ä¸€ä¸ªç±»çš„å¤šæ¬¡å¼•ç”¨<a id="more"></a>
</li>
</ul>
<p>æ›´å¤šä¿¡æ¯è¯·å‚è§ç»§æ‰¿ï¼Œç±»å‹è½¬æ¢ï¼Œææ„è¿‡ç¨‹ï¼Œå’Œè‡ªåŠ¨å¼•ç”¨è®¡æ•°ã€‚</p>
<p>æ³¨æ„</p>
<ul>
<li>ç»“æ„ä½“æ€»æ˜¯é€šè¿‡è¢«å¤åˆ¶çš„æ–¹å¼åœ¨ä»£ç ä¸­ä¼ é€’ï¼Œä¸ä½¿ç”¨å¼•ç”¨è®¡æ•°ã€‚</li>
</ul>
<p></p><h3 id="1">1.å€¼ç±»å‹ä¸å¼•ç”¨ç±»å‹</h3><br>å€¼ç±»å‹è¢«èµ‹äºˆç»™ä¸€ä¸ªå˜é‡ã€å¸¸é‡æˆ–è€…è¢«ä¼ é€’ç»™ä¸€ä¸ªå‡½æ•°çš„æ—¶å€™ï¼Œå…¶å€¼ä¼šè¢«æ‹·è´ã€‚<p></p>
<p>åœ¨ä¹‹å‰çš„ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬å·²ç»å¤§é‡ä½¿ç”¨äº†å€¼ç±»å‹ã€‚å®é™…ä¸Šï¼Œåœ¨ Swift ä¸­ï¼Œæ‰€æœ‰çš„åŸºæœ¬ç±»å‹ï¼šæ•´æ•°ï¼ˆIntegerï¼‰ã€æµ®ç‚¹æ•°ï¼ˆfloating-pointï¼‰ã€å¸ƒå°”å€¼ï¼ˆBooleanï¼‰ã€å­—ç¬¦ä¸²ï¼ˆstring)ã€æ•°ç»„ï¼ˆarrayï¼‰å’Œå­—å…¸ï¼ˆdictionaryï¼‰ï¼Œéƒ½æ˜¯å€¼ç±»å‹ï¼Œå¹¶ä¸”åœ¨åº•å±‚éƒ½æ˜¯ä»¥ç»“æ„ä½“çš„å½¢å¼æ‰€å®ç°ã€‚</p>
<p>åœ¨ Swift ä¸­ï¼Œæ‰€æœ‰çš„ç»“æ„ä½“å’Œæšä¸¾ç±»å‹éƒ½æ˜¯å€¼ç±»å‹ã€‚è¿™æ„å‘³ç€å®ƒä»¬çš„å®ä¾‹ï¼Œä»¥åŠå®ä¾‹ä¸­æ‰€åŒ…å«çš„ä»»ä½•å€¼ç±»å‹å±æ€§ï¼Œåœ¨ä»£ç ä¸­ä¼ é€’çš„æ—¶å€™éƒ½ä¼šè¢«å¤åˆ¶ã€‚</p>
<p>â€œä¸å€¼ç±»å‹ä¸åŒï¼Œå¼•ç”¨ç±»å‹åœ¨è¢«èµ‹äºˆåˆ°ä¸€ä¸ªå˜é‡ã€å¸¸é‡æˆ–è€…è¢«ä¼ é€’åˆ°ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œå…¶å€¼ä¸ä¼šè¢«æ‹·è´ã€‚å› æ­¤ï¼Œå¼•ç”¨çš„æ˜¯å·²å­˜åœ¨çš„å®ä¾‹æœ¬èº«è€Œä¸æ˜¯å…¶æ‹·è´ã€‚â€</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> marray = [<span class="string">"lopl"</span>,<span class="string">"liu"</span>,<span class="string">"han"</span>]</span><br><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">modifyArray</span><span class="params">()</span></span>  &#123;</span><br><span class="line">    <span class="keyword">var</span> saray = marray</span><br><span class="line">    saray.removeAtIndex(<span class="number">2</span>)</span><br><span class="line">&#125;</span><br><span class="line">modifyArray()</span><br><span class="line">marray<span class="comment">//å¹¶æ²¡æœ‰å˜ï¼Œè¯´æ˜æ˜¯å€¼æ‹·è´</span></span><br></pre></td></tr></table></figure>
<p></p><h3 id="2">2.å°†ç»“æ„ä½“å®ä¾‹èµ‹å€¼ç»™ä¸€ä¸ªå¸¸é‡ï¼Œåˆ™æ— æ³•ä¿®æ”¹ç»“æ„ä½“ä¸­çš„å±æ€§ï¼Œå³ä½¿å±æ€§æ˜¯å˜é‡ã€‚</h3><br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Cars</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> name = <span class="string">""</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> car = <span class="type">Cars</span>()</span><br><span class="line">car.name = <span class="string">"Audi"</span></span><br><span class="line"><span class="comment">//è€Œç±»åˆ™å¯ä»¥ä¿®æ”¹ï¼Œå› ä¸ºç±»æ˜¯å¼•ç”¨ç±»å‹ã€‚</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CreateNewLife</span></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> name = <span class="string">""</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animals</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> kind = <span class="string">""</span></span><br><span class="line">    <span class="keyword">let</span> planet = <span class="string">"Earth"</span></span><br><span class="line">    <span class="built_in">lazy</span> <span class="keyword">var</span> createNewLife = <span class="type">CreateNewLife</span>()</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> life = <span class="type">CreateNewLife</span>()</span><br><span class="line"><span class="keyword">let</span> anAnimal = <span class="type">Animals</span>()</span><br><span class="line">anAnimal.kind = <span class="string">"Human"</span></span><br><span class="line"><span class="built_in">print</span>(anAnimal,life)</span><br><span class="line"><span class="keyword">if</span> life === anAnimal &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"same class"</span>)</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Different class"</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">print</span>(anAnimal.createNewLife.name)<span class="comment">//è¿™æ—¶CreateNewLifeå®ä¾‹æ‰ä¼šè¢«åˆ›å»º</span></span><br><span class="line">anAnimal.createNewLife.name = <span class="string">"liven"</span></span><br><span class="line"><span class="built_in">print</span>(anAnimal.kind,anAnimal.createNewLife.name)</span><br></pre></td></tr></table></figure><p></p>
<p></p><h3 id="3">3.ç»“æ„ä½“å’Œç±»ä¸­çš„å±æ€§å®šä¹‰-getterå’Œsetter</h3><br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> x = <span class="number">0.0</span>,y = <span class="number">0.0</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Size</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> width = <span class="number">0.0</span>,height = <span class="number">0.0</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Rect</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> origin = <span class="type">Point</span>()</span><br><span class="line">    <span class="keyword">var</span> size   = <span class="type">Size</span>()</span><br><span class="line">    <span class="keyword">var</span> center:<span class="type">Point</span>&#123;<span class="comment">//è®¡ç®—å±æ€§:å³å†™äº†getæˆ–setçš„å±æ€§ã€‚å¦‚æœåªæœ‰getï¼Œå°±æ˜¯åªè¯»å±æ€§</span></span><br><span class="line">        <span class="keyword">get</span>&#123;</span><br><span class="line">            <span class="keyword">let</span> centerX = origin.x + size.width/<span class="number">2</span></span><br><span class="line">            <span class="keyword">let</span> centerY = origin.y + size.height/<span class="number">2</span></span><br><span class="line">            <span class="keyword">return</span> <span class="type">Point</span>(x: centerX, y: centerY)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">set</span>(newCenter)&#123;</span><br><span class="line">            origin.x = newCenter.x - size.width/<span class="number">2</span></span><br><span class="line">            origin.y = newCenter.y - size.height/<span class="number">2</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> arcPoint:<span class="type">Point</span>&#123;<span class="comment">//å±æ€§è§‚å¯Ÿå™¨didSet,willSet</span></span><br><span class="line">        <span class="keyword">willSet</span>(newValue)&#123;<span class="comment">//ä¼šå°†æ–°çš„å€¼ä¼ å…¥</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"will set arcPoint <span class="subst">\(newValue)</span>"</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">didSet</span>(oldValue)&#123;<span class="comment">//ä¼šå°†æ—§çš„å€¼ä¼ å…¥</span></span><br><span class="line">            <span class="comment">//arcPoint = Point(x: 8, y: 9)</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"did set arcPoint <span class="subst">\(arcPoint)</span> <span class="subst">\(oldValue)</span>"</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> name = <span class="string">"my rect"</span><span class="comment">//Type propertyç±»å‹å±æ€§</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//å€¼ç±»å‹å±æ€§ä¸€èˆ¬ä¸èƒ½åœ¨å®ƒè‡ªå·±çš„å®ä¾‹æ–¹æ³•ä¸­ä¿®æ”¹ï¼›å¦‚æœéè¦ä¿®æ”¹ï¼Œéœ€è¦åŠ å…³é”®å­—mutating</span></span><br><span class="line">    <span class="keyword">mutating</span> <span class="func"><span class="keyword">func</span> <span class="title">bigger</span><span class="params">(x:Double,y:Double)</span></span> &#123;</span><br><span class="line">        size.width  += x</span><br><span class="line">        size.height += y</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">Rect</span>.name</span><br><span class="line"><span class="type">Rect</span>.name = <span class="string">"xxxx"</span></span><br><span class="line"><span class="type">Rect</span>.name</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> rect = <span class="type">Rect</span>(origin: <span class="type">Point</span>(x: <span class="number">10</span>,y: <span class="number">10</span>), size: <span class="type">Size</span>(width: <span class="number">20</span>,height: <span class="number">30</span>), arcPoint: <span class="type">Point</span>(x: <span class="number">1</span>, y: <span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(rect.arcPoint)</span><br><span class="line">rect.arcPoint = <span class="type">Point</span>(x: <span class="number">3</span>, y: <span class="number">4</span>)</span><br><span class="line"><span class="built_in">print</span>(rect.arcPoint)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> rect2 = rect</span><br><span class="line">rect2.arcPoint = <span class="type">Point</span>(x: <span class="number">6</span>, y: <span class="number">6</span>)</span><br><span class="line"><span class="built_in">print</span>(rect.arcPoint,rect2.arcPoint)</span><br><span class="line"></span><br><span class="line">rect.bigger(<span class="number">20</span>, y: <span class="number">20</span>)</span><br><span class="line"><span class="built_in">print</span>(rect.size)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SomeClass</span> </span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">var</span> <span class="title">overrideProperty</span>:<span class="title">Int</span></span>&#123;<span class="comment">//getçœç•¥äº†ã€‚classå…³é”®å­—è¡¨ç¤ºé‡å†™çˆ¶ç±»çš„getterå®ç°</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">10</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p>
<p></p><h3 id="4">4.æ–¹æ³•</h3><br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LevelTraker</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> highestUnlockedLevel = <span class="number">1</span></span><br><span class="line">    <span class="keyword">static</span> <span class="func"><span class="keyword">func</span> <span class="title">unlockLevel</span><span class="params">(level:Int)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (level == highestUnlockedLevel + <span class="number">1</span>) &#123;highestUnlockedLevel = level&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">static</span> <span class="func"><span class="keyword">func</span> <span class="title">levelIsUnlocked</span><span class="params">(level:Int)</span></span>-&gt;<span class="type">Bool</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> level &lt;= highestUnlockedLevel</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> currentLevel = <span class="number">1</span></span><br><span class="line">    <span class="keyword">mutating</span> <span class="func"><span class="keyword">func</span> <span class="title">advanceLevel</span><span class="params">(level:Int)</span></span>-&gt;<span class="type">Bool</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> <span class="type">LevelTraker</span>.levelIsUnlocked(level) &#123;</span><br><span class="line">            currentLevel = level</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Player</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> traker = <span class="type">LevelTraker</span>()</span><br><span class="line">    <span class="keyword">var</span> playerName:<span class="type">String</span></span><br><span class="line">    <span class="func"><span class="keyword">func</span> <span class="title">completeLevel</span><span class="params">(level:Int)</span></span> -&gt;<span class="type">Bool</span>&#123;</span><br><span class="line">        <span class="type">LevelTraker</span>.unlockLevel(level+<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> traker.advanceLevel(level+<span class="number">1</span>)&#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"Level <span class="subst">\(level)</span> hasn't been unlocked"</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">init</span>(name:<span class="type">String</span>)&#123;</span><br><span class="line">        playerName = name</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> level111 = <span class="type">LevelTraker</span>()</span><br><span class="line"><span class="keyword">var</span> level121 = <span class="type">LevelTraker</span>()</span><br><span class="line">level121.currentLevel = <span class="number">2</span></span><br><span class="line"><span class="built_in">print</span>(level111.currentLevel, level121.currentLevel)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> player = <span class="type">Player</span>(name:<span class="string">"han"</span>)</span><br><span class="line">player.traker.currentLevel</span><br><span class="line">player.completeLevel(<span class="number">1</span>)</span><br><span class="line">player.traker.currentLevel</span><br><span class="line"><span class="type">LevelTraker</span>.highestUnlockedLevel</span><br><span class="line">player.completeLevel(<span class="number">5</span>)</span><br></pre></td></tr></table></figure><p></p>
<p></p><h3 id="5">5.æ„é€ è¿‡ç¨‹</h3><br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cars</span></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> brand:<span class="type">String</span></span><br><span class="line">    <span class="keyword">var</span> usage:<span class="type">String</span></span><br><span class="line">    <span class="comment">//æ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="keyword">init</span>()&#123;</span><br><span class="line">        brand = <span class="string">"BMW"</span></span><br><span class="line">        usage = <span class="string">"Family"</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">init</span>(_brand:<span class="type">String</span>,_usage:<span class="type">String</span>)&#123;</span><br><span class="line">        brand = _brand</span><br><span class="line">        usage = _usage</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> audi = <span class="type">Cars</span>(_brand: <span class="string">"Audi"</span>, _usage: <span class="string">"Sports"</span>)</span><br><span class="line"><span class="built_in">print</span>(audi.brand,audi.usage)</span><br><span class="line"><span class="keyword">let</span> car2 = <span class="type">Cars</span>()</span><br><span class="line"><span class="built_in">print</span>(car2.brand,car2.usage)</span><br></pre></td></tr></table></figure><p></p>
<p></p><h3 id="6">6.å½“å±æ€§æœ‰é»˜è®¤å€¼ï¼Œä¸”æ²¡æœ‰æ„é€ æ–¹æ³•æ—¶ï¼Œç»“æ„ä½“å’Œç±»æ‹¥æœ‰é»˜è®¤æ„é€ æ–¹æ³•ã€‚ä½†æ˜¯ç»“æ„ä½“å¯ä»¥æœ‰å¸¦å±æ€§å‚æ•°çš„é»˜è®¤æ„é€ æ–¹æ³•ï¼ˆé€ä¸€æˆå‘˜æ„é€ å™¨ï¼‰ï¼Œè€Œç±»æ²¡æœ‰ã€‚</h3><br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">People</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> name:<span class="type">String</span>?</span><br><span class="line">    <span class="keyword">var</span> sex:<span class="type">String</span>?</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Books</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> type:<span class="type">String</span>?</span><br><span class="line">    <span class="keyword">var</span> category:<span class="type">String</span>?</span><br><span class="line">    <span class="keyword">var</span> available = <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> p = <span class="type">People</span>()</span><br><span class="line"><span class="keyword">let</span> semdsd = <span class="type">People</span>(name: <span class="string">"han"</span>, sex: <span class="string">"famale"</span>)</span><br><span class="line"><span class="keyword">let</span> book   = <span class="type">Books</span>()</span><br><span class="line"><span class="comment">//var book2  = Books(type:"epub",category:"Computer",available:true)</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h3 id="7">7.ææ„è¿‡ç¨‹</h3><br>/**<p></p>
<ul>
<li>ææ„å™¨åªé€‚ç”¨äºç±»ç±»å‹ï¼Œä¸èƒ½ç”¨äºç»“æ„ä½“ã€‚ææ„å™¨ç”¨deinitå…³é”®å­—ã€‚<br>*/<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Telephones</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> type:<span class="type">String</span>?</span><br><span class="line">    <span class="keyword">var</span> category:<span class="type">String</span>?</span><br><span class="line">    <span class="keyword">var</span> available = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>() &#123;</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">deinit</span>&#123;</span><br><span class="line">        <span class="comment">//ææ„ä»£ç ã€‚ã€‚ã€‚</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"<span class="subst">\(type)</span>"</span>)</span><br><span class="line">        available = <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>/<em><br> ææ„è¿‡ç¨‹ä¼šåœ¨ARCå›æ”¶å®ä¾‹æ—¶è¢«ç³»ç»Ÿè°ƒç”¨ï¼Œä¸éœ€è¦æ‰‹åŠ¨è°ƒç”¨ã€‚
 </em>/</p>
<p></p><h3 id="8">8.ç±»å®ä¾‹ä¹‹é—´çš„å¾ªç¯å¼ºå¼•ç”¨</h3><br>è§£å†³æ–¹å¼ï¼š<br>1.ä½¿ç”¨weakå…³é”®å­—ï¼Œå¼±å¼•ç”¨<br>2.ä½¿ç”¨unownedï¼Œæ— ä¸»å¼•ç”¨<p></p>
<p></p><h3 id="9">9.è§£å†³é—­åŒ…å¼•èµ·çš„å¾ªç¯å¼•ç”¨â€“å®šä¹‰æ•è·åˆ—è¡¨</h3><br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">SellProducts</span></span>&#123;</span><br><span class="line">    <span class="func"><span class="keyword">func</span> <span class="title">sellProducts</span><span class="params">(product:String)</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> name:<span class="type">String</span></span><br><span class="line">    <span class="keyword">weak</span> <span class="keyword">var</span> delegate:<span class="type">Seller</span>?</span><br><span class="line">    <span class="built_in">lazy</span> <span class="keyword">var</span> someClosure:(<span class="type">Int</span>,<span class="type">String</span>)-&gt;<span class="type">String</span> = &#123;</span><br><span class="line">        <span class="comment">//åœ¨é—­åŒ…ä¸­å°†selfä¿®é¥°ä¸ºæ— ä¸»å¼•ç”¨ã€‚å°†delegate ä¿®é¥°ä¸º å¼±å¼•ç”¨</span></span><br><span class="line">        [<span class="keyword">unowned</span> <span class="keyword">self</span>,<span class="keyword">weak</span> delegate = <span class="keyword">self</span>.delegate!]<span class="comment">//æ•è·åˆ—è¡¨</span></span><br><span class="line">        (index:<span class="type">Int</span>,strToProcess:<span class="type">String</span>)-&gt;<span class="type">String</span> <span class="keyword">in</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">"<span class="subst">\(<span class="keyword">self</span>.name)</span>,<span class="subst">\(<span class="keyword">self</span>.delegate)</span>,<span class="subst">\(delegate)</span>"</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">init</span>(name:<span class="type">String</span>,delegate:<span class="type">Seller</span>?)&#123;</span><br><span class="line">        <span class="keyword">self</span>.name = name;</span><br><span class="line">        <span class="keyword">self</span>.delegate = delegate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="func"><span class="keyword">func</span> <span class="title">giveSellerProducts</span><span class="params">(product:String )</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">self</span>.delegate?.sellProducts(product)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Seller</span> : <span class="title">SellProducts</span></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> product:<span class="type">String</span>?</span><br><span class="line">    <span class="func"><span class="keyword">func</span> <span class="title">sellProducts</span><span class="params">( product: String)</span></span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.product = product</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> seller = <span class="type">Seller</span>()</span><br><span class="line"><span class="keyword">var</span> person = <span class="type">Person</span> (name: <span class="string">"Hanliu"</span>, delegate: seller)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆšå¼€å§‹selleræ˜¯æ²¡æœ‰å•†å“çš„ï¼Œè¦ç­‰åˆ°Personç»™seller</span></span><br><span class="line"><span class="built_in">print</span>(seller.product)</span><br><span class="line"><span class="comment">//personå‘Šè¯‰sellerï¼Œå¸®æˆ‘å–è‹¹æœ</span></span><br><span class="line">person.giveSellerProducts(<span class="string">"apple"</span>)</span><br><span class="line"><span class="comment">//ç°åœ¨selleræ‰‹ä¸­å°±æœ‰äº†å•†å“äº†</span></span><br><span class="line"><span class="built_in">print</span>(seller.product!)</span><br><span class="line"></span><br><span class="line">person.someClosure(<span class="number">1</span>,<span class="string">"haha"</span>)</span><br></pre></td></tr></table></figure><p></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>ç±»ä¸ç»“æ„ä½“çš„å…±åŒç‚¹ï¼š</p>
<ul>
<li>å®šä¹‰å±æ€§ç”¨äºå­˜å‚¨å€¼</li>
<li>å®šä¹‰æ–¹æ³•ç”¨äºæä¾›åŠŸèƒ½</li>
<li>å®šä¹‰é™„å±è„šæœ¬ç”¨äºè®¿é—®å€¼</li>
<li>å®šä¹‰æ„é€ å™¨ç”¨äºç”Ÿæˆåˆå§‹åŒ–å€¼</li>
<li>é€šè¿‡æ‰©å±•ä»¥å¢åŠ é»˜è®¤å®ç°çš„åŠŸèƒ½</li>
<li>å®ç°åè®®ä»¥æä¾›æŸç§æ ‡å‡†åŠŸèƒ½</li>
</ul>
<p>ä¸ç»“æ„ä½“ç›¸æ¯”ï¼Œç±»è¿˜æœ‰å¦‚ä¸‹çš„é™„åŠ åŠŸèƒ½ï¼š</p>
<ul>
<li>ç»§æ‰¿å…è®¸ä¸€ä¸ªç±»ç»§æ‰¿å¦ä¸€ä¸ªç±»çš„ç‰¹å¾</li>
<li>ç±»å‹è½¬æ¢å…è®¸åœ¨è¿è¡Œæ—¶æ£€æŸ¥å’Œè§£é‡Šä¸€ä¸ªç±»å®ä¾‹çš„ç±»å‹</li>
<li>è§£æ„å™¨å…è®¸ä¸€ä¸ªç±»å®ä¾‹é‡Šæ”¾ä»»ä½•å…¶æ‰€è¢«åˆ†é…çš„èµ„æº</li>
<li>å¼•ç”¨è®¡æ•°å…è®¸å¯¹ä¸€ä¸ªç±»çš„å¤šæ¬¡å¼•ç”¨]]>
    
    </summary>
    
      <category term="LearnSwift" scheme="http://koalahl.github.io/tags/LearnSwift/"/>
    
      <category term="Swift" scheme="http://koalahl.github.io/categories/Swift/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Learn Swift - Section 2nd é›†åˆç±»å‹å’Œæšä¸¾]]></title>
    <link href="http://koalahl.github.io/2016/04/26/Learn-Swift-Section-Two/"/>
    <id>http://koalahl.github.io/2016/04/26/Learn-Swift-Section-Two/</id>
    <published>2016-04-26T08:21:53.000Z</published>
    <updated>2016-04-26T08:21:53.000Z</updated>
    <content type="html"><![CDATA[<p>Arraã€Dictionaryã€Setå’Œæšä¸¾</p>
<a id="more"></a>
<p>//Arrayçš„map()æ–¹æ³•<br>let digitNames = [<br>    0: â€œZeroâ€, 1: â€œOneâ€, 2: â€œTwoâ€,   3: â€œThreeâ€, 4: â€œFourâ€,<br>    5: â€œFiveâ€, 6: â€œSixâ€, 7: â€œSevenâ€, 8: â€œEightâ€, 9: â€œNineâ€<br>]<br>let numbers = [132,11,87,90,49,87,22,29,5,10,87]<br>//mapæ–¹æ³•ä¼šè¯»å–æ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ï¼Œ<br>let strings = numbers.map { (element) -&gt; String in<br>    var output = â€œâ€<br>    var number = element<br>    while number &gt; 0 {<br>        output = digitNames[number % 10]! + output<br>        number /= 10<br>    }<br>    return output<br>}<br>//æŠŠæ¯ä¸ªå…ƒç´ éƒ½+1<br>let so = numbers.map{(element)-&gt;Int in<br>    return element + 1<br>}<br>let lo = numbers.flatMap{(element)-&gt;Int in<br>    return element + 3</p>
<p>}<br>let split1 = numbers.split(70)<br>let split2 = numbers.split(87)<br>let split3 = numbers.split(87, maxSplit: 1, allowEmptySlices: true)<br>let split4 = numbers.split(87, maxSplit: 6, allowEmptySlices: true)<br>let split5 = numbers.split(87, maxSplit: 6, allowEmptySlices: false)</p>
<p>//è¿‡æ»¤å‡ºæ»¡è¶³æ¡ä»¶çš„å­åºåˆ—ã€‚æ¡ä»¶ç”±é—­åŒ…å®šä¹‰<br>numbers.filter { (element) -&gt; Bool in<br>    return element &gt; 50<br>}<br>numbers.filter{(element) in element &gt; 50}<br>numbers.filter{ $0 &gt; 50}</p>
<p>let scores = [â€œxiaomingâ€:66,â€liâ€:89,â€hanâ€:78,â€mingâ€:100,â€xiagâ€:34]<br>scores.filter { (name,score) in score &gt; 60}</p>
<p>//â€œå°†é—­åŒ…æ ‡æ³¨ä¸º@noescapeä½¿ä½ èƒ½åœ¨é—­åŒ…ä¸­éšå¼åœ°å¼•ç”¨selfâ€<br>func functionWithNoescapeClosure(@noescape closure:()-&gt;Void){<br>    closure()<br>}<br>var completionHandlers:[() -&gt; Void] = []<br>func functionWithEscapeClosure(completionHandler:()-&gt;Void){<br>    completionHandler()<br>    completionHandlers.append(completionHandler)<br>}</p>
<p>class SomeClass {<br>    var x = 200<br>    func doSomething(){</p>
<pre><code>    functionWithEscapeClosure({self.x = <span class="number">100</span>})

    functionWithNoescapeClosure({x = <span class="number">300</span>})<span class="comment">//éšå¼å¼•ç”¨self</span>

}
</code></pre><p>}<br>let some = SomeClass()<br>some.doSomething()<br>print(some.x)</p>
<p>completionHandlers.first?()<br>print(some.x)</p>
<p>//è‡ªåŠ¨é—­åŒ… ä½¿ç”¨@autoclosureï¼Œå°±å¯ä»¥ä¸ç”¨åŠ é—­åŒ…çš„{}<br>var names = [â€œcharisâ€,â€levisâ€,â€luosâ€,â€dericâ€,â€htomeâ€]<br>let customerProvider = {names.removeAtIndex(0)}//æ³¨æ„ç±»å‹æ˜¯()-&gt;String<br>func customName(@autoclosure customerProvider:()-&gt;String)  {<br>    print(â€œcostomerâ€™s name is (customerProvider())â€)<br>}</p>
<p>customName(names.removeAtIndex(0))//é—­åŒ…ä½“ä¸éœ€è¦åŠ {}ï¼Œå°±å¥½åƒæ˜¯å‚æ•°ä¸€æ ·ã€‚</p>
<p>//æšä¸¾-ä¸€ç­‰å…¬æ°‘ ä¸ç±»classä¸€æ ·<br>enum Compose{<br>    case North<br>    case South<br>    case West<br>    case East<br>}<br>//æˆå‘˜å€¼çš„ç±»å‹ä¸ºæšä¸¾çš„åå­—Compose<br>let directionToHead = Compose.East</p>
<p>//å¸¦æœ‰å…³è”å€¼çš„æšä¸¾<br>enum Barcode {<br>    case UPCA(Int,Int,Int)//å…³è”äº†Intç±»å‹çš„å€¼<br>    case QRCode(String)//å…³è”äº†Stringç±»å‹çš„å€¼<br>}</p>
<p>var productorCode = Barcode.QRCode(â€œkasdjfiwoeklfâ€)</p>
<p>productorCode = .UPCA(2,5,1)</p>
<p>switch productorCode{<br>    case let .UPCA(first,second,third):<br>        print(â€œ(first) (second) (third)â€)<br>    case var .QRCode(code):<br>        print(â€œcode is (code)â€)<br>}</p>
<p>//åŸå§‹å€¼ Raw Values<br>enum ASCII:Character{//å¸¦æœ‰åˆå§‹ç±»å‹çš„æšä¸¾<br>    case Tab = â€œ\tâ€<br>    case Return = â€œ\râ€<br>    case changeLine = â€œ\nâ€<br>}</p>
<p>//å…³è”å€¼å¯ä»¥ä½¿æšä¸¾çš„åµŒå¥—æˆä¸ºå¯èƒ½.å¦‚æœåµŒå¥—ï¼Œåˆ™éœ€è¦æ·»åŠ indirectå…³é”®å­—<br>enum Add{<br>    case Number(Int)<br>    indirect case Addition(Add,Add)<br>}<br>func evaluate(add:Add) -&gt; Int {<br>    switch add {<br>    case .Number(let i):<br>        return i<br>    case .Addition(let left, let right):<br>        return evaluate(left) + evaluate(right)<br>    }<br>}</p>
<p>let a = Add.Number(10)<br>let b = Add.Number(2)<br>let c = Add.Addition(a,b)</p>
<p>evaluate(a)<br>evaluate(c)</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>Arraã€Dictionaryã€Setå’Œæšä¸¾</p>]]>
    
    </summary>
    
      <category term="LearnSwift" scheme="http://koalahl.github.io/tags/LearnSwift/"/>
    
      <category term="Swift" scheme="http://koalahl.github.io/categories/Swift/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Learn Swift - Section 1st åŸºç¡€çŸ¥è¯†]]></title>
    <link href="http://koalahl.github.io/2016/04/26/Learn-Swift-Section-One/"/>
    <id>http://koalahl.github.io/2016/04/26/Learn-Swift-Section-One/</id>
    <published>2016-04-26T08:21:36.000Z</published>
    <updated>2016-04-26T08:21:36.000Z</updated>
    <content type="html"><![CDATA[<p>import UIKit</p>
<p>var str = â€œHello, playgroundâ€</p>
<p>//å¸¸é‡å’Œå˜é‡<br>let maxLoginCount = 10<br>var currentLoginCount = 5</p>
<p>//ç±»å‹æ ‡æ³¨<br>var message = â€œwelcomeâ€//ç±»å‹æ¨æ–­ä¸ºString<br>var messageWithTypeAnnotation:String</p>
<a id="more"></a>
<p>message = â€œwelcome hereâ€<br>messageWithTypeAnnotation = â€œwelcome goâ€</p>
<p>print(â€œBig world (message)â€)//(message) å­—ç¬¦ä¸²è½¬ä¹‰<br>print(â€œBig worldâ€, message)//</p>
<p>let newString = â€œBig world â€œ  + â€œ(message) â€œ + message<br>print(newString)<br>//å¤šè¡Œè¯­å¥ç”¨åˆ†å·<br>let cat = â€œğŸ±â€; print(cat)</p>
<p>let a:Int32 = 10<br>let uintb:UInt8 = 255</p>
<p>//ç±»å‹åˆ«å<br>typealias SLInt = UInt64<br>let i:SLInt<br>var maxInt64 = SLInt.max</p>
<p>//å…ƒç»„<br>let HttpErrorCode  = (404,â€NotFoundâ€)<br>print(HttpErrorCode)</p>
<p>typealias HttpStateCode = (Int32,String)<br>var errorMsg = HttpErrorCode<br>var normal: HttpStateCode = (200,â€OKâ€)<br>print(normal)</p>
<p>let (stateCode,stateMsg) = HttpErrorCode<br>print(â€œHTTP code is (stateCode)â€)<br>//é€šè¿‡ä¸‹æ ‡è®¿é—®å…ƒç»„å…ƒç´ <br>print(HttpErrorCode.1)</p>
<p>//éšå¼è§£æå¯é€‰ç±»å‹</p>
<p>let possibleString:String? = â€œan optional stringâ€<br>let forcedString:String = possibleString!</p>
<p>let possibleString2:String! = â€œan implicitly optional stirngâ€<br>let forcedString2:String = possibleString2</p>
<p>//å¯é€‰ç»‘å®š<br>if let bingStr = possibleString2{<br>    print(bingStr)<br>}</p>
<p>//é”™è¯¯å¤„ç†</p>
<p>func canThrowAnError() throws{</p>
<p>}</p>
<p>func makeASanwich() -&gt; Bool {<br>    return false<br>}<br>func buyNewDishes() -&gt; Void {</p>
<p>}</p>
<p>do{<br>    try canThrowAnError()<br>    makeASanwich()<br>}catch Error.MissingNeededMetarail{<br>    buyNewDishes()<br>}</p>
<p>//æ–­è¨€<br>let num = 4<br>assert(num&gt;0, â€œaå¤§äº0â€)</p>
<p>//ç©ºåˆè¿ç®—ç¬¦ ??<br>let defaultColor:String = â€œredâ€<br>var userDefinedColor:String?</p>
<p>//userDefinedColor = â€œorangeâ€<br>var currentColorToUse = userDefinedColor ?? defaultColor<br>//ç­‰ä»·äº<br>var currentColorToUse2 = userDefinedColor != nil ? userDefinedColor! : defaultColor</p>
<p>//åŒºé—´è¿ç®—ç¬¦<br>//1.é—­åŒºé—´ (aâ€¦b) åŒ…å«aå’Œb<br>for index in (1â€¦5){<br>    print(index)<br>    print(â€œ(index) <em> 5 = (index </em> 5)â€)<br>}<br>//2.åŠå¼€åŒºé—´ (a..&lt;b)<br>for index in (1..&lt;5){<br>    print(index)<br>    print(â€œ(index) <em> 5 = (index </em> 5)â€)<br>}</p>
<p>//å­—ç¬¦ä¸² String<br>//Stringæ˜¯å€¼ç±»å‹<br>for charactor in â€œYou R AğŸ¶â€.characters{<br>    print(charactor)<br>}<br>//ç‹¬ç«‹çš„å­—ç¬¦å¸¸é‡æˆ–å˜é‡<br>let singleCharactor:Character = â€œ!â€</p>
<p>//é€šè¿‡å€¼ç±»å‹ä¸ºcharacterçš„æ•°ç»„æ¥åˆ›å»ºå­—ç¬¦ä¸²<br>let characters:[Character] = [â€œcâ€,â€aâ€,â€tâ€,â€ğŸ±â€]<br>let catString = String(characters)<br>print(catString)</p>
<p>//æ’å€¼è¿ç®—  åæ–œæ \<br>let multiplier = 4<br>print(â€œ(multiplier) times 5.12 =  (Double(multiplier) * 5.12)â€)<br>print(â€œ\r messageâ€+â€ \u{E9}â€)</p>
<p>//Unicode<br>let ccc1:Character = â€œ\u{65}â€<br>let ccc2:Character = â€œ\u{65}\u{301}â€</p>
<p>print(message)<br>message.startIndex<br>message.endIndex<br>//å‰ä¸€ä¸ªindex<br>message.endIndex.predecessor()<br>//åä¸€ä¸ªindex<br>message.startIndex.successor()<br>//ä»starIndexå¼€å§‹ åé¢çš„ç¬¬iä¸ªindex<br>let xx = message.startIndex.advancedBy(4)<br>message.removeAtIndex(message.startIndex.advancedBy(4))<br>print(message)<br>//indices è·å–å­—ç¬¦ä¸²çš„å…¨éƒ¨ç´¢å¼• ã€‚ç©ºæ ¼ä¸ç®—ã€‚ã€‚ã€‚<br>for index in message.characters.indices{<br>    print(â€œ(message[index])â€)<br>}</p>
<p>message.insert(â€œuâ€, atIndex: xx)</p>
<p>message = â€œhttp:â€+message<br>print(message)<br>//å‰åç¼€<br>var hasPrefix = message.hasPrefix(â€œhttpâ€)<br>var hasSuffix = message.hasSuffix(â€œpngâ€)</p>
<p>//é›†åˆç±»å‹ï¼šæ•°ç»„Array é›†åˆSet å­—å…¸Dictionary</p>
<p>//ä¸å¯å˜å’Œå¯å˜<br>/<em>â€œå¦‚æœåˆ›å»ºä¸€ä¸ªArraysã€Setsæˆ–Dictionarieså¹¶ä¸”æŠŠå®ƒåˆ†é…æˆä¸€ä¸ªå˜é‡ï¼Œè¿™ä¸ªé›†åˆå°†ä¼šæ˜¯å¯å˜çš„ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥åœ¨åˆ›å»ºä¹‹åæ·»åŠ æ›´å¤šæˆ–ç§»é™¤å·²å­˜åœ¨çš„æ•°æ®é¡¹æ¥æ”¹å˜è¿™ä¸ªé›†åˆçš„å¤§å°ã€‚å¦‚æœæˆ‘ä»¬æŠŠArraysã€Setsæˆ–Dictionariesåˆ†é…æˆå¸¸é‡ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯ä¸å¯å˜çš„ï¼Œå®ƒçš„å¤§å°ä¸èƒ½è¢«æ”¹å˜ã€‚â€
 </em>/<br>let immutableArray = <a href="count:1,repeatedValue:0" target="_blank" rel="external">Int</a><br>var mutableArray   = <a href="">Int</a></p>
<p>let strArray    = [â€œworldâ€]</p>
<p>mutableArray.append(1)<br>var array1:[String] = Array()<br>array1.append(â€œhelloâ€)<br>array1.appendContentsOf(strArray)<br>array1.insert(â€œgogogogâ€, atIndex: 1)<br>array1.count<br>array1.isEmpty</p>
<p>array1[0â€¦1] = [â€œappleâ€,â€pearâ€];<br>array1<br>//æ•°ç»„çš„éå†<br>for item in array1{<br>    print(item)<br>}</p>
<p>for (index,item) in array1.enumerate(){<br>    print(item,array1[index])<br>}</p>
<p>//é›†åˆ<br>var asset = Set<string>()<br>asset.count<br>asset.insert(â€œhash stringâ€)<br>asset.remove(â€œhashâ€)<br>//setç±»å‹å¿…é¡»æ˜¾å¼å£°æ˜,å…·ä½“å…ƒç´ ç±»å‹å¯ä»¥çœç•¥<br>let asset2:Set<character> = [â€œaâ€]<br>let asset3:Set = [â€œaâ€,â€vâ€]<br>asset2.hashValue == asset3.hashValue<br>asset.hashValue == asset2.hashValue</character></string></p>
<p>let asset4 = Set.init(arrayLiteral: â€œaâ€,â€bâ€,â€câ€)<br>let asset5 = Set.init(array1)<br>//é›†åˆæ“ä½œï¼šäº¤é›†ã€å¤–é›†ã€åˆé›†,å‡é›†</p>
<p>asset3.intersect(asset4)<br>asset3.exclusiveOr(asset4)<br>asset3.union(asset4)<br>asset3.subtract(asset4)</p>
<p>asset3 == asset4<br>asset3.isSubsetOf(asset4)<br>asset3.isSupersetOf(asset3)<br>asset3.isStrictSupersetOf(asset3)//æ˜¯å¦æ˜¯è¶…é›†ï¼Œå¹¶ä¸”ä¸æ˜¯åŒä¸€é›†åˆ<br>asset3.isStrictSubsetOf(asset3)//æ˜¯å¦æ˜¯å­é›†ï¼Œå¹¶ä¸”ä¸æ˜¯åŒä¸€é›†åˆ</p>
<p>asset3.isDisjointWith(asset4)//åˆ¤æ–­é›†åˆæ˜¯å¦ä¸å«æœ‰ç›¸åŒçš„å€¼ã€‚falseè¯´æ˜åŒ…å«ç›¸åŒçš„å€¼</p>
<p>//å­—å…¸ Dictionary<key,value><br>var dic1 = Dictionary<int,string>()<br>var dic2 = <a href="">Int:String</a><br>dic1.updateValue(â€œvalueâ€, forKey: 0)//updateValueæ–¹æ³•è¿”å›å€¼æ˜¯è¯¥keyçš„æ—§å€¼<br>dic1.updateValue(â€œnewValueâ€, forKey: 0)<br>print(dic1)<br>dic1[1] = â€œahaoâ€<br>dic1[2] = â€œddddâ€<br>print(dic1)</int,string></key,value></p>
<p>for (key,value) in dic1{<br>    print(key ,value)<br>}</p>
<p>print(dic1.keys.sort())<br>print(dic1.values.sort())</p>
<p>//æ§åˆ¶æµç¨‹</p>
<p>//game<br>let finalSqura = 25<br>var board = <a href="count:finalSqura+1,repeatedValue:0" target="_blank" rel="external">Int</a><br>board[03] = +08; board[06] = +11; board[09] = +09; board[10] = +02<br>board[14] = -10; board[19] = -11; board[22] = -02; board[24] = -08<br>var square = 0<br>var diceRoll = 0</p>
<p>gameLoop:while square != finalSqura{<br>    //if ++diceRoll == 7 { diceRoll = 1 }<br>    switch square + diceRoll {<br>    case finalSqura:<br>        break gameLoop<br>    case let newSquare where newSquare &gt; finalSqura:<br>        coutinue gameLoop<br>    default:<br>        square += diceRoll<br>        square += board[square]<br>    }<br>}<br>print(â€œgame overâ€)</p>
<p>//æ£€æŸ¥APIå¯ç”¨æ€§<br>if #available(iOS 9, *){</p>
<p>}else{</p>
<p>}<br>func checkOSVersion() -&gt; NSString {<br>    //å¿…é¡»åœ¨å‡½æ•°ä½“å†…ä½¿ç”¨ï¼›å¿…é¡»è·Ÿç€elseï¼›å¿…é¡»èƒ½è·³å‡ºelse<br>    guard #available(OSX 10.11, *) else {<br>        return â€œ10.10â€<br>    }<br>    return â€œ10.11â€<br>}</p>
<p>checkOSVersion()</p>
<p>//å‡½æ•°åµŒå¥—<br>func stepForword(input:Int)-&gt;Int{<br>    return input - 1<br>}<br>func stepBackword(input:Int)-&gt;Int{<br>    return input + 1<br>}<br>func chooseStep(value:Int) -&gt; (Int)-&gt;Int {<br>    return value &gt; 0 ? stepForword : stepBackword<br>}<br>func xxxx(tempFunction:(Int)-&gt;Int) -&gt;Int {<br>    return 1<br>}<br>//å¦‚æœæˆ‘å†åŠ ä¸€ä¸ªå‡½æ•°åµŒå¥—<br>func nextStep(tempFunction:((Int)-&gt;Int)-&gt;Int) -&gt; Int{<br>    return 0<br>}<br>let number = 3<br>let myFunction = chooseStep(number)<br>myFunction(number)</p>
<p>let names = [â€œChrisâ€, â€œAlexâ€, â€œEwaâ€, â€œBarryâ€, â€œDaniellaâ€]<br>func absendOrdesend(s1:String,s2:String) -&gt; Bool {<br>    return s1&gt;s2<br>}<br>//ä½¿ç”¨å‡½æ•°çš„è¿”å›å€¼ä½œä¸ºå‚æ•°<br>names.sort()<br>names.sort(absendOrdesend)<br>//é—­åŒ…è¡¨è¾¾å¼</p>
<p>{(parameter:Type)-&gt;ReturnType in</p>
<p>}<br>Objective-Cä¸­çš„block<br>ReturnType ^(parameter){ return }</p>
<p>//ä½¿ç”¨é—­åŒ…çš„è¿”å›å€¼ä½œä¸ºå‚æ•°<br>names.sort({(s1:String,s2:String) -&gt; Bool in<br>        return s1 &gt; s2<br>})</p>
<p>//å› ä¸ºnamesæ•°ç»„å‚æ•°ç±»å‹ç¡®å®šï¼Œæ‰€ä»¥æ ¹æ®ç±»å‹æ¨æ–­,çœç•¥å‚æ•°ç±»å‹å’Œè¿”å›å€¼ç±»å‹<br>names.sort({s1,s2 in return s1&gt;s2})<br>names.sort({s1,s2 in s1&gt;s2})<br>names.sort({$0&gt;$1})<br>names.sort(&gt;)//æ ¹æ®Stringå¯¹&gt;è¿™ä¸ªç¬¦å·çš„å®šä¹‰æ¨æ–­</p>
<p>//å°¾éšé—­åŒ…<br>//å…ˆå®šä¹‰ä¸€ä¸ªclosure<br>let bigger = {(a:Int,b:Int)-&gt;Bool in<br>    return a&gt;b<br>}<br>//å£°æ˜ä¸€ä¸ªå‡½æ•°ï¼Œå‚æ•°æ˜¯ä¸€ä¸ªé—­åŒ…<br>func exchangeNumerWithClosure(bigger:(Int,Int)-&gt;Bool){<br>    if bigger(2,3) {<br>        print(â€œbiggerâ€)<br>    }else{<br>        print(â€œlowerâ€)<br>    }<br>}<br>//å‡½æ•°è°ƒç”¨æ—¶<br>//æ²¡æœ‰ä½¿ç”¨å°¾éšé—­åŒ…<br>//exchangeNumerWithClosure({(a:Int,b:Int)-&gt;Bool in<br>//    return a&gt;b<br>//})</p>
<p>//ä½¿ç”¨å°¾éšé—­åŒ…<br>//exchangeNumerWithClosure(){(a:Int,b:Int)-&gt;Bool in return a&gt;b }<br>exchangeNumerWithClosure(){(a:Int,b:Int) -&gt;Bool in a&gt;b}<br>//åŒç†ï¼Œå°¾éšé—­åŒ…<br>names.sort(){$0&gt;$1}<br>names.sort{$0&gt;$1}//å¦‚æœå‡½æ•°åªéœ€è¦é—­åŒ…è¡¨è¾¾å¼ä¸€ä¸ªå‚æ•°ï¼Œå½“æ‚¨ä½¿ç”¨å°¾éšé—­åŒ…æ—¶,å¯ä»¥çœç•¥()</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>import UIKit</p>
<p>var str = â€œHello, playgroundâ€</p>
<p>//å¸¸é‡å’Œå˜é‡<br>let maxLoginCount = 10<br>var currentLoginCount = 5</p>
<p>//ç±»å‹æ ‡æ³¨<br>var message = â€œwelcomeâ€//ç±»å‹æ¨æ–­ä¸ºString<br>var messageWithTypeAnnotation:String</p>]]>
    
    </summary>
    
      <category term="LearnSwift" scheme="http://koalahl.github.io/tags/LearnSwift/"/>
    
      <category term="Swift" scheme="http://koalahl.github.io/categories/Swift/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[æµ…è°ˆiOSä¸­çš„userAgent]]></title>
    <link href="http://koalahl.github.io/2016/04/10/%E6%B5%85%E8%B0%88iOS%E4%B8%AD%E7%9A%84userAgent/"/>
    <id>http://koalahl.github.io/2016/04/10/æµ…è°ˆiOSä¸­çš„userAgent/</id>
    <published>2016-04-10T14:33:37.000Z</published>
    <updated>2016-04-10T14:33:37.000Z</updated>
    <content type="html"><![CDATA[<p>User-Agentï¼ˆç”¨æˆ·ä»£ç†ï¼‰å­—ç¬¦ä¸²æ˜¯Webæµè§ˆå™¨ç”¨äºå£°æ˜è‡ªèº«å‹å·ç‰ˆæœ¬å¹¶éšHTTPè¯·æ±‚å‘é€ç»™WebæœåŠ¡å™¨çš„å­—ç¬¦ä¸²ï¼Œåœ¨WebæœåŠ¡å™¨ä¸Šå¯ä»¥è·å–åˆ°è¯¥å­—ç¬¦ä¸²ã€‚</p>
<p>åœ¨å…¬å¸äº§å“ä¸­ï¼Œåœ¨userAgentä¸­å¢åŠ äº†NetTypeå­—æ®µï¼Œç”¨äºæ ‡è¯†å®¢æˆ·ç«¯å½“å‰çš„ç½‘ç»œç¯å¢ƒã€‚</p>
<ul>
<li>NetType/WIFI</li>
<li>NetType/3G<br>webæœåŠ¡å™¨ç«¯æ ¹æ®NetTypeç±»å‹åŠ è½½ä¸åŒåˆ†è¾¨ç‡çš„å•†å“å›¾ç‰‡ã€‚æˆ‘ä»¬åªæœ‰ä¸¤ç§ï¼ŒWIFIä¸‹é«˜æ¸…å›¾ï¼ŒéWIFIä½åˆ†è¾¨ç‡å›¾ã€‚</li>
</ul>
<a id="more"></a>
<h3 id="1">è·å–WebViewçš„userAgent</h3><br>iOSå®¢æˆ·ç«¯ä¸­è·å–webViewçš„userAgentçš„æ–¹æ³•ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSMutableString</span> *userAgent = [<span class="built_in">NSMutableString</span> stringWithString:[[<span class="built_in">UIWebView</span> new] stringByEvaluatingJavaScriptFromString:<span class="string">@"navigator.userAgent"</span>]];</span><br></pre></td></tr></table></figure><br><br>æ ¹æ®éœ€è¦æ·»åŠ ä¸åŒçš„æ ‡è¯†åˆ°æ–°çš„userAgentä¸­,è¿™é‡Œæ·»åŠ ä¸€ä¸ªWMallæ ‡è¯†ã€‚<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSString</span> *newUagent = [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"%@ WMall/%@"</span>, userAgent, [SystemInfo appShortVersion]];</span><br><span class="line"><span class="built_in">NSDictionary</span> *dictionnary = [[<span class="built_in">NSDictionary</span> alloc] initWithObjectsAndKeys:newUagent, <span class="string">@"UserAgent"</span>, <span class="literal">nil</span>];</span><br><span class="line">[[<span class="built_in">NSUserDefaults</span> standardUserDefaults] registerDefaults:dictionnary];</span><br></pre></td></tr></table></figure><br><br>newUagent ä¸º<code>Mozilla/5.0 (iPhone; CPU iPhone OS 9_3 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13E230 WMall/3.0</code><br><br><h3 id="2">æ ¹æ®ç½‘ç»œç±»å‹è®¾ç½®ä¸åŒçš„NetTypeæ ‡è¯†</h3>

<p>iOSä¸­åˆ¤æ–­ç½‘ç»œçŠ¶æ€ä¸€èˆ¬ç”¨AFNetWorkingä¸­çš„æ–¹æ³•ï¼š<br>åœ¨appDelegateçš„<code>application didFinishLaunchingWithOptions</code>æ–¹æ³•ä¸­å¯åŠ¨ç½‘ç»œçŠ¶æ€ç›‘å¬ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[[AFNetworkReachabilityManager sharedManager] startMonitoring];</span><br><span class="line">[[AFNetworkActivityIndicatorManager sharedManager] setEnabled:<span class="literal">YES</span>];</span><br></pre></td></tr></table></figure></p>
<p>ç„¶ååœ¨åŸºç±»BaseViewControllerä¸­ç›‘å¬ç½‘ç»œæ›´æ–°é€šçŸ¥<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[[<span class="built_in">NSNotificationCenter</span> defaultCenter] addObserver:<span class="keyword">self</span> selector:<span class="keyword">@selector</span>(networkReachabilityStatusDidChange:) name:AFNetworkingReachabilityDidChangeNotification object:<span class="literal">nil</span>];</span><br></pre></td></tr></table></figure></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)networkReachabilityStatusDidChange:(<span class="built_in">NSNotification</span> *)notify&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"ç½‘ç»œå˜åŒ–é€šçŸ¥ï¼š%@"</span>,notify<span class="variable">.userInfo</span>[AFNetworkingReachabilityNotificationStatusItem]);</span><br><span class="line">    AFNetworkReachabilityStatus status = [notify<span class="variable">.userInfo</span>[AFNetworkingReachabilityNotificationStatusItem] integerValue];</span><br><span class="line">    <span class="built_in">NSString</span> *net = <span class="literal">nil</span>;</span><br><span class="line">    <span class="keyword">switch</span> (status) &#123;</span><br><span class="line">        <span class="keyword">case</span> AFNetworkReachabilityStatusNotReachable:</span><br><span class="line">            net = <span class="string">@"æ— ç½‘ç»œ"</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> AFNetworkReachabilityStatusReachableViaWiFi:</span><br><span class="line">            net = <span class="string">@"WIFI"</span>;</span><br><span class="line">            [<span class="keyword">self</span> changeUserAgentWithType:<span class="string">@"WIFI"</span>];</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> AFNetworkReachabilityStatusReachableViaWWAN:</span><br><span class="line">            net = <span class="string">@"2G/3G/4G"</span>;</span><br><span class="line">            [<span class="keyword">self</span> changeUserAgentWithType:<span class="string">@"3G"</span>];</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            net = <span class="string">@"xxx"</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    [Error showError:[<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"å½“å‰ç½‘ç»œçŠ¶æ€%@"</span>,net]];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„å…ˆåˆ¤æ–­userAgentä¸­æ˜¯å¦å­˜åœ¨NetType<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ›´æ–°NetType</span></span><br><span class="line">- (<span class="keyword">void</span>)changeUserAgentWithType:(<span class="built_in">NSString</span> *)type&#123;</span><br><span class="line">    <span class="built_in">NSMutableString</span> *userAgent = [<span class="built_in">NSMutableString</span> stringWithString:[[<span class="built_in">UIWebView</span> new] stringByEvaluatingJavaScriptFromString:<span class="string">@"navigator.userAgent"</span>]];</span><br><span class="line">    <span class="built_in">NSString</span> *newUagent = <span class="literal">nil</span>;</span><br><span class="line">    <span class="built_in">NSString</span> *temp = <span class="literal">nil</span>;</span><br><span class="line">    <span class="keyword">if</span> ([userAgent containsString:<span class="string">@"NetType"</span>]) &#123;</span><br><span class="line">        <span class="keyword">if</span> ([userAgent containsString:<span class="string">@"WIFI"</span>]) &#123;</span><br><span class="line">            temp = <span class="string">@"WIFI"</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>([userAgent containsString:<span class="string">@"3G"</span>])&#123;</span><br><span class="line">            temp = <span class="string">@"3G"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        newUagent = [userAgent stringByReplacingOccurrencesOfString:temp withString:type];</span><br><span class="line"></span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        newUagent = [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"%@ NetType/%@"</span>, userAgent, type];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">NSDictionary</span> *dictionnary = [[<span class="built_in">NSDictionary</span> alloc] initWithObjectsAndKeys:newUagent, <span class="string">@"UserAgent"</span>, <span class="literal">nil</span>];</span><br><span class="line"></span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"new useragent:%@"</span>,newUagent);</span><br><span class="line">    [[<span class="built_in">NSUserDefaults</span> standardUserDefaults] registerDefaults:dictionnary];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>newUagent ä¸º<code>Mozilla/5.0 (iPhone; CPU iPhone OS 9_3 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13E230 WMall/3.0  NetType/WIFI</code></p>
<p>å‚è€ƒ<br><a href="http://blog.csdn.net/lilin_emcc/article/details/40145113" target="_blank" rel="external">å¾®ä¿¡6.0å†…åµŒæµè§ˆå™¨User-Agentå­—ç¬¦ä¸²å¢åŠ äº†NetTypeå­—æ®µ</a><br><a href="http://blog.csdn.net/mangosnow/article/details/38798195" target="_blank" rel="external">è·å– UIWebview çš„ Useragentï¼Œä»¥åŠé™„åŠ è‡ªå®šä¹‰å­—æ®µåˆ° Useragent</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>User-Agentï¼ˆç”¨æˆ·ä»£ç†ï¼‰å­—ç¬¦ä¸²æ˜¯Webæµè§ˆå™¨ç”¨äºå£°æ˜è‡ªèº«å‹å·ç‰ˆæœ¬å¹¶éšHTTPè¯·æ±‚å‘é€ç»™WebæœåŠ¡å™¨çš„å­—ç¬¦ä¸²ï¼Œåœ¨WebæœåŠ¡å™¨ä¸Šå¯ä»¥è·å–åˆ°è¯¥å­—ç¬¦ä¸²ã€‚</p>
<p>åœ¨å…¬å¸äº§å“ä¸­ï¼Œåœ¨userAgentä¸­å¢åŠ äº†NetTypeå­—æ®µï¼Œç”¨äºæ ‡è¯†å®¢æˆ·ç«¯å½“å‰çš„ç½‘ç»œç¯å¢ƒã€‚</p>
<ul>
<li>NetType/WIFI</li>
<li>NetType/3G<br>webæœåŠ¡å™¨ç«¯æ ¹æ®NetTypeç±»å‹åŠ è½½ä¸åŒåˆ†è¾¨ç‡çš„å•†å“å›¾ç‰‡ã€‚æˆ‘ä»¬åªæœ‰ä¸¤ç§ï¼ŒWIFIä¸‹é«˜æ¸…å›¾ï¼ŒéWIFIä½åˆ†è¾¨ç‡å›¾ã€‚</li>
</ul>]]>
    
    </summary>
    
      <category term="userAgent" scheme="http://koalahl.github.io/tags/userAgent/"/>
    
      <category term="iOS" scheme="http://koalahl.github.io/categories/iOS/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[UIButtonè®¾ç½®æ–‡å­—å›¾ç‰‡å±…ä¸­ã€UIViewç›¸å…³æ–¹æ³•ä»¥åŠUIåˆ‡å›¾çš„é‡è¦æ€§]]></title>
    <link href="http://koalahl.github.io/2016/03/31/UIButton%E8%AE%BE%E7%BD%AE%E6%96%87%E5%AD%97%E5%9B%BE%E7%89%87%E5%B1%85%E4%B8%AD-%E8%AE%BAUI%E5%88%87%E5%9B%BE%E7%9A%84%E9%87%8D%E8%A6%81%E6%80%A7/"/>
    <id>http://koalahl.github.io/2016/03/31/UIButtonè®¾ç½®æ–‡å­—å›¾ç‰‡å±…ä¸­-è®ºUIåˆ‡å›¾çš„é‡è¦æ€§/</id>
    <published>2016-03-31T06:13:54.000Z</published>
    <updated>2016-03-31T06:13:54.000Z</updated>
    <content type="html"><![CDATA[<p>åˆæ˜¯ä¸€ä¸ªè€ç”Ÿå¸¸è°ˆçš„é—®é¢˜ï¼Œo(â•¯â–¡â•°)oã€‚UIButtonä½œä¸ºæœ€æœ€å¸¸ç”¨çš„æ§ä»¶ï¼Œæƒ³å¿…éƒ½æ˜¯å¾ˆç†Ÿæ‚‰çš„ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºçš„æ§ä»¶ä¸­</p>
<p><img src="/img/ordersButton.png" alt="Order Buttons"></p>
<p>å¦‚æ­¤è®¾è®¡åœ¨å¾ˆå¤šç”µå•†å®¢æˆ·ç«¯ä¸­éƒ½æœ‰æ¶‰åŠï¼Œä¹Ÿæ²¡æœ‰ä»€ä¹ˆéš¾åº¦ã€‚</p>
<p>ä½†æ˜¯æˆ‘é‡åˆ°çš„é—®é¢˜å°±æ˜¯ä»»å‡­å¦‚ä½•è®¾ç½®è¾¹è·ï¼Œå°±æ˜¯å¯¹ä¸é½ï¼Œå…¶ä¸­è¿˜è¦è€ƒè™‘å±å¹•é€‚é…çš„é—®é¢˜ã€‚Orzâ€¦æœ€åå»å·¥ç¨‹é‡ŒæŸ¥çœ‹ç›¸åº”çš„å›¾ç‰‡å¤§å°ï¼Œæ‰å‘ç°æ¯ä¸ªå›¾ç‰‡çš„å°ºå¯¸å®½é«˜éƒ½ä¸åŒï¼Œå¾ˆéšæ„ã€‚</p>
<p>è¿™æåŠå¤©ï¼ŒåŸæ¥æ˜¯å›¾ç‰‡å°ºå¯¸çš„é—®é¢˜ï¼Œæƒ³æƒ³è¿™UIï¼Œå”‰ï¼<br><a id="more"></a></p>
<h2 id="UIbutton">UIButtonè®¾ç½®æ–‡å­—å›¾ç‰‡å±…ä¸­</h2>

<p>UIButtonå›¾ç‰‡ã€æ–‡å­—å±…ä¸­çš„è°ƒæ•´ä¸»è¦å°±æ˜¯å››ä¸ªå‚æ•°ï¼šï¼ˆ``ï¼‰</p>
<ul>
<li><code>contentHorizontalAlignment</code>:è®¾ç½®çœŸä¸ªButtonå†…å®¹ï¼ˆåŒ…æ‹¬imageViewå’ŒtitleLabelï¼‰çš„æ°´å¹³ä½ç½®ã€‚</li>
<li><code>contentVerticalAlignment</code>:è®¾ç½®æ•´ä¸ªButtonå†…å®¹ï¼ˆåŒ…æ‹¬imageViewå’ŒtitleLabelï¼‰çš„å‚ç›´ä½ç½®ï¼Œè¿™é‡Œç”¨ä¸åˆ°ã€‚</li>
<li><code>imageEdgeInsets</code>:è®¾ç½®imageViewçš„è¾¹è·ã€‚</li>
<li><p><code>titleEdgeInsets</code>:è®¾ç½®titleLabelçš„è¾¹è·ã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">NS_ENUM</span>(<span class="built_in">NSInteger</span>, <span class="built_in">UIControlContentVerticalAlignment</span>) &#123;</span><br><span class="line">    <span class="built_in">UIControlContentVerticalAlignmentCenter</span>  = <span class="number">0</span>,</span><br><span class="line">    <span class="built_in">UIControlContentVerticalAlignmentTop</span>     = <span class="number">1</span>,</span><br><span class="line">    <span class="built_in">UIControlContentVerticalAlignmentBottom</span>  = <span class="number">2</span>,</span><br><span class="line">    <span class="built_in">UIControlContentVerticalAlignmentFill</span>    = <span class="number">3</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">NS_ENUM</span>(<span class="built_in">NSInteger</span>, <span class="built_in">UIControlContentHorizontalAlignment</span>) &#123;</span><br><span class="line">    <span class="built_in">UIControlContentHorizontalAlignmentCenter</span> = <span class="number">0</span>,</span><br><span class="line">    <span class="built_in">UIControlContentHorizontalAlignmentLeft</span>   = <span class="number">1</span>,</span><br><span class="line">    <span class="built_in">UIControlContentHorizontalAlignmentRight</span>  = <span class="number">2</span>,</span><br><span class="line">    <span class="built_in">UIControlContentHorizontalAlignmentFill</span>   = <span class="number">3</span>,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>åœ¨è¿™é‡Œç»™å‡ºæˆ‘ç”¨çš„é€šç”¨æ–¹æ³•ï¼Œbuttoné«˜åº¦ä¸º50ä¸ºä¾‹ï¼š<br>1.è®¾ç½®buttonçš„<code>contentHorizontalAlignment</code>ä¸º<code>UIControlContentHorizontalAlignmentLeft</code>,è¿™æ ·ä¾¿äºæ ¹æ®buttonå¤§å°è®¡ç®—ã€‚å½“ç„¶éè¦ç”¨centerè®¡ç®—ä¹Ÿå¯ï¼<br>2.è®¾ç½®imageViewçš„Edgeï¼š<br>  <code>kButtonImageViewEdgeInsets(btn) UIEdgeInsetsMake(0,(kOptionBtnWidth - btn.imageView.frame.size.width)/2, 20, 0);</code><br>3.è®¾ç½®titleLabelçš„Edgeï¼š<br>  <code>#define kButtonTitleEdgeInsets(btn)     UIEdgeInsetsMake(30, (kOptionBtnWidth - btn.titleLabel.frame.size.width)/2-btn.titleLabel.frame.origin.x, 0, 20);</code>ã€‚</p>
<p>åªè¦ä¼ å…¥ç›¸åº”çš„buttonå°±å¯ä»¥äº†ï¼Œå…¶ä¸­buttonçš„å®½åº¦ç”±æ­¤å¾—æ¥<code>#define kOptionBtnWidth  (CGRectGetWidth(frame)/kOptionBtnCount)</code>ã€‚</p>
<h2 id="UIView">UIViewçš„ç›¸å…³æ–¹æ³•</h2>

<p>ç›´æ¥é‡‡ç”¨ä¸Šè¿°è®¾ç½®buttonçš„æ–¹æ³•æ˜¯æœ‰æ¡ä»¶çš„ï¼Œå³ç¡®å®šäº†å½“å‰Buttonçš„å®½åº¦ã€‚æˆ‘ä»¬çœ‹åˆ°è¦è®¡ç®—buttonçš„å®½åº¦ï¼Œå¾—é€šè¿‡è¯»å–å±å¹•å®½åº¦å¾—çŸ¥ã€‚appä¸­åˆå§‹åŒ–UIViewçš„æ–¹å¼é€šå¸¸æœ‰ä¸¤ç§ï¼š<br>1.xib/Storyboardï¼Œç„¶åå…³è”<code>.h</code>,<code>.m</code>æ–‡ä»¶ã€‚<br>2.è‡ªå®šä¹‰UIViewå­ç±»,é€šè¿‡<code>initWithFrame</code>æ–¹æ³•è®¾ç½®ã€‚</p>
<p>å½“åœ¨UIViewçš„å­ç±»ä¸­å®ç°æ—¶ï¼Œå› ä¸ºæ­¤æ—¶å±å¹•å®½åº¦å·²ç»é€šè¿‡åˆå§‹åŒ–æ–¹æ³•ä¸­å¾—çŸ¥ï¼Œæ‰€ä»¥ä¸éœ€è¦å†å¤šè®¾ç½®ã€‚<br>è€Œé€šè¿‡xib/sbå…³è”çš„å­ç±»åˆå§‹åŒ–æ–¹æ³•ä¸­ï¼Œè‹¥æ‰“å°self.frameï¼Œå°±æ˜¯å½“å‰xibçš„å®½åº¦ï¼Œè€Œä¸æ˜¯å®é™…å±å¹•å®½åº¦ã€‚æ‰€ä»¥ä¸èƒ½å†åˆå§‹åŒ–æ–¹æ³•ä¸­è®¾ç½®buttonçš„å±æ€§ã€‚</p>
<p>ç¬¬ä¸€æ­¥é‡å†™çˆ¶ç±»æ–¹æ³•ï¼Œä¸‹é¢ä¸¤ä¸ªä»»é€‰å…¶ä¸€ã€‚<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)updateConstraints;-éœ€è¦é‡å†™çˆ¶ç±»çš„updateConstraintsæ–¹æ³•ã€‚</span><br><span class="line">- (<span class="keyword">void</span>)layoutSubviews;</span><br></pre></td></tr></table></figure></p>
<p>ç¬¬äºŒæ­¥å¯¹æ¯ä¸ªbuttonè°ƒç”¨<code>layoutIfNeeded</code>æ–¹æ³•ï¼Œè®©å…¶ç«‹å³åˆ·æ–°å¸ƒå±€ã€‚</p>
<p>è¿™ä¸ªæ˜¯æ²¡æœ‰è°ƒç”¨layoutIfNeededçš„æƒ…å†µï¼š<br><img src="/img/Not call layoutIfNeeded.png" alt="Not call layoutIfNeeded"></p>
<p>ä»¥ä¸Šã€‚</p>
<p>å‚è€ƒæ–‡æ¡£<br><a href="https://developer.apple.com/library/ios/documentation/UIKit/Reference/UIView_Class/index.html#//apple_ref/swift/cl/c:objc(cs" target="_blank" rel="external">UIView Class Reference</a>UIView)</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>åˆæ˜¯ä¸€ä¸ªè€ç”Ÿå¸¸è°ˆçš„é—®é¢˜ï¼Œo(â•¯â–¡â•°)oã€‚UIButtonä½œä¸ºæœ€æœ€å¸¸ç”¨çš„æ§ä»¶ï¼Œæƒ³å¿…éƒ½æ˜¯å¾ˆç†Ÿæ‚‰çš„ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºçš„æ§ä»¶ä¸­</p>
<p><img src="/img/ordersButton.png" alt="Order Buttons"></p>
<p>å¦‚æ­¤è®¾è®¡åœ¨å¾ˆå¤šç”µå•†å®¢æˆ·ç«¯ä¸­éƒ½æœ‰æ¶‰åŠï¼Œä¹Ÿæ²¡æœ‰ä»€ä¹ˆéš¾åº¦ã€‚</p>
<p>ä½†æ˜¯æˆ‘é‡åˆ°çš„é—®é¢˜å°±æ˜¯ä»»å‡­å¦‚ä½•è®¾ç½®è¾¹è·ï¼Œå°±æ˜¯å¯¹ä¸é½ï¼Œå…¶ä¸­è¿˜è¦è€ƒè™‘å±å¹•é€‚é…çš„é—®é¢˜ã€‚Orzâ€¦æœ€åå»å·¥ç¨‹é‡ŒæŸ¥çœ‹ç›¸åº”çš„å›¾ç‰‡å¤§å°ï¼Œæ‰å‘ç°æ¯ä¸ªå›¾ç‰‡çš„å°ºå¯¸å®½é«˜éƒ½ä¸åŒï¼Œå¾ˆéšæ„ã€‚</p>
<p>è¿™æåŠå¤©ï¼ŒåŸæ¥æ˜¯å›¾ç‰‡å°ºå¯¸çš„é—®é¢˜ï¼Œæƒ³æƒ³è¿™UIï¼Œå”‰ï¼<br>]]>
    
    </summary>
    
      <category term="UIButton" scheme="http://koalahl.github.io/tags/UIButton/"/>
    
      <category term="UIView" scheme="http://koalahl.github.io/tags/UIView/"/>
    
      <category term="iOS" scheme="http://koalahl.github.io/categories/iOS/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Effective-Objective C 2.0 è¦ç‚¹]]></title>
    <link href="http://koalahl.github.io/2016/03/23/Effective-Objective-C-2-0-%E8%A6%81%E7%82%B9/"/>
    <id>http://koalahl.github.io/2016/03/23/Effective-Objective-C-2-0-è¦ç‚¹/</id>
    <published>2016-03-23T08:10:35.000Z</published>
    <updated>2016-04-26T08:10:35.000Z</updated>
    <content type="html"><![CDATA[<p>Effective-Ojective C 2.0 è¯»ä¹¦ç¬”è®°</p>
<p>ç¬¬ä¸€ç« çš„å†…å®¹æ¯”è¾ƒåŸºç¡€ï¼Œå°±æ²¡æœ‰åˆ—åœ¨ç¬”è®°å½“ä¸­äº†ã€‚å¦å¤–è¯¥ç¬”è®°åªè®°å½•æ¯ä¸€ä¸ªè¦ç‚¹ä¹‹åçš„æ€»ç»“ï¼Œé‡ç‚¹åœ°æ–¹ä¼šå¦å¤–æ¢è®¨ã€‚</p>
<a id="more"></a>
<h2 id="2">ç¬¬äºŒç«  æ¶ˆæ¯ã€å¯¹è±¡ã€è¿è¡ŒæœŸ</h2>

<p>7.åœ¨å¯¹è±¡å†…éƒ¨å°½é‡ç›´æ¥è®¿é—®å®ä¾‹å˜é‡</p>
<ul>
<li>åœ¨å¯¹è±¡å†…éƒ¨è¯»å–æ•°æ®æ—¶ï¼Œåº”è¯¥ç›´æ¥é€šè¿‡å®ä¾‹å˜é‡æ¥è¯»å–ï¼›è€Œå†™å…¥æ•°æ®æ—¶ï¼Œåº”è¯¥é€šè¿‡å±æ€§çš„è®¾ç½®æ–¹æ³•æ¥å†™ã€‚</li>
<li>åœ¨åˆå§‹åŒ–æ–¹æ³•å¤šåŠdeallocæ–¹æ³•ä¸­ï¼Œæ€»æ˜¯é€šè¿‡å®ä¾‹å˜é‡æ¥è¯»å†™æ•°æ®ã€‚</li>
<li>æœ‰æ—¶ä¼šä½¿ç”¨lazy initializitionæ–¹å¼æ¥åˆå§‹åŒ–æŸæ•°æ®ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œéœ€è¦é€šè¿‡å±æ€§æ¥è¯»å–æ•°æ®ã€‚</li>
</ul>
<p>8.ç†è§£â€œå¯¹è±¡åŒç­‰æ€§â€è¿™ä¸€æ¦‚å¿µ</p>
<ul>
<li>è‹¥æƒ³æ£€æµ‹å¯¹è±¡çš„ç­‰åŒæ€§ï¼Œè¯·æä¾›<code>isEqual:</code>ä¸<code>hash</code>æ–¹æ³•ã€‚</li>
<li>ç›¸åŒçš„å¯¹è±¡å¿…é¡»å…·æœ‰ç›¸åŒçš„å“ˆå¸Œç ï¼Œä½†æ˜¯ä¸¤ä¸ªå“ˆå¸Œç ç›¸åŒçš„å¯¹è±¡å´æœªå¿…ç›¸åŒã€‚</li>
<li>ç¼–å†™hashæ–¹æ³•æ—¶ï¼Œåº”è¯¥ä½¿ç”¨è®¡ç®—é€Ÿåº¦å¿«è€Œä¸”å“ˆå¸Œå—ç¢°æ’å‡ ç‡ä½çš„ç®—æ³•ã€‚</li>
</ul>
<p>9.ä»¥ç±»ç°‡æ¨¡å¼éšè—å®ç°ç»†èŠ‚</p>
<ul>
<li>ç±»ç°‡æ¨¡å¼å¯ä»¥æŠŠå®ç°ç»†èŠ‚éšè—åœ¨ä¸€å¥—ç®€å•çš„å…¬å…±æ¥å£åé¢ã€‚</li>
<li>ç³»ç»Ÿæ¡†æ¶ä¸­ç»å¸¸ä½¿ç”¨ç±»ç°‡ã€‚</li>
<li>ä»ç±»ç°‡çš„å…¬å…±æŠ½è±¡åŸºç±»ä¸­ç»§æ‰¿å­ç±»æ—¶è¦å½“å¿ƒï¼Œè‹¥æœ‰å¼€å‘æ–‡æ¡£ï¼Œåˆ™åº”é¦–å…ˆé˜…è¯»ã€‚</li>
</ul>
<p>10.åœ¨æ—¢æœ‰ç±»ä¸­ä½¿ç”¨å…³è”å¯¹è±¡å­˜æ”¾è‡ªå®šä¹‰æ•°æ®</p>
<p>1.å…³è”å¯¹è±¡çš„å­˜å‚¨ç­–ç•¥ï¼šæšä¸¾å€¼</p>
<p>OBJC_ASSOCIATION_ASSIGN â€”&gt;assign<br>OBJC_ASSOCIATION_RETAIN_NONATOMIC â€”&gt;nonatomic,retain<br>OBJC_ASSOCIATION_COPY_NONATOMIC â€”&gt;nonatomic,copy<br>OBJC_ASSOCIATION_RETAIN â€”&gt;retain<br>OBJC_ASSOCIATION_COPY â€”&gt;copy</p>
<p>åˆ›å»ºå…³è”å¯¹è±¡æ–¹æ³•ï¼š<br>void objc_setAssociatedObject(id object,void *key,id value,objc_AssociationPolicy policy)</p>
<p>ä»¥ç»™å®šçš„é”®è·å–æŸå¯¹è±¡çš„å…³è”å¯¹è±¡çš„å€¼<br>id objc_getAssociatedObject(id object,void *key)</p>
<p>ç§»é™¤è¯¥å¯¹è±¡çš„æ‰€æœ‰å…³è”å¯¹è±¡<br>void objc_removeAssociatedObjects(id object)</p>
<p>Note:è®¾ç½®å…³è”å¯¹è±¡æ—¶çš„keyæ˜¯ä¸€ä¸ªâ€œä¸é€æ˜æŒ‡é’ˆâ€ï¼ˆopaque pointerï¼šå…¶æ‰€æŒ‡å‘çš„æ•°æ®ç»“æ„ä¸å±€é™ä¸æŸç§ç‰¹å®šç±»å‹æŒ‡é’ˆï¼‰ï¼›</p>
<p>åœ¨è®¾ç½®å…³è”å¯¹è±¡æ—¶ï¼Œé€šå¸¸ä½¿ç”¨é™æ€å…¨å±€å˜é‡ä½œä¸ºkeyã€‚</p>
<ul>
<li>å¯ä»¥é€šè¿‡â€œassociateObjectâ€æœºåˆ¶æ¥å§ä¸¤ä¸ªå¯¹è±¡è¿èµ·æ¥ã€‚</li>
<li>å®šä¹‰å…³è”å¯¹è±¡æ—¶å¯æŒ‡å®šå†…å­˜ç®¡ç†è¯­ä¹‰ï¼Œç”¨äºæ¨¡ä»¿å®šä¹‰å±æ€§æ—¶æ‰€åœ¨ç”¨çš„æ‹¥æœ‰å…³ç³»å’Œéæ‹¥æœ‰å…³ç³»ã€‚</li>
<li>åªæœ‰åœ¨å…¶ä»–åšæ³•ä¸å¯è¡Œæ—¶æ‰é€‰ç”¨å…³è”å¯¹è±¡ï¼Œå› ä¸ºè¿™ç§åšæ³•é€šå¸¸ä¼šå¼•å…¥éš¾ä»¥æŸ¥æ‰¾çš„bugã€‚</li>
</ul>
<p>11.ç†è§£objc_msgSendçš„ä½œç”¨ã€‚</p>
<ul>
<li>æ¶ˆæ¯ç”±æ¥å—è€…ã€é€‰æ‹©å™¨åŠå‚æ•°æ„æˆã€‚ç»™æŸå¯¹è±¡å‘é€æ¶ˆæ¯ï¼ˆinvoke a messageï¼‰ï¼Œä¹Ÿå°±ç›¸å½“äºåœ¨è¯¥å¯¹è±¡ä¸Šè°ƒç”¨æ–¹æ³•ï¼ˆcalla methodï¼‰</li>
<li>å‘ç»™æŸå¯¹è±¡çš„å…¨éƒ¨æ¶ˆæ¯éƒ½è¦æœ‰åŠ¨æ€æ¶ˆæ¯æ´¾å‘ç³»ç»Ÿï¼ˆdynamic message dispatch systemï¼‰æ¥å¤„ç†ï¼Œè¯¥ç³»ç»Ÿä¼šæŸ¥å‡ºå¯¹åº”çš„æ–¹æ³•ï¼Œå¹¶æ‰§è¡Œå…¶ä»£ç ã€‚</li>
</ul>
<p>12.ç†è§£æ¶ˆæ¯è½¬å‘æœºåˆ¶ã€‚</p>
<ul>
<li>è‹¥å¯¹è±¡æ— æ³•å“åº”æŸä¸ªé€‰æ‹©å™¨ä¸­çš„æ¶ˆæ¯ï¼Œåˆ™è¿›å…¥æ¶ˆæ¯è½¬å‘è¿‡ç¨‹ã€‚</li>
<li>é€šè¿‡è¿è¡ŒæœŸçš„åŠ¨æ€æ–¹æ³•è§£ææœºåˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨éœ€è¦ç”¨åˆ°æŸä¸ªæ–¹æ³•æ—¶å†å°†å…¶åŠ å…¥ç±»ä¸­ã€‚</li>
<li>å¯¹è±¡å¯ä»¥æŠŠå…¶æ— æ³•è§£è¯»çš„æ¶ˆæ¯è½¬äº¤ç»™å…¶ä»–å¯¹è±¡æ¥å¤„ç†ã€‚</li>
<li>è‹¥ç»è¿‡ä¸Šè¿°ä¸¤æ­¥è¿˜æ˜¯æ²¡åŠæ³•å¤„ç†æ¶ˆæ¯ï¼Œåˆ™å¯åŠ¨å®Œæ•´çš„æ¶ˆæ¯è½¬å‘æœºåˆ¶ã€‚</li>
</ul>
<p>13.ä½¿ç”¨æ–¹æ³•è°ƒé…æŠ€æœ¯Method Swizzlingè°ƒè¯•é»‘ç›’æ–¹æ³•<br>void method_exchangeImplementations(Method m1,Method m2)</p>
<ul>
<li>åœ¨è¿è¡ŒæœŸï¼Œå¯ä»¥å“é›·ä¸­æ–°å¢æˆ–æ›¿æ¢é€‰æ‹©å™¨æ‰€å¯¹åº”çš„æ–¹æ³•å®ç°ã€‚</li>
<li>ä½¿ç”¨å¦ä¸€ä»½å®ç°æ¥æ›¿æ¢åŸæœ‰çš„æ–¹æ³•å®ç°ï¼Œå«åšæ–¹æ³•è°ƒé…ï¼Œå¼€å‘è€…å¯ä»¥ç”¨æ­¤æŠ€æœ¯å‘åŸæœ‰å®ç°ä¸­æ·»åŠ æ–°åŠŸèƒ½ã€‚</li>
<li>ä¸€èˆ¬æ¥è¯´ï¼Œåªæœ‰è°ƒè¯•ç¨‹åºçš„æ—¶å€™æ‰éœ€è¦åœ¨è¿è¡ŒæœŸä¿®æ”¹æ–¹æ³•å®ç°ï¼Œè¿™ç§åšæ³•ä¸å®œæ»¥ç”¨ã€‚</li>
</ul>
<p>14.ç†è§£â€œç±»å¯¹è±¡â€çš„ç”¨æ„</p>
<ul>
<li>æ¯ä¸ªå®ä¾‹éƒ½æœ‰ä¸€ä¸ªæŒ‡å‘Classå¯¹è±¡çš„æŒ‡é’ˆï¼ˆisaï¼‰ï¼Œç”¨æ„è¡¨æ˜å…¶ç±»å‹ï¼Œè€Œè¿™äº›Classå¯¹è±¡åˆ™æ„æˆäº†ç±»çš„ç»§æ‰¿ä½“ç³»ï¼ˆsuper_classæŒ‡é’ˆï¼‰ã€‚</li>
<li>å¦‚æœå¯¹è±¡ç±»å‹æ— æ³•å†ç¼–è¯‘æœŸç¡®å®šï¼Œé‚£ä¹ˆä¹…åº”è¯¥ä½¿ç”¨ç±»å‹ä¿¡æ¯æŸ¥è¯¢æ–¹æ³•æ¥æ¢çŸ¥ã€‚isMemberOfClassï¼ˆç‰¹å®šç±»å‹çš„ç±»ï¼‰ï¼ŒisKindOfClassï¼ˆè¯¥ç±»åŠå…¶æ´¾ç”Ÿç±»ï¼‰</li>
<li>å°½é‡ä½¿ç”¨ç±»å‹ä¿¡æ¯æŸ¥è¯¢æ–¹æ³•æ¥ç¡®å®šå¯¹è±¡ç±»å‹ï¼Œè€Œä¸è¦ç›´æ¥æ¯”è¾ƒç±»å¯¹è±¡ï¼Œå› ä¸ºæŸäº›å¯¹è±¡å¯èƒ½å®ç°äº†æ¶ˆæ¯è½¬å‘åŠŸèƒ½ã€‚</li>
</ul>
<h2 id="3">ç¬¬ä¸‰ç«  æ¥å£ä¸APIè®¾è®¡</h2>

<p>15.ä½¿ç”¨å‰ç¼€é¿å…å‘½åç©ºé—´å†²çªï¼Œè§£å†³duplicate symbolé—®é¢˜ã€‚<br>16.ä½¿ç”¨å…¨èƒ½åˆå§‹åŒ–æ–¹æ³•ï¼Œå³å¸¦æœ‰ç‰¹å®šå‚æ•°çš„åˆå§‹åŒ–æ–¹æ³•ã€‚<br>17.å®ç°descriptionæ–¹æ³•ç”¨æ¥è°ƒè¯•ç¨‹åºã€‚å¹¶ä¸”æœ€å¥½ç”¨å­—å…¸çš„æ–¹å¼è¾“å‡ºç±»çš„å±æ€§ï¼Œæ¡ç†æ¸…æ™°ã€‚<br>18.å°½é‡ä½¿ç”¨ä¸å¯å˜å¯¹è±¡ã€‚<br>19.ä½¿ç”¨æ¸…æ™°è€Œåè°ƒçš„å‘½åæ–¹å¼ã€‚å‚è€ƒObjective Cç¼–ç¨‹è§„èŒƒã€‚<br>20.ä¸ºç§æœ‰æ–¹æ³•åæ·»åŠ å‰ç¼€ã€‚<br>21.ç†è§£OCçš„é”™è¯¯æ¨¡å‹ã€‚OCåœ¨é‡åˆ°æå…¶ä¸¥é‡çš„é”™è¯¯åï¼Œä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œç¨‹åºä¼šé€€å‡ºï¼ˆcrashï¼‰ï¼Œæ‰€ä»¥ä¸ç”¨å¤ªè€ƒè™‘å¼‚å¸¸å®‰å…¨ã€‚å¦‚æœä¸å¤ªä¸¥é‡çš„é”™è¯¯ï¼Œå¯ä»¥é€šè¿‡è®¾ç½®è¿”å›nil/0ï¼Œæˆ–è€…NSErrorã€‚<br>22.ç†è§£NSCopyingåè®®ã€‚</p>
<ul>
<li>å®ç°NSCopyingåè®®ã€‚</li>
<li>é‡å†™<code>copyWithZone</code>æ–¹æ³•ã€‚</li>
<li><p>å¦‚æœç±»ä¸­æœ‰å¯å˜å±æ€§ï¼Œåˆ™åœ¨copyWithZoneæ–¹æ³•ä¸­åŒæ—¶éœ€è¦å¯¹å¯å˜å±æ€§è¿›è¡Œ<code>mutableCopy</code>ã€‚<br>ä¸¾ä¸ªä¾‹å­ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#import <span class="title">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">EOCPerson</span> : <span class="title">NSObject</span>&lt;<span class="title">NSCopying</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">copy</span>)<span class="built_in">NSString</span> * firstname;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">copy</span>)<span class="built_in">NSString</span> * lastname;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">id</span>)initWithFirstName:(<span class="built_in">NSString</span> *)fisrtname lastName:(<span class="built_in">NSString</span> *)lastname;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#import <span class="title">"EOCPerson.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">EOCPerson</span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSMutableSet</span> * _friends;</span><br><span class="line">&#125;</span><br><span class="line">- (<span class="keyword">id</span>)initWithFirstName:(<span class="built_in">NSString</span> *)fisrtname lastName:(<span class="built_in">NSString</span> *)lastname&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span> == [<span class="keyword">super</span> init]) &#123;</span><br><span class="line">        _firstname = firstname;</span><br><span class="line">        _lastname  = lastname;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">id</span>)copyWithZone:(<span class="built_in">NSZone</span> *)zone&#123;</span><br><span class="line"></span><br><span class="line">    EOCPerson *<span class="keyword">copy</span> = [[[<span class="keyword">self</span> class] allocWithZone:zone] initWithFirstName:_firstname lastName:_lastname];</span><br><span class="line">    <span class="keyword">copy</span>-&gt;_friends = [_friends mutableCopy];</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">copy</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p>è¦ç‚¹ï¼š</p>
<ul>
<li>è‡ªå®šä¹‰å¯¹è±¡è‹¥æƒ³è¦è¿›è¡Œcopyæ“ä½œï¼Œéœ€å®ç°NSCopyingåè®®ã€‚</li>
<li>è‡ªå®šä¹‰å¯¹è±¡è‹¥åˆ†ä¸ºå¯å˜å’Œä¸å¯å˜ç‰ˆæœ¬ï¼Œåˆ™éœ€å®ç°NSCopyingå’ŒNSMutableCopyingåè®®ã€‚</li>
<li>å¤åˆ¶å¯¹è±¡æ—¶éœ€è¦è€ƒè™‘ä½¿ç”¨æµ…æ‹·è´è¿˜æ˜¯æ·±æ‹·è´ã€‚ä¸€èˆ¬åº”è¯¥å°½é‡ä½¿ç”¨æµ…æ‹·è´ã€‚</li>
<li>è‡ªå®šä¹‰å¯¹è±¡è‹¥éœ€è¦æ·±æ‹·è´ï¼Œåˆ™å¯ä»¥æ–°å¢ä¸€ä¸ªä¸“é—¨æ‰§è¡Œæ·±æ‹·è´çš„æ–¹æ³•ã€‚</li>
</ul>
</li>
</ul>
<h2 id="4">ç¬¬å››ç«  åè®®ä¸åˆ†ç±»</h2>

<p>23.é€šè¿‡å§”æ‰˜ä¸æ•°æ®æºåè®®è¿›è¡Œå¯¹è±¡é—´é€šä¿¡<br>24.å°†ç±»çš„å®ç°ä»£ç åˆ†æ•£åˆ°æ•°ä¸ªåˆ†ç±»ï¼ˆcategoryï¼‰ä¹‹ä¸­ã€‚<br>25.æ€»æ˜¯ä¸ºç¬¬ä¸‰æ–¹åˆ†ç±»åç§°å‰åŠ å‰ç¼€ã€‚<br>26.å°½é‡ä¸è¦åœ¨åˆ†ç±»ä¸­å£°æ˜å±æ€§ï¼ˆå½“ç„¶éè¦åšä¹Ÿå¯ï¼‰<br>27.ä½¿ç”¨<code>class-continuationåˆ†ç±»</code>ï¼ˆåŒ¿ååˆ†ç±»ï¼‰éšè—å®ç°ç»†èŠ‚<br>28.é€šè¿‡åè®®æä¾›åŒ¿åå¯¹è±¡ã€‚ä¾‹å¦‚ id<nscopying>,id<eocdelegate>ã€‚ä»»æ„ä¸€ä¸ªéµå®ˆäº†ä¸Šè¿°åè®®çš„å¯¹è±¡éƒ½å¯ä»¥èµ‹å€¼ç»™è¿™ä¸ªå±æ€§ã€‚</eocdelegate></nscopying></p>
<h2 id="5">ç¬¬äº”ç«  å†…å­˜ç®¡ç†</h2>

<p>29.ç†è§£å¼•ç”¨è®¡æ•°ã€‚<br>30.ä»¥ARCç®€åŒ–å¼•ç”¨è®¡æ•°ã€‚<br>31.åœ¨deallocæ–¹æ³•ä¸­åªé‡Šæ”¾å¼•ç”¨å¹¶è§£é™¤ç›‘å¬ã€‚<br>32.ç¼–å†™â€œå¼‚å¸¸å®‰å…¨ä»£ç â€æ—¶åº”ç•™æ„å†…å­˜ç®¡ç†é—®é¢˜ã€‚<br>33.ä»¥å¼±å¼•ç”¨é¿å…å¾ªç¯å¼•ç”¨ã€‚<br>34.ä»¥â€œè‡ªåŠ¨é‡Šæ”¾æ± â€é™ä½å†…å­˜å³°å€¼ã€‚<br>35.ä½¿ç”¨<code>Zombie Object</code>è°ƒè¯•å†…å­˜é—®é¢˜ã€‚<br>36.ä¸è¦ä½¿ç”¨retainCountã€‚ARCä¸‹å·²åºŸå¼ƒã€‚</p>
<h2 id="6">ç¬¬å…­ç«  GCD</h2>

<p>37.ç†è§£blockã€‚é‡ç‚¹çœ‹ä¸€ä¸‹blockçš„å†…éƒ¨ç»“æ„é‚£ä¸€èŠ‚ã€‚</p>
<ul>
<li>blockä¸­çš„invokeå˜é‡ï¼Œæ˜¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆï¼Œç±»å‹ä¸º<code>void(*)(void *,_)</code>æŒ‡å‘äº†blockçš„å®ç°ä»£ç ï¼ˆéœ€è¦æ‰§è¡Œçš„å‡½æ•°ï¼‰ã€‚</li>
<li>blockä¸­çš„descriptoræ˜¯ä¸€ä¸ªç»“æ„ä½“æŒ‡é’ˆã€‚è¯¥ç»“æ„ä½“ä¸­åŒ…å«äº†è¿™ä¸ªblockçš„ä¸€äº›ä¿¡æ¯ï¼Œå¦‚blockçš„sizeã€‚</li>
<li>blockè¿˜ä¼šæŠŠä»å¤–éƒ¨æ•è·çš„å˜é‡æ‹·è´ä¸€ä»½ï¼Œæ”¾åœ¨descriptorå˜é‡çš„åé¢ã€‚æ‹·è´çš„å¹¶ä¸æ˜¯å¯¹è±¡æœ¬èº«ï¼Œè€Œæ˜¯è¿™äº›å¯¹è±¡çš„æŒ‡é’ˆå˜é‡ã€‚invokeå‡½æ•°æŠŠblockå¯¹è±¡æœ¬èº«ä½œä¸ºå‚æ•°ä¼ é€’è¿›æ¥ï¼Œå°±æ˜¯ä¸ºäº†èƒ½   æ‹¿åˆ°blockæ•è·çš„è¿™äº›å˜é‡ã€‚</li>
<li>blockè¢«å®šä¹‰æ—¶æ˜¯åˆ†é…åœ¨æ ˆå†…å­˜ä¸­ã€‚æ‰€ä»¥éœ€è¦copyä¸€ä»½ï¼Œå¤åˆ¶åˆ°å †å†…å­˜ä¸­ï¼Œå°±å¯ä»¥åœ¨å¤–éƒ¨ä½¿ç”¨ã€‚<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ ˆblockï¼š</span></span><br><span class="line"><span class="keyword">void</span>(^block)();</span><br><span class="line">  <span class="keyword">if</span> (<span class="comment">/* condition */</span>) &#123;</span><br><span class="line">    block = ^()&#123; <span class="built_in">NSLog</span>(<span class="string">@"Block in Stack"</span>); &#125;</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    block = ^()&#123; <span class="built_in">NSLog</span>(<span class="string">@"Block in Stack still"</span>); &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  block();</span><br><span class="line"></span><br><span class="line"><span class="comment">//å †blockï¼š</span></span><br><span class="line"><span class="keyword">void</span>(^block)();</span><br><span class="line">  <span class="keyword">if</span> (<span class="comment">/* condition */</span>) &#123;</span><br><span class="line">    block = [^()&#123; <span class="built_in">NSLog</span>(<span class="string">@"Block in Heap"</span>); &#125; <span class="keyword">copy</span>];</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    block = [^()&#123; <span class="built_in">NSLog</span>(<span class="string">@"Block in Heap"</span>); &#125; <span class="keyword">copy</span>];</span><br><span class="line">  &#125;</span><br><span class="line">  block();</span><br><span class="line"></span><br><span class="line"><span class="comment">//å…¨å±€blockï¼š</span></span><br><span class="line">  <span class="keyword">void</span> (^block)() = ^()&#123; <span class="built_in">NSLog</span>(<span class="string">@"I'm a global block"</span>);&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>38.ä¸ºå¸¸ç”¨çš„blockåˆ›å»ºtypedefã€‚<br>39.ç”¨handlerå—æ¥é™ä½ä»£ç åˆ†æ•£ã€‚å¸¸ç”¨äºå¼‚æ­¥ä»»åŠ¡æ—¶ã€‚<br>40.ä½¿ç”¨blockæ—¶æ³¨æ„ä¸è¦å‡ºç°å¾ªç¯å¼•ç”¨ã€‚<br>41.å¤šç”¨dispatch queueï¼Œå°‘ç”¨åŒæ­¥é”ã€‚ä¾‹å¦‚æ¶‰åŠåˆ°æ•°æ®çš„å­˜å–ã€‚<br>    GCDä»¥å‰ï¼Œæœ‰ä¸¤ç§å®ç°é”çš„æ–¹å¼ï¼š<br>    1.@synchronized(self){ â€¦ }.è¿™ç§æ–¹å¼ä¼šé™ä½ä»£ç æ‰§è¡Œæ•ˆç‡ï¼Œå› ä¸ºèŠ±æ‹¬å·å†…çš„ä»£ç éƒ½å…±ç”¨ä¸€ä¸ªåŒæ­¥é”ï¼Œä¸”é¡ºåºæ‰§è¡Œã€‚<br>    2.ä½¿ç”¨NSLockã€‚<code>lock()</code>æ–¹æ³•å’Œ<code>unlock()</code>æ–¹æ³•ã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨é€’å½’é”<code>NSRecursiveLock</code>,çº¿ç¨‹èƒ½å¤Ÿå¤šæ¬¡æŒæœ‰è¯¥é”ï¼Œè€Œä¸ä¼šå‡ºç°æ­»é”ç°è±¡ã€‚<br>    ä¾‹å­ï¼šå±æ€§çš„è¯»å–å’Œè®¾ç½®ä¸­ã€‚</p>
<p>42.å¤šç”¨GCDï¼Œå°‘ç”¨performeSelector.</p>
<ul>
<li><code>performSelector</code>ç³»åˆ—æ–¹æ³•åœ¨å†…å­˜ç®¡ç†æ–¹é¢å®¹æ˜“æœ‰é™·é˜±ã€‚ç¼–è¯‘å™¨æ— æ³•ç¡®å®šå…¶å°†è¦æ‰§è¡Œçš„SELå…·ä½“æ˜¯ä»€ä¹ˆï¼Œå› æ­¤æ— æ³•é€šè¿‡ARCåœ¨ç¼–è¯‘æœŸæ’å…¥å†…å­˜ç®¡ç†æ–¹æ³•ã€‚</li>
<li><code>performSelector</code>èƒ½å¤Ÿå¤„ç†çš„<code>SEL</code>æœ‰ç‚¹å±€é™ï¼Œé€‰æ‹©å™¨çš„è¿”å›ç±»å‹å’Œå‚æ•°ä¸ªæ•°éƒ½æœ‰é™åˆ¶ã€‚</li>
</ul>
<p>43.æŒæ¡GCDå’ŒOperationQueueæ“ä½œé˜Ÿåˆ—çš„ä½¿ç”¨æ—¶æœºã€‚<br>  æ‰§è¡Œåå°ä»»åŠ¡æ—¶ï¼Œæ“ä½œé˜Ÿåˆ—æ›´æœ‰ä¼˜åŠ¿ã€‚<br>  ä½¿ç”¨<code>NSOperationå’ŒNSOperationQueue</code>çš„å¥½å¤„ï¼š</p>
<ul>
<li>å–æ¶ˆæŸä¸ªæ“ä½œã€‚æ³¨æ„ï¼šå¯ä»¥å–æ¶ˆçš„æ˜¯é˜Ÿåˆ—ä¸­è¿˜æ²¡æœ‰æ‰§è¡Œçš„ä»»åŠ¡ã€‚</li>
<li>æŒ‡å®šæ“ä½œé—´çš„ä¾èµ–å…³ç³»ã€‚</li>
<li>é€šè¿‡KVOç›‘æµ‹NSOperationå¯¹è±¡çš„å±æ€§ã€‚</li>
<li>æŒ‡å®šOperationçš„ä¼˜å…ˆçº§ã€‚</li>
<li>é‡ç”¨operationsã€‚</li>
</ul>
<p>44.é€šè¿‡Dispatch_groupæœºåˆ¶ï¼Œæ ¹æ®ç³»ç»Ÿèµ„æºçŠ¶å†µæ¥æ‰§è¡Œä»»åŠ¡</p>
<ul>
<li>dispatch_apply. è¿™ä¸ªä¼šé˜»å¡å½“å‰çº¿ç¨‹ã€‚æ‰€ä»¥ä¸èƒ½æŠŠä¸»çº¿ç¨‹ä½œä¸ºè¯¥æ–¹æ³•æ‰§è¡Œçš„çº¿ç¨‹å‚æ•°ã€‚</li>
</ul>
<p>45.ä½¿ç”¨<code>dispatch_once</code>æ¥æ‰§è¡Œåªéœ€è¦è¿è¡Œä¸€æ¬¡çš„çº¿ç¨‹å®‰å…¨ä»£ç ã€‚å¸¸ç”¨äºå•ä¾‹æ¨¡å¼ã€‚<br>46.ä¸è¦ä½¿ç”¨dispatch_get_current_queue</p>
<h2 id="7">ç¬¬ä¸ƒç«  ç³»ç»Ÿæ¡†æ¶</h2>

<p>47.ç†Ÿæ‚‰ç³»ç»Ÿæ¡†æ¶ã€‚<br>  Fundation å’Œ CoreFoundationã€‚</p>
<ul>
<li>æ— ç¼æ¡¥æ¥ï¼Œtoll-free-bridging,å¯ä»¥å°†CoreFoundationä¸­çš„Cè¯­è¨€æ•°æ®ç»“æ„è½¬æ¢ä¸ºFoundationä¸­çš„å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥åå‘è½¬æ¢ã€‚</li>
</ul>
<p>48.å¤šç”¨å—æšä¸¾ï¼Œå°‘ç”¨forå¾ªç¯ã€‚</p>
<ol>
<li>for(int i=0;i&lt;max;i++){}</li>
<li>NSEnumerator. <code>allObjects()</code> å’Œ<code>nextObject()</code>æ–¹æ³•ã€‚</li>
<li>å¿«é€Ÿéå† fast enumeration. for in<br>åŸºäºblockçš„éå†æ–¹å¼<br><code>- enumerateObjectesUsingBlock:(void(^)(id object,NSUInteger index,BOOL *stop))block</code><br>â€¦å…¶ä»–æ–¹æ³•</li>
</ol>
<p>49.å¯¹è‡ªå®šä¹‰å†…å­˜ç®¡ç†è¯­ä¹‰çš„collectioné›†åˆç±»ä½¿ç”¨æ— ç¼æ¡¥æ¥ã€‚</p>
<ul>
<li>__bridge</li>
<li>__bridge_retained</li>
<li><p>__bridge_transfer</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSArray</span> *nameArray = @[<span class="string">@"g"</span>,<span class="string">@"c"</span>,<span class="string">@"d"</span>];</span><br><span class="line"><span class="comment">//æ­£å‘æ¡¥æ¥ï¼šFoundationå¯¹è±¡-&gt;CoreFoundationæ•°æ®ç»“æ„</span></span><br><span class="line"><span class="built_in">CFArrayRef</span> a<span class="built_in">CFArray</span> = (__bridge <span class="built_in">CFArrayRef</span>)nameArray  ;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"CFArray's count is %li"</span>,<span class="built_in">CFArrayGetCount</span>(a<span class="built_in">CFArray</span>));</span><br><span class="line"></span><br><span class="line"><span class="built_in">CFArrayRef</span> b<span class="built_in">CFArray</span> = (__bridge_retained <span class="built_in">CFArrayRef</span>)nameArray;</span><br><span class="line"><span class="comment">//æˆ–è€…ç”¨</span></span><br><span class="line">b<span class="built_in">CFArray</span> = <span class="built_in">CFBridgingRetain</span>(nameArray);</span><br><span class="line"></span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"CFArray's count is %li"</span>,<span class="built_in">CFArrayGetCount</span>(b<span class="built_in">CFArray</span>));</span><br><span class="line"><span class="built_in">CFRelease</span>(b<span class="built_in">CFArray</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">NSArray</span> *names = (<span class="built_in">NSArray</span> *)(__bridge_transfer <span class="built_in">NSArray</span> *)a<span class="built_in">CFArray</span>;</span><br><span class="line"><span class="comment">//    //æˆ–è€…ç”¨</span></span><br><span class="line"><span class="comment">//    NSArray * names = CFBridgingRelease(aCFArray);</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"%@"</span>,names);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>50.æ„å»ºç¼“å­˜æ—¶ä½¿ç”¨NSCacheè€Œä¸æ˜¯NSDictionaryã€‚</p>
<p>51.ç²¾ç®€initializeå’Œloadçš„å®ç°ä»£ç ã€‚<br>    ä¸¤ä¸ªéƒ½æ˜¯ç±»çš„åˆå§‹åŒ–æ–¹æ³•ã€‚<br>    1.<code>load()</code><br>    å¯¹äºåŠ å…¥è¿è¡Œæ—¶çš„ç±»classå’Œåˆ†ç±»categoryæ¥è¯´ï¼Œå½“åŒ…å«ç±»å’Œåˆ†ç±»çš„ç¨‹åºåº“è½½å…¥ç³»ç»Ÿæ—¶ï¼Œå¿…å®šä¼šè°ƒç”¨<code>+ (void)load</code>æ–¹æ³•ï¼Œä¸”åªè°ƒç”¨ä¸€æ¬¡ã€‚<br>    å¯¹äºiOSç³»ç»Ÿï¼Œæ˜¯åœ¨åº”ç”¨ç¨‹åºå¯åŠ¨çš„æ—¶å€™ã€‚å¯¹äºMac OS Xæ¥è¯´æ›´è‡ªç”±ï¼Œå› ä¸ºå¯ä»¥ä½¿ç”¨åŠ¨æ€åŠ è½½<code>dynamic loading</code>è¿™ç§ç‰¹æ€§,ç­‰åº”ç”¨ç¨‹åºå¯åŠ¨å®Œæˆä¹‹åå†å»åŠ è½½ç¨‹åºåº“ã€‚è‹¥åˆ†ç±»å’Œç±»ä¸­éƒ½å®šä¹‰äº†loadæ–¹æ³•ï¼Œåˆ™å…ˆè°ƒç”¨ç±»çš„ï¼Œå†è°ƒç”¨åˆ†ç±»çš„ã€‚<br>    loadæ–¹æ³•ä¸€èˆ¬åªç”¨æ¥è°ƒè¯•ç¨‹åºï¼Œè€Œä¸æ˜¯åœ¨å…¶ä¸­åšä»€ä¹ˆæ“ä½œã€‚<br>    2.<code>initialize</code><br>    å¯¹äºæ¯ä¸ªç±»æ¥è¯´ï¼Œè¯¥æ–¹æ³•ä¼šåœ¨é¦–æ¬¡ä½¿ç”¨è¯¥ç±»ä¹‹å‰è°ƒç”¨ï¼Œä¸”åªè°ƒç”¨ä¸€æ¬¡ã€‚å®ƒæ˜¯ç”±è¿è¡Œæ—¶ç³»ç»Ÿæ¥è°ƒç”¨ï¼Œè€Œä¸æ˜¯ç”±ä»£ç è°ƒç”¨ã€‚<br>  ä¸loadçš„åŒºåˆ«ï¼š</p>
<ul>
<li>æƒ°æ€§è°ƒç”¨ã€‚åªæœ‰å½“ç”¨åˆ°è¿™ä¸ªç±»æ—¶ï¼Œæ‰ä¼šè¢«è°ƒç”¨ã€‚å¦‚æœæŸä¸ªç±»æ²¡æœ‰è¢«ä½¿ç”¨ï¼Œåˆ™ä¸ä¼šè¢«è°ƒç”¨ã€‚è€Œç¨‹åºå¿…é¡»é˜»å¡æŠŠæ‰€æœ‰ç±»çš„loadæ–¹æ³•æ‰§è¡Œå®Œæ‰èƒ½ç»§ç»­ã€‚</li>
<li>æ‰§è¡Œæ–¹æ³•æ—¶è¿è¡Œæ—¶ç³»ç»Ÿçš„çŠ¶æ€ã€‚<code>initializer</code>è¢«æ‰§è¡Œæ—¶ï¼Œruntime systemæ˜¯æ­£å¸¸çŠ¶æ€çš„ã€‚è€Œ<code>load</code>è¢«æ‰§è¡Œæ—¶ï¼Œruntime systemæ˜¯è„†å¼±çŠ¶æ€çš„ã€‚(è¿™ä¸ªè„†å¼±çŠ¶æ€æ˜¯æŒ‡æœ€å¥½ä¸è¦åœ¨loadæ–¹æ³•ä¸­ä½¿ç”¨åˆ«çš„ç±»)</li>
<li><code>initialize</code>æ–¹æ³•éµå¾ªç»§æ‰¿è°ƒç”¨ã€‚å³å­ç±»å³ä½¿æ²¡æœ‰å®ç°initializeæ–¹æ³•ï¼Œä¹Ÿä¼šè°ƒç”¨çˆ¶ç±»çš„initializeæ–¹æ³•ã€‚è€Œloadæ–¹æ³•åˆ™ä¸ä¼šï¼Œå­ç±»è‹¥æ²¡æœ‰å®ç°loadæ–¹æ³•ï¼Œä¹Ÿä¸ä¼šå»è°ƒç”¨çˆ¶ç±»çš„loadã€‚</li>
</ul>
<p>52.åˆ«å¿˜äº†NSTimerä¼šä¿ç•™å…¶ç›®æ ‡å¯¹è±¡ã€‚</p>
<ul>
<li>NSTimerå¯¹è±¡ä¼šå¼•ç”¨å…¶ç›®æ ‡å¯¹è±¡ï¼Œç›´åˆ°è®¡æ—¶å™¨æœ¬èº«å¤±æ•ˆä¸ºæ­¢ï¼Œè°ƒç”¨<code>invalidate</code>æ–¹æ³•å¯ä»¤è®¡æ—¶å™¨å¤±æ•ˆï¼Œå¦å¤–ï¼Œä¸€æ¬¡æ€§çš„è®¡æ—¶å™¨åœ¨è§¦å‘å®Œä»»åŠ¡ä¹‹åä¹Ÿä¼šå¤±æ•ˆã€‚</li>
<li>åå¤æ‰§è¡Œä»»åŠ¡çš„è®¡æ—¶å™¨ï¼Œå¾ˆå®¹æ˜“å¼•èµ·å¾ªç¯å¼•ç”¨ã€‚</li>
<li>å¯ä»¥æ‰©å……NSTimerçš„åŠŸèƒ½ï¼Œç”¨blockæ¥æ‰“ç ´è¿™ç§å¾ªç¯å¼•ç”¨ã€‚å¿…é¡»åˆ›å»ºåˆ†ç±»ï¼Œå°†ç›¸å…³å®ç°ä»£ç åŠ å…¥å…¶ä¸­ã€‚</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åˆ†ç±»æ–‡ä»¶.h/.m</span></span><br><span class="line">  <span class="preprocessor">#import <span class="title">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">  <span class="class"><span class="keyword">@interface</span> <span class="title">NSTimer</span> (<span class="title">BlockTimer</span>)</span></span><br><span class="line"></span><br><span class="line">  + (<span class="built_in">NSTimer</span> *)bt_scheduledTimerWithTimeInterval:(<span class="built_in">NSTimeInterval</span>)interval block:(<span class="keyword">void</span>(^)())block repeats:(<span class="built_in">BOOL</span>)repeats;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="preprocessor">#import <span class="title">"NSTimer+BlockTimer.h"</span></span></span><br><span class="line"></span><br><span class="line">  <span class="class"><span class="keyword">@implementation</span> <span class="title">NSTimer</span> (<span class="title">BlockTimer</span>)</span></span><br><span class="line"></span><br><span class="line">  + (<span class="built_in">NSTimer</span> *)bt_scheduledTimerWithTimeInterval:(<span class="built_in">NSTimeInterval</span>)interval block:(<span class="keyword">void</span>(^)())block repeats:(<span class="built_in">BOOL</span>)repeats&#123;</span><br><span class="line">      <span class="keyword">return</span> [<span class="keyword">self</span> scheduledTimerWithTimeInterval:interval target:<span class="keyword">self</span> selector:<span class="keyword">@selector</span>(bt_doSomething:) userInfo:[block <span class="keyword">copy</span>] repeats:repeats];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  + (<span class="keyword">void</span>)bt_doSomething:(<span class="built_in">NSTimer</span> *)timer&#123;</span><br><span class="line">      <span class="keyword">void</span>(^block)() = timer<span class="variable">.userInfo</span>;</span><br><span class="line">      <span class="keyword">if</span> (block) &#123;</span><br><span class="line">          block();</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//åœ¨è°ƒç”¨æ—¶</span></span><br><span class="line">  __<span class="keyword">weak</span> <span class="keyword">typeof</span>(<span class="keyword">self</span>)weakSelf = <span class="keyword">self</span>;</span><br><span class="line">  _timer = [<span class="built_in">NSTimer</span> bt_scheduledTimerWithTimeInterval:<span class="number">1</span> block:^&#123;</span><br><span class="line">      <span class="comment">//ä¸éœ€è¦å†è½¬æˆstrongä¹Ÿå¯ä»¥å•Šï¼ï¼Ÿ</span></span><br><span class="line">      [weakSelf printName:<span class="string">@"hello"</span>];</span><br><span class="line"></span><br><span class="line">      ViewController * strongSelf = weakSelf;</span><br><span class="line">      [strongSelf printName:<span class="string">@"world"</span>];</span><br><span class="line"></span><br><span class="line">  &#125; repeats:<span class="literal">YES</span>];</span><br></pre></td></tr></table></figure>
]]></content>
    <summary type="html">
    <![CDATA[<p>Effective-Ojective C 2.0 è¯»ä¹¦ç¬”è®°</p>
<p>ç¬¬ä¸€ç« çš„å†…å®¹æ¯”è¾ƒåŸºç¡€ï¼Œå°±æ²¡æœ‰åˆ—åœ¨ç¬”è®°å½“ä¸­äº†ã€‚å¦å¤–è¯¥ç¬”è®°åªè®°å½•æ¯ä¸€ä¸ªè¦ç‚¹ä¹‹åçš„æ€»ç»“ï¼Œé‡ç‚¹åœ°æ–¹ä¼šå¦å¤–æ¢è®¨ã€‚</p>]]>
    
    </summary>
    
      <category term="Effective-Ojective C 2.0" scheme="http://koalahl.github.io/tags/Effective-Ojective-C-2-0/"/>
    
      <category term="iOS" scheme="http://koalahl.github.io/categories/iOS/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[iOS è“ç‰™4.0å¼€å‘]]></title>
    <link href="http://koalahl.github.io/2016/03/08/iOS-%E8%93%9D%E7%89%994-0%E5%BC%80%E5%8F%91/"/>
    <id>http://koalahl.github.io/2016/03/08/iOS-è“ç‰™4-0å¼€å‘/</id>
    <published>2016-03-08T12:19:39.000Z</published>
    <updated>2016-03-08T12:19:39.000Z</updated>
    <content type="html"><![CDATA[<p>iOS è“ç‰™4.0å¼€å‘</p>
<h2>èƒŒæ™¯ï¼š</h2><br>1.iOSçš„è“ç‰™ä¸èƒ½ç”¨æ¥ä¼ è¾“æ–‡ä»¶ã€‚<br>2.iOSä¸iOSè®¾å¤‡ä¹‹é—´è¿›è¡Œæ•°æ®é€šä¿¡ï¼Œä½¿ç”¨gameKit.framework<br>3.iOSä¸å…¶ä»–éiOSè®¾å¤‡è¿›è¡Œæ•°æ®é€šä¿¡ï¼Œä½¿ç”¨coreBluetooth.framework<br><br><a id="more"></a><br><h2>iOSä¸­è“ç‰™çš„å®ç°æ–¹æ¡ˆ</h2>


<p>iOSä¸­æä¾›äº†4ä¸ªæ¡†æ¶ç”¨äºå®ç°è“ç‰™è¿æ¥<br>GameKit.frameworkï¼ˆç”¨æ³•ç®€å•ï¼‰<br>åªèƒ½ç”¨äºiOSè®¾å¤‡ä¹‹é—´çš„è¿æ¥ï¼Œå¤šç”¨äºæ¸¸æˆï¼ˆæ¯”å¦‚äº”å­æ£‹å¯¹æˆ˜ï¼‰ï¼Œä»iOS7å¼€å§‹è¿‡æœŸ</p>
<p>MultipeerConnectivity.framework<br>åªèƒ½ç”¨äºiOSè®¾å¤‡ä¹‹é—´çš„è¿æ¥ï¼Œä»iOS7å¼€å§‹å¼•å…¥ï¼Œä¸»è¦ç”¨äºæ–‡ä»¶å…±äº«ï¼ˆä»…é™äºæ²™ç›’çš„æ–‡ä»¶ï¼‰</p>
<p>ExternalAccessory.framework<br>å¯ç”¨äºç¬¬ä¸‰æ–¹è“ç‰™è®¾å¤‡äº¤äº’ï¼Œä½†æ˜¯è“ç‰™è®¾å¤‡å¿…é¡»ç»è¿‡è‹¹æœMFiè®¤è¯ï¼ˆå›½å†…è¾ƒå°‘ï¼‰</p>
<p>CoreBluetooth.frameworkï¼ˆæ—¶ä¸‹çƒ­é—¨ï¼‰<br>å¯ç”¨äºç¬¬ä¸‰æ–¹è“ç‰™è®¾å¤‡äº¤äº’ï¼Œå¿…é¡»è¦æ”¯æŒè“ç‰™4.0<br>ç¡¬ä»¶è‡³å°‘æ˜¯4sï¼Œç³»ç»Ÿè‡³å°‘æ˜¯iOS6<br>è“ç‰™4.0ä»¥ä½åŠŸè€—è‘—ç§°ï¼Œä¸€èˆ¬ä¹Ÿå«BLEï¼ˆBluetoothLowEnergyï¼‰<br>ç›®å‰åº”ç”¨æ¯”è¾ƒå¤šçš„æ¡ˆä¾‹ï¼šè¿åŠ¨æ‰‹åã€åµŒå…¥å¼è®¾å¤‡ã€æ™ºèƒ½å®¶å±…</p>
<p>ä¸‹é¢å…·ä½“ä»‹ç»ä½¿ç”¨CoreBluetooth.frameworkçš„ä»£ç æ­¥éª¤ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è“ç‰™ç³»ç»Ÿåº“</span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#import <span class="title">&lt;CoreBluetooth/CoreBluetooth.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//å¿…é¡»è¦ç”±UUIDæ¥å”¯ä¸€æ ‡ç¤ºå¯¹åº”çš„serviceå’Œcharacteristic</span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#define kServiceUUID @<span class="title">"5C476471-1109-4EBE-A826-45B4F9D74FB9"</span></span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#define kCharacteristicHeartRateUUID @<span class="title">"82C7AC0F-6113-4EC9-92D1-5EEF44571398"</span></span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#define kCharacteristicBodyLocationUUID @<span class="title">"537B5FD6-1889-4041-9C35-F6949D1CA034"</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ViewController</span> ()&lt;<span class="title">CBCentralManagerDelegate</span>,<span class="title">CBPeripheralDelegate</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">strong</span>)CBCentralManager * centralManager;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">strong</span>)CBPeripheral     * peripheral;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p></p><h3 id="create">åˆ›å»ºä¸­å¿ƒè§’è‰²</h3><br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#import <span class="title">&lt;CoreBluetooth/CoreBluetooth.h&gt;</span> </span></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åˆå§‹åŒ–è“ç‰™ central manager</span></span><br><span class="line"></span><br><span class="line">    _centralManager = [[CBCentralManager alloc]initWithDelegate:<span class="keyword">self</span> queue:dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, <span class="number">0</span>) options:<span class="literal">nil</span>];    </span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p>
<p></p><h3 id="scan">æ‰«æå¤–è®¾</h3><br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[manager scanForPeripheralsWithServices:<span class="literal">nil</span> options:@&#123;CBCentralManagerRestoredStateScanOptionsKey:@(<span class="literal">YES</span>)&#125;];</span><br></pre></td></tr></table></figure><p></p>
<p></p><h3 id="connect">è¿æ¥å¤–è®¾</h3><br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)centralManager:(CBCentralManager *)central didDiscoverPeripheral:(CBPeripheral *)peripheral advertisementData:(<span class="built_in">NSDictionary</span> *)advertisementData RSSI:(<span class="built_in">NSNumber</span> *)RSSI </span><br><span class="line">&#123;</span><br><span class="line">        <span class="keyword">if</span>([peripheral<span class="variable">.name</span>  isEqualToString:BLE_SERVICE_NAME])&#123;</span><br><span class="line">                [<span class="keyword">self</span> connect:peripheral];</span><br><span class="line">        &#125;</span><br><span class="line">s); </span><br><span class="line">&#125;       </span><br><span class="line"> </span><br><span class="line">-(<span class="built_in">BOOL</span>)connect:(CBPeripheral *)peripheral&#123;</span><br><span class="line">        <span class="keyword">self</span><span class="variable">.manager</span><span class="variable">.delegate</span> = <span class="keyword">self</span>;</span><br><span class="line">        [<span class="keyword">self</span><span class="variable">.manager</span> connectPeripheral:peripheral</span><br><span class="line">                                options:[<span class="built_in">NSDictionary</span> dictionaryWithObject:[<span class="built_in">NSNumber</span> numberWithBool:<span class="literal">YES</span>] forKey:CBConnectPeripheralOptionNotifyOnDisconnectionKey]];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p>
<p></p><h3 id="service">æ‰«æå¤–è®¾ä¸­çš„æœåŠ¡å’Œç‰¹å¾</h3><br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)centralManager:(CBCentralManager *)central didConnectPeripheral:(CBPeripheral *)peripheral </span><br><span class="line">&#123; </span><br><span class="line">       </span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"Did connect to peripheral: %@"</span>, peripheral); </span><br><span class="line">    _testPeripheral = peripheral; </span><br><span class="line">       </span><br><span class="line">    [peripheral setDelegate:<span class="keyword">self</span>];  &lt;br&gt;<span class="comment">//æŸ¥æ‰¾æœåŠ¡</span></span><br><span class="line">    [peripheral discoverServices:<span class="literal">nil</span>]; </span><br><span class="line">       </span><br><span class="line">       </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p>
<p></p><h3 id="find">å‘ç°æœåŠ¡ï¼š</h3><br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)peripheral:(CBPeripheral *)peripheral didDiscoverServices:(<span class="built_in">NSError</span> *)error </span><br><span class="line">&#123; </span><br><span class="line">   </span><br><span class="line">       </span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"didDiscoverServices"</span>); </span><br><span class="line">       </span><br><span class="line">    <span class="keyword">if</span> (error) </span><br><span class="line">    &#123; </span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"Discovered services for %@ with error: %@"</span>, peripheral<span class="variable">.name</span>, [error localizedDescription]); </span><br><span class="line">           </span><br><span class="line">        <span class="keyword">if</span> ([<span class="keyword">self</span><span class="variable">.delegate</span> respondsToSelector:<span class="keyword">@selector</span>(DidNotifyFailConnectService:withPeripheral:error:)]) </span><br><span class="line">            [<span class="keyword">self</span><span class="variable">.delegate</span> DidNotifyFailConnectService:<span class="literal">nil</span> withPeripheral:<span class="literal">nil</span> error:<span class="literal">nil</span>]; </span><br><span class="line">           </span><br><span class="line">        <span class="keyword">return</span>; </span><br><span class="line">    &#125; </span><br><span class="line">       </span><br><span class="line">   </span><br><span class="line">    <span class="keyword">for</span> (CBService *service <span class="keyword">in</span> peripheral<span class="variable">.services</span>) </span><br><span class="line">    &#123; </span><br><span class="line">         <span class="comment">//å‘ç°æœåŠ¡</span></span><br><span class="line">        <span class="keyword">if</span> ([service<span class="variable">.UUID</span> isEqual:[CBU<span class="built_in">UID</span> U<span class="built_in">UIDWithString</span>:U<span class="built_in">UIDSTR_ISSC_PROPRIETARY_SERVICE</span>]]) </span><br><span class="line">        &#123; </span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@"Service found with UUID: %@"</span>, service<span class="variable">.UUID</span>);  &lt;br&gt;<span class="comment">//æŸ¥æ‰¾ç‰¹å¾</span></span><br><span class="line">            [peripheral discoverCharacteristics:<span class="literal">nil</span> forService:service]; </span><br><span class="line">            <span class="keyword">break</span>; </span><br><span class="line">        &#125; </span><br><span class="line">           </span><br><span class="line">           </span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p>
<p></p><h3 id="findChac">å‘ç°æœåŠ¡ä¸­çš„ç‰¹å¾ï¼š</h3><br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)peripheral:(CBPeripheral *)peripheral didDiscoverCharacteristicsForService:(CBService *)service error:(<span class="built_in">NSError</span> *)error</span><br><span class="line">&#123;</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">if</span> (error)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"Discovered characteristics for %@ with error: %@"</span>, service<span class="variable">.UUID</span>, [error localizedDescription]);</span><br><span class="line">         </span><br><span class="line">        [<span class="keyword">self</span> error];</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"æœåŠ¡ï¼š%@"</span>,service<span class="variable">.UUID</span>);</span><br><span class="line">    <span class="keyword">for</span> (CBCharacteristic *characteristic <span class="keyword">in</span> service<span class="variable">.characteristics</span>)</span><br><span class="line">    &#123;</span><br><span class="line">       <span class="comment">//å‘ç°ç‰¹å¾</span></span><br><span class="line">            <span class="keyword">if</span> ([characteristic<span class="variable">.UUID</span> isEqual:[CBU<span class="built_in">UID</span> U<span class="built_in">UIDWithString</span>:<span class="string">@"xxxxxxx"</span>]]) &#123;</span><br><span class="line">                <span class="built_in">NSLog</span>(<span class="string">@"ç›‘å¬ï¼š%@"</span>,characteristic);&lt;br&gt;<span class="comment">//ç›‘å¬ç‰¹å¾</span></span><br><span class="line">                [<span class="keyword">self</span><span class="variable">.peripheral</span> setNotifyValue:<span class="literal">YES</span> forCharacteristic:characteristic];</span><br><span class="line">            &#125;</span><br><span class="line">         </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p>
<p></p><h3 id="interact">ä¸å¤–è®¾è¿›è¡Œæ•°æ®äº¤äº’</h3><br>è¯»å–æ•°æ®ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)peripheral:(CBPeripheral *)peripheral didUpdateValueForCharacteristic:(CBCharacteristic *)characteristic error:(<span class="built_in">NSError</span> *)error</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (error)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"Error updating value for characteristic %@ error: %@"</span>, characteristic<span class="variable">.UUID</span>, [error localizedDescription]);</span><br><span class="line">        <span class="keyword">self</span><span class="variable">.error_b</span> = BluetoothError_System;</span><br><span class="line">        [<span class="keyword">self</span> error];</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line"><span class="comment">//    NSLog(@"æ”¶åˆ°çš„æ•°æ®ï¼š%@",characteristic.value);</span></span><br><span class="line">    [<span class="keyword">self</span> decodeData:characteristic<span class="variable">.value</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>å†™æ•°æ®ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSData</span> *d2 = [[PBABluetoothDecode sharedManager] HexStringTo<span class="built_in">NSData</span>:<span class="string">@"0x02"</span>];</span><br><span class="line">                [<span class="keyword">self</span><span class="variable">.peripheral</span> writeValue:d2 forCharacteristic:characteristic type:CBCharacteristicWriteWithoutResponse];</span><br></pre></td></tr></table></figure><p></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>iOS è“ç‰™4.0å¼€å‘</p>
<h2>èƒŒæ™¯ï¼š</h2><br>1.iOSçš„è“ç‰™ä¸èƒ½ç”¨æ¥ä¼ è¾“æ–‡ä»¶ã€‚<br>2.iOSä¸iOSè®¾å¤‡ä¹‹é—´è¿›è¡Œæ•°æ®é€šä¿¡ï¼Œä½¿ç”¨gameKit.framework<br>3.iOSä¸å…¶ä»–éiOSè®¾å¤‡è¿›è¡Œæ•°æ®é€šä¿¡ï¼Œä½¿ç”¨coreBluetooth.framework<br><br>]]>
    
    </summary>
    
      <category term="CoreBluetooth" scheme="http://koalahl.github.io/tags/CoreBluetooth/"/>
    
      <category term="è“ç‰™" scheme="http://koalahl.github.io/tags/%E8%93%9D%E7%89%99/"/>
    
      <category term="iOS" scheme="http://koalahl.github.io/categories/iOS/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[SDWebImageå†…éƒ¨å®ç°è¿‡ç¨‹]]></title>
    <link href="http://koalahl.github.io/2016/03/08/SDWebImage%E5%86%85%E9%83%A8%E5%AE%9E%E7%8E%B0%E8%BF%87%E7%A8%8B/"/>
    <id>http://koalahl.github.io/2016/03/08/SDWebImageå†…éƒ¨å®ç°è¿‡ç¨‹/</id>
    <published>2016-03-08T12:15:14.000Z</published>
    <updated>2016-03-08T12:15:14.000Z</updated>
    <content type="html"><![CDATA[<p>SDWebImageå†…éƒ¨å®ç°è¿‡ç¨‹(æ–°ç‰ˆæœ¬åœ¨å„æ–¹æ³•å‰åŠ ä¸Šäº†sd_å‰ç¼€ï¼Œä»¥åŒºåˆ†UIImageView+AFNetworkingä¸­çš„æ–¹æ³•)</p>
<a id="more"></a>
<p>1.å…¥å£ <code>setImageWithURL:placeholderImage:options:</code>ä¼šå…ˆæŠŠ placeholderImage æ˜¾ç¤ºï¼Œç„¶å SDWebImageManager æ ¹æ® URL å¼€å§‹å¤„ç†å›¾ç‰‡ã€‚</p>
<p>2.è¿›å…¥ SDWebImageManager-<code>downloadWithURL:delegate:options:userInfo:</code>ï¼Œäº¤ç»™ SDImageCache ä»ç¼“å­˜æŸ¥æ‰¾å›¾ç‰‡æ˜¯å¦å·²ç»ä¸‹è½½ <code>queryDiskCacheForKey:delegate:userInfo:</code>.</p>
<p>3.å…ˆä»å†…å­˜å›¾ç‰‡ç¼“å­˜æŸ¥æ‰¾æ˜¯å¦æœ‰å›¾ç‰‡ï¼Œå¦‚æœå†…å­˜ä¸­å·²ç»æœ‰å›¾ç‰‡ç¼“å­˜ï¼ŒSDImageCacheDelegate å›è°ƒ <code>imageCache:didFindImage:forKey:userInfo:</code> åˆ° SDWebImageManagerã€‚</p>
<p>4.SDWebImageManagerDelegate å›è°ƒ <code>webImageManager:didFinishWithImage:</code>åˆ° UIImageView+WebCache ç­‰å‰ç«¯å±•ç¤ºå›¾ç‰‡ã€‚</p>
<p>5.å¦‚æœå†…å­˜ç¼“å­˜ä¸­æ²¡æœ‰ï¼Œç”Ÿæˆ NSInvocationOperation æ·»åŠ åˆ°é˜Ÿåˆ—å¼€å§‹ä»ç¡¬ç›˜æŸ¥æ‰¾å›¾ç‰‡æ˜¯å¦å·²ç»ç¼“å­˜ã€‚</p>
<p>6.æ ¹æ® URLKey åœ¨ç¡¬ç›˜ç¼“å­˜ç›®å½•ä¸‹å°è¯•è¯»å–å›¾ç‰‡æ–‡ä»¶ã€‚è¿™ä¸€æ­¥æ˜¯åœ¨ NSOperation è¿›è¡Œçš„æ“ä½œï¼Œæ‰€ä»¥å›ä¸»çº¿ç¨‹è¿›è¡Œç»“æœå›è°ƒ notifyDelegate:ã€‚</p>
<p>7.å¦‚æœä¸Šä¸€æ“ä½œä»ç¡¬ç›˜è¯»å–åˆ°äº†å›¾ç‰‡ï¼Œå°†å›¾ç‰‡æ·»åŠ åˆ°å†…å­˜ç¼“å­˜ä¸­ï¼ˆå¦‚æœç©ºé—²å†…å­˜è¿‡å°ï¼Œä¼šå…ˆæ¸…ç©ºå†…å­˜ç¼“å­˜ï¼‰ã€‚SDImageCacheDelegate å›è°ƒ <code>imageCache:didFindImage:forKey:userInfo:</code>ã€‚è¿›è€Œå›è°ƒå±•ç¤ºå›¾ç‰‡ã€‚</p>
<p>8.å¦‚æœä»ç¡¬ç›˜ç¼“å­˜ç›®å½•è¯»å–ä¸åˆ°å›¾ç‰‡ï¼Œè¯´æ˜æ‰€æœ‰ç¼“å­˜éƒ½ä¸å­˜åœ¨è¯¥å›¾ç‰‡ï¼Œéœ€è¦ä¸‹è½½å›¾ç‰‡ï¼Œå›è°ƒ <code>imageCache:didNotFindImageForKey:userInfo:</code>ã€‚</p>
<p>9.å…±äº«æˆ–é‡æ–°ç”Ÿæˆä¸€ä¸ªä¸‹è½½å™¨ SDWebImageDownloader å¼€å§‹ä¸‹è½½å›¾ç‰‡ã€‚</p>
<p>10.å›¾ç‰‡ä¸‹è½½ç”± NSURLConnection æ¥åšï¼Œå®ç°ç›¸å…³ delegate æ¥åˆ¤æ–­å›¾ç‰‡ä¸‹è½½ä¸­ã€ä¸‹è½½å®Œæˆå’Œä¸‹è½½å¤±è´¥ã€‚</p>
<p>11.<code>connection:didReceiveData:</code>ä¸­åˆ©ç”¨ ImageIO åšäº†æŒ‰å›¾ç‰‡ä¸‹è½½è¿›åº¦åŠ è½½æ•ˆæœã€‚</p>
<p>12.<code>connectionDidFinishLoading:</code>æ•°æ®ä¸‹è½½å®Œæˆåäº¤ç»™ SDWebImageDecoder åšå›¾ç‰‡è§£ç å¤„ç†ã€‚</p>
<p>13.å›¾ç‰‡è§£ç å¤„ç†åœ¨ä¸€ä¸ª NSOperationQueue å®Œæˆï¼Œä¸ä¼šæ‹–æ…¢ä¸»çº¿ç¨‹ UIã€‚å¦‚æœæœ‰éœ€è¦å¯¹ä¸‹è½½çš„å›¾ç‰‡è¿›è¡ŒäºŒæ¬¡å¤„ç†ï¼Œæœ€å¥½ä¹Ÿåœ¨è¿™é‡Œå®Œæˆï¼Œæ•ˆç‡ä¼šå¥½å¾ˆå¤šã€‚</p>
<p>14.åœ¨ä¸»çº¿ç¨‹ <code>notifyDelegateOnMainThreadWithInfo:</code> å®£å‘Šè§£ç å®Œæˆï¼Œ<code>imageDecoder:didFinishDecodingImage:userInfo:</code> å›è°ƒç»™ SDWebImageDownloaderã€‚</p>
<p>15.<code>imageDownloader:didFinishWithImage:</code> å›è°ƒç»™ SDWebImageManager å‘ŠçŸ¥å›¾ç‰‡ä¸‹è½½å®Œæˆã€‚</p>
<p>16.é€šçŸ¥æ‰€æœ‰çš„ downloadDelegates ä¸‹è½½å®Œæˆï¼Œå›è°ƒç»™éœ€è¦çš„åœ°æ–¹å±•ç¤ºå›¾ç‰‡ã€‚</p>
<p>17.å°†å›¾ç‰‡ä¿å­˜åˆ° SDImageCache ä¸­ï¼Œå†…å­˜ç¼“å­˜å’Œç¡¬ç›˜ç¼“å­˜åŒæ—¶ä¿å­˜ã€‚å†™æ–‡ä»¶åˆ°ç¡¬ç›˜ä¹Ÿåœ¨ä»¥å•ç‹¬ NSInvocationOperation å®Œæˆï¼Œé¿å…æ‹–æ…¢ä¸»çº¿ç¨‹ã€‚</p>
<p>18.SDImageCache åœ¨åˆå§‹åŒ–çš„æ—¶å€™ä¼šæ³¨å†Œä¸€äº›æ¶ˆæ¯é€šçŸ¥ï¼Œåœ¨å†…å­˜è­¦å‘Šæˆ–é€€åˆ°åå°çš„æ—¶å€™æ¸…ç†å†…å­˜å›¾ç‰‡ç¼“å­˜ï¼Œåº”ç”¨ç»“æŸçš„æ—¶å€™æ¸…ç†è¿‡æœŸå›¾ç‰‡ã€‚</p>
<p>19.SDWI ä¹Ÿæä¾›äº† UIButton+WebCache å’Œ MKAnnotationView+WebCacheï¼Œæ–¹ä¾¿ä½¿ç”¨ã€‚</p>
<p>20.SDWebImagePrefetcher å¯ä»¥é¢„å…ˆä¸‹è½½å›¾ç‰‡ï¼Œæ–¹ä¾¿åç»­ä½¿ç”¨ã€‚</p>
<p>ä»ä¸Šé¢æµç¨‹å¯ä»¥çœ‹å‡ºï¼Œå½“ä½ è°ƒç”¨setImageWithURL:æ–¹æ³•çš„æ—¶å€™ï¼Œä»–ä¼šè‡ªåŠ¨å»ç»™ä½ å¹²è¿™ä¹ˆå¤šäº‹ï¼Œå½“ä½ éœ€è¦åœ¨æŸä¸€å…·ä½“æ—¶åˆ»åšäº‹æƒ…çš„æ—¶å€™ï¼Œä½ å¯ä»¥è¦†ç›–è¿™äº›æ–¹æ³•ã€‚æ¯”å¦‚åœ¨ä¸‹è½½æŸä¸ªå›¾ç‰‡çš„è¿‡ç¨‹ä¸­è¦å“åº”ä¸€ä¸ªäº‹ä»¶ï¼Œå°±è¦†ç›–è¿™ä¸ªæ–¹æ³•ï¼š</p>
<p>è¦†ç›–æ–¹æ³•ï¼ŒæŒ‡å“ªæ‰“å“ªï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯ä¸‹è½½imagePath2çš„æ—¶å€™å“åº”<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">SDWebImageManager *manager = [SDWebImageManager sharedManager];</span><br><span class="line"> </span><br><span class="line">[manager downloadImageWithURL:imagePath2 options:SDWebImageRetryFailed progress:^(<span class="built_in">NSInteger</span> receivedSize, <span class="built_in">NSInteger</span> expectedSize) &#123;</span><br><span class="line">     </span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"æ˜¾ç¤ºå½“å‰è¿›åº¦"</span>);</span><br><span class="line">     </span><br><span class="line">&#125; completed:^(<span class="built_in">UIImage</span> *image, <span class="built_in">NSError</span> *error, SDImageCacheType cacheType, <span class="built_in">BOOL</span> finished, <span class="built_in">NSURL</span> *imageURL) &#123;</span><br><span class="line">     </span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"ä¸‹è½½å®Œæˆ"</span>);</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure></p>
<p>å½“æœåŠ¡å™¨æ›´æ–°äº†æŸä¸€å¼ å›¾ç‰‡èµ„æºæ—¶ï¼Œå®¢æˆ·ç«¯éœ€è¦é‡æ–°åŠ è½½ï¼Œé‚£ä¹ˆå°±å¯ä»¥è®¾ç½®SDWebImageOptionä¸ºSDWebImageRefreshCachedï¼›é™„ä¸Šå…¨éƒ¨çš„SDWebImageOptionsï¼š<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">NS_OPTIONS</span><span class="params">(NSUInteger, SDWebImageOptions)</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * By default, when a URL fail to be downloaded, the URL is blacklisted so the library won't keep trying.</span><br><span class="line">     * This flag disable this blacklisting.</span><br><span class="line">     */</span></span><br><span class="line">    SDWebImageRetryFailed = <span class="number">1</span> &lt;&lt; <span class="number">0</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * By default, image downloads are started during UI interactions, this flags disable this feature,</span><br><span class="line">     * leading to delayed download on UIScrollView deceleration for instance.</span><br><span class="line">     */</span></span><br><span class="line">    SDWebImageLowPriority = <span class="number">1</span> &lt;&lt; <span class="number">1</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * This flag disables on-disk caching</span><br><span class="line">     */</span></span><br><span class="line">    SDWebImageCacheMemoryOnly = <span class="number">1</span> &lt;&lt; <span class="number">2</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * This flag enables progressive download, the image is displayed progressively during download as a browser would do.</span><br><span class="line">     * By default, the image is only displayed once completely downloaded.</span><br><span class="line">     */</span></span><br><span class="line">    SDWebImageProgressiveDownload = <span class="number">1</span> &lt;&lt; <span class="number">3</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * Even if the image is cached, respect the HTTP response cache control, and refresh the image from remote location if needed.</span><br><span class="line">     * The disk caching will be handled by NSURLCache instead of SDWebImage leading to slight performance degradation.</span><br><span class="line">     * This option helps deal with images changing behind the same request URL, e.g. Facebook graph api profile pics.</span><br><span class="line">     * If a cached image is refreshed, the completion block is called once with the cached image and again with the final image.</span><br><span class="line">     *</span><br><span class="line">     * Use this flag only if you can't make your URLs static with embeded cache busting parameter.</span><br><span class="line">     */</span></span><br><span class="line">    SDWebImageRefreshCached = <span class="number">1</span> &lt;&lt; <span class="number">4</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * In iOS 4+, continue the download of the image if the app goes to background. This is achieved by asking the system for</span><br><span class="line">     * extra time in background to let the request finish. If the background task expires the operation will be cancelled.</span><br><span class="line">     */</span></span><br><span class="line">    SDWebImageContinueInBackground = <span class="number">1</span> &lt;&lt; <span class="number">5</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * Handles cookies stored in NSHTTPCookieStore by setting</span><br><span class="line">     * NSMutableURLRequest.HTTPShouldHandleCookies = YES;</span><br><span class="line">     */</span></span><br><span class="line">    SDWebImageHandleCookies = <span class="number">1</span> &lt;&lt; <span class="number">6</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * Enable to allow untrusted SSL ceriticates.</span><br><span class="line">     * Useful for testing purposes. Use with caution in production.</span><br><span class="line">     */</span></span><br><span class="line">    SDWebImageAllowInvalidSSLCertificates = <span class="number">1</span> &lt;&lt; <span class="number">7</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * By default, image are loaded in the order they were queued. This flag move them to</span><br><span class="line">     * the front of the queue and is loaded immediately instead of waiting for the current queue to be loaded (which </span><br><span class="line">     * could take a while).</span><br><span class="line">     */</span></span><br><span class="line">    SDWebImageHighPriority = <span class="number">1</span> &lt;&lt; <span class="number">8</span>,</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * By default, placeholder images are loaded while the image is loading. This flag will delay the loading</span><br><span class="line">     * of the placeholder image until after the image has finished loading.</span><br><span class="line">     */</span></span><br><span class="line">    SDWebImageDelayPlaceholder = <span class="number">1</span> &lt;&lt; <span class="number">9</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * We usually don't call transformDownloadedImage delegate method on animated images,</span><br><span class="line">     * as most transformation code would mangle it.</span><br><span class="line">     * Use this flag to transform them anyway.</span><br><span class="line">     */</span></span><br><span class="line">    SDWebImageTransformAnimatedImage = <span class="number">1</span> &lt;&lt; <span class="number">10</span>,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>SDWebImageå†…éƒ¨å®ç°è¿‡ç¨‹(æ–°ç‰ˆæœ¬åœ¨å„æ–¹æ³•å‰åŠ ä¸Šäº†sd_å‰ç¼€ï¼Œä»¥åŒºåˆ†UIImageView+AFNetworkingä¸­çš„æ–¹æ³•)</p>]]>
    
    </summary>
    
      <category term="SDWebImage" scheme="http://koalahl.github.io/tags/SDWebImage/"/>
    
      <category term="iOS" scheme="http://koalahl.github.io/categories/iOS/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[QRCodeä¸Core Image]]></title>
    <link href="http://koalahl.github.io/2016/03/05/QRCode%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B%E5%84%BF/"/>
    <id>http://koalahl.github.io/2016/03/05/QRCodeçš„é‚£äº›äº‹å„¿/</id>
    <published>2016-03-05T14:31:06.000Z</published>
    <updated>2016-03-05T14:31:06.000Z</updated>
    <content type="html"><![CDATA[<p>ç½‘ä¸Šå·²ç»æœ‰å¾ˆå¤šå…³äºäºŒç»´ç æ–¹é¢çš„æ–‡ç« äº†ï¼Œå†™è¿™ç¯‡æ–‡ç« çš„ç›®çš„æ˜¯å› ä¸ºè¦è®°å½•ä¸€ä¸ªå…³äºä¿å­˜äºŒç»´ç å›¾ç‰‡åˆ°ç›¸å†Œçš„é—®é¢˜ï¼Œé¡ºä¾¿å›é¡¾ä¸€ä¸‹iOSå¼€å‘ä¸­ä½¿ç”¨äºŒç»´ç çš„å†å²ã€‚å¥½äº†ï¼ŒåºŸè¯å°‘è¯´ï¼Œè®©æˆ‘ä»¬å¼€å§‹å§ï¼</p>
<h2>è¦è®¨è®ºçš„é—®é¢˜</h2><br>åœ¨å‚è€ƒ<a href="http://www.appcoda.com/qr-code-generator-tutorial/" target="_blank" rel="external">Building a QR Code Generator with Core Image Filters</a>è¿™ç¯‡æ–‡ç« ï¼Œå®Œæˆäº†äºŒç»´ç ç”Ÿæˆçš„æ —å­ã€‚<br>äºŒç»´ç çš„æ‰«æåˆ™æ˜¯ç”¨äº†AVFoundationæ¡†æ¶æ¥ç¼–å†™çš„<a href="https://github.com/koalahl/HLQRCode" target="_blank" rel="external">GithubÂ·HLQRCode</a>ã€‚æœ€åæƒ³æŠŠç”Ÿæˆçš„äºŒç»´ç å›¾ç‰‡ä¿å­˜åˆ°ç›¸å†Œä¸­å´æ²¡æœ‰æˆåŠŸã€‚<br>å‚è€ƒäº†ç½‘ä¸Šçš„ä»£ç ï¼Œä½¿ç”¨äº†CIImag-&gt;CGImage-&gt;writeImageToAlbumçš„æ–¹å¼ã€‚<br><br><a id="more"></a><br>ä»£ç å¦‚ä¸‹ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">CIContext</span> * context = [<span class="built_in">CIContext</span> contextWithOptions:<span class="literal">nil</span>];</span><br><span class="line"><span class="built_in">CGImageRef</span> cgimg = [context create<span class="built_in">CGImage</span>:<span class="keyword">self</span><span class="variable">.qrcodeImg</span> fromRect:[<span class="keyword">self</span><span class="variable">.qrcodeImg</span> extent] ];</span><br><span class="line"></span><br><span class="line">ALAssetsLibrary *library = [[ALAssetsLibrary alloc] init];</span><br><span class="line">[library writeImageToSavedPhotosAlbum:cgimg metadata:[<span class="keyword">self</span><span class="variable">.qrcodeImg</span> properties] completionBlock:^(<span class="built_in">NSURL</span> *assetURL, <span class="built_in">NSError</span> *error) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(error != <span class="literal">NULL</span>)&#123;</span><br><span class="line">        msg = <span class="string">@"ä¿å­˜å›¾ç‰‡å¤±è´¥"</span> ;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>,assetURL);</span><br><span class="line">        msg = <span class="string">@"ä¿å­˜å›¾ç‰‡æˆåŠŸ"</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">UIAlertView</span> *alert = [[<span class="built_in">UIAlertView</span> alloc] initWithTitle:<span class="literal">nil</span></span><br><span class="line">                                                    message:msg</span><br><span class="line">                                                   delegate:<span class="keyword">self</span></span><br><span class="line">                                          cancelButtonTitle:<span class="string">@"ç¡®å®š"</span></span><br><span class="line">                                          otherButtonTitles:<span class="literal">nil</span>];</span><br><span class="line">    </span><br><span class="line">    [alert show];</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure><br><br>ä½†æ˜¯è¿™æ ·æ— è®ºæ€ä¹ˆæ ·éƒ½æ— æ³•åœ¨ç›¸å†Œä¸­çœ‹åˆ°ä¿å­˜çš„äºŒç»´ç å›¾ç‰‡ã€‚è¿˜æŠ¥é”™<code>message &quot;BSXPCMessage received error for message: Connection interrupted&quot;</code>ã€‚å¯¹æ¯”å‚è€ƒçš„ä»£ç éƒ½æ˜¯ä¸€æ ·çš„ï¼Œå´æ‰¾ä¸å‡ºåŸå› ã€‚æˆ‘å°±åœ¨æ–‡ç« è¯„è®ºä¸­ç•™è¨€é—®äº†è¿™ä¸ªé—®é¢˜ï¼Œåæ¥ä¸€ä¸ªæœ‹å‹æå‡ºäº†è§£å†³æ–¹æ¡ˆï¼Œä»”ç»†ä¸€çœ‹é¡¿æ—¶æç„¶å¤§æ‚Ÿã€‚<br><br><h2>è§£å†³æ–¹å¼åŠè¦ç‚¹</h2>

<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">CIContext</span> * context = [<span class="built_in">CIContext</span> contextWithOptions:@&#123;k<span class="built_in">CIContextUseSoftwareRenderer</span>:@YES&#125;];</span><br></pre></td></tr></table></figure>
<p>çœ‹åˆ°åŒºåˆ«äº†å—ï¼Ÿæ˜¯çš„ï¼Œå¤šäº†ä¸€ä¸ªoptionå‚æ•°<code>kCIContextUseSoftwareRenderer</code>.ç„¶ååœ¨development docä¸­æŸ¥çœ‹äº†å…³äº<code>contextWithOptions</code>æ–¹æ³•çš„æè¿°ï¼š<br>contextWithOptions:<br><blockquote><p>You can create a CPU-based context by providing the key kCIContextUseSoftwareRenderer. A CPU-based context supports larger input and output images than a GPU-based context. It also allows your app to perform processing in the background, such as when saving the rendered output to the Photo Library.</p>
<p>GPU rendering is faster than CPU rendering, but the resulting image is not displayed on the device until after is it copied to CPU memory and converted to another image type, such as a UIImage object.</p>
<footer><strong>@Apple Development Doc</strong><cite><a href="https://developer.apple.com/library/prerelease/ios/documentation/GraphicsImaging/Reference/QuartzCoreFramework/Classes/CIContext_Class/index.html#//apple_ref/occ/clm/CIContext/contextWithOptions:" target="_blank" rel="external">developer.apple.com/library/prerelease/ios/documentation/GraphicsImaging/Reference/QuartzCoreFramework/Classes/CIContext_Class/index.html#//apple_ref/occ/clm/CIContext/contextWithOptions:</a></cite></footer></blockquote></p>
<p>é¡¿æ—¶è§‰å¾—è‡ªå·±å½“æ—¶å¥½ç¬¨ï¼Œéƒ½æ²¡æœ‰æƒ³åˆ°å»æŸ¥ä¸€ä¸‹å¼€å‘æ–‡æ¡£ã€‚o(â•¯â–¡â•°)o</p>
<ul>
<li>NSString *kCIContextOutputColorSpace;       - A key for the color space to use for images before they are rendered to the context. ä½¿ç”¨OpenGLES</li>
<li>NSString *kCIContextWorkingColorSpace;      - A key for the color space to use for image operations. ä½¿ç”¨OpenGLES</li>
<li>NSString *kCIContextUseSoftwareRenderer;    - A key for enabling software renderer use. If the associated NSNumber object is YES, then the software renderer is required. ä½¿ç”¨CPU</li>
<li>NSString *kCIContextPriorityRequestLow;     - A key for enabling low-priority GPU use.</li>
<li>NSString *kCIContextWorkingFormat;          - An option for the color format to use for intermediate results when rendering with the context.</li>
</ul>
<p><code>contextWithOptions</code>æ–¹æ³•é»˜è®¤æ˜¯åœ¨GPUä¸Šå¤„ç†å›¾åƒã€‚æ ¹æ®ä¸åŒçš„å‚æ•°è®¾ç½®ä¸åŒçš„å¤„ç†æ–¹å¼ã€‚<br>ä»¥ä¸Šè¿™äº›å…¶å®ä¸æ˜¯å¾ˆç†è§£ï¼Œå›§ã€‚å…·ä½“å‚è€ƒ<a href="https://developer.apple.com/library/prerelease/ios/documentation/GraphicsImaging/Reference/QuartzCoreFramework/Classes/CIContext_Class/index.html#//apple_ref/doc/constant_group/Context_Options" target="_blank" rel="external">Context Options</a></p>
<p></p><h2>äºŒç»´ç çš„å†å²</h2><br>åœ¨iOS7ä»¥å‰ï¼ŒiOSå¼€å‘ä½¿ç”¨äºŒç»´ç éƒ½æ˜¯ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ã€‚æ¯”è¾ƒæµè¡Œçš„å°±æ˜¯<code>ZXing</code>å’Œ<code>Zbar</code>äº†ã€‚<br>ä¸è¯´å®ƒä»¬çš„å®ç°åŸç†äº†ï¼Œé‡åˆ°æœ€å¤šçš„é—®é¢˜å°±æ˜¯ä¸å…¶ä»–ç¬¬ä¸‰æ–¹åº“ï¼ˆæ¯”å¦‚æ”¯ä»˜å®SDKï¼Œç™¾åº¦åœ°å›¾SDKï¼‰ç»§æ‰¿åœ¨ä¸€èµ·æ—¶å‡ºç°duplicate symboläº†ã€‚è§£å†³æ–¹æ³•ä¹Ÿå¾ˆéº»çƒ¦ï¼šä¿®æ”¹æºç ï¼Œé‡æ–°ç¼–è¯‘é™æ€åº“.aæ–‡ä»¶ã€‚<p></p>
<p>ä¸è¿‡ç°åœ¨å¾ˆå°‘ç”¨åˆ°äºŒç»´ç äº†ï¼Œè¦ç”¨ä¹Ÿè¦ç”¨ç³»ç»Ÿè‡ªå¸¦çš„æ¡†æ¶å“Ÿ~ï¼</p>
<p></p><h2>æ€»ç»“</h2><br>1.é‡åˆ°é—®é¢˜å…ˆæŸ¥çœ‹å¼€å‘æ–‡æ¡£ï¼Œå†Googleï¼<br>2.ç ”ç©¶é—®é¢˜è¦æ·±å…¥ï¼<br>åé¢å­¦ä¹ ä¸€ä¸‹Core Imageçš„ä¸œè¥¿ï¼Œè¿˜æœ‰ä¸ä¹‹çš„GPUImageåº“ï¼<p></p>
<p></p><h2>å‚è€ƒæ–‡ç« </h2><br><a href="https://developer.apple.com/library/prerelease/ios/documentation/GraphicsImaging/Conceptual/CoreImaging/ci_intro/ci_intro.html#//apple_ref/doc/uid/TP30001185" target="_blank" rel="external">Core Image Programming Guide</a><br><a href="http://stackoverflow.com/questions/26065808/bsxpcmessage-received-error-for-message-connection-interrupted/29872829#29872829" target="_blank" rel="external">BSXPCMessage received error for message: Connection interrupted</a><p></p>
<div align="center"><br>    <img src="http://i3.sinaimg.cn/edu/2015/0724/U1151P42DT20150724094518.jpg" alt="girl"><br></div>
]]></content>
    <summary type="html">
    <![CDATA[<p>ç½‘ä¸Šå·²ç»æœ‰å¾ˆå¤šå…³äºäºŒç»´ç æ–¹é¢çš„æ–‡ç« äº†ï¼Œå†™è¿™ç¯‡æ–‡ç« çš„ç›®çš„æ˜¯å› ä¸ºè¦è®°å½•ä¸€ä¸ªå…³äºä¿å­˜äºŒç»´ç å›¾ç‰‡åˆ°ç›¸å†Œçš„é—®é¢˜ï¼Œé¡ºä¾¿å›é¡¾ä¸€ä¸‹iOSå¼€å‘ä¸­ä½¿ç”¨äºŒç»´ç çš„å†å²ã€‚å¥½äº†ï¼ŒåºŸè¯å°‘è¯´ï¼Œè®©æˆ‘ä»¬å¼€å§‹å§ï¼</p>
<h2>è¦è®¨è®ºçš„é—®é¢˜</h2><br>åœ¨å‚è€ƒ<a href="http://www.appcoda.com/qr-code-generator-tutorial/">Building a QR Code Generator with Core Image Filters</a>è¿™ç¯‡æ–‡ç« ï¼Œå®Œæˆäº†äºŒç»´ç ç”Ÿæˆçš„æ —å­ã€‚<br>äºŒç»´ç çš„æ‰«æåˆ™æ˜¯ç”¨äº†AVFoundationæ¡†æ¶æ¥ç¼–å†™çš„<a href="https://github.com/koalahl/HLQRCode">GithubÂ·HLQRCode</a>ã€‚æœ€åæƒ³æŠŠç”Ÿæˆçš„äºŒç»´ç å›¾ç‰‡ä¿å­˜åˆ°ç›¸å†Œä¸­å´æ²¡æœ‰æˆåŠŸã€‚<br>å‚è€ƒäº†ç½‘ä¸Šçš„ä»£ç ï¼Œä½¿ç”¨äº†CIImag-&gt;CGImage-&gt;writeImageToAlbumçš„æ–¹å¼ã€‚<br><br>]]>
    
    </summary>
    
      <category term="AVFoundation" scheme="http://koalahl.github.io/tags/AVFoundation/"/>
    
      <category term="CoreImage" scheme="http://koalahl.github.io/tags/CoreImage/"/>
    
      <category term="QRCode" scheme="http://koalahl.github.io/tags/QRCode/"/>
    
      <category term="iOS" scheme="http://koalahl.github.io/categories/iOS/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Xibä¸ä¹‹å…³è”çš„è‡ªå®šä¹‰Class]]></title>
    <link href="http://koalahl.github.io/2016/03/04/Xib%E4%B8%8E%E4%B9%8B%E5%85%B3%E8%81%94%E7%9A%84%E8%87%AA%E5%AE%9A%E4%B9%89Class/"/>
    <id>http://koalahl.github.io/2016/03/04/Xibä¸ä¹‹å…³è”çš„è‡ªå®šä¹‰Class/</id>
    <published>2016-03-04T01:37:46.000Z</published>
    <updated>2017-08-18T09:25:54.000Z</updated>
    <content type="html"><![CDATA[<p>æœ€è¿‘é‡åˆ°äº†ä¸€ä¸ªé—®é¢˜ï¼šç‚¹å‡»ã€çŒœä½ å–œæ¬¢ã€‘è§†å›¾è¿›å…¥å•†å“è¯¦æƒ…åï¼Œå†è¿”å›åˆ°é¦–é¡µæ—¶ï¼Œæ²¡æœ‰åŸå…ˆçš„æ•°æ®äº†ã€‚</p>
<a id="more"></a>
<p> <img src="/img/è¢«æ–°ç”Ÿæˆçš„viewè¦†ç›–.png" width="300" height="588" alt="è¢«æ–°ç”Ÿæˆçš„viewè¦†ç›–" align="center"><br>æ‰“å¼€Revealçœ‹äº†ä¸‹å±‚çº§å…³ç³»ï¼ŒåŸæ¥æ˜¯è¢«äºŒæ¬¡ç”Ÿæˆçš„ç•Œé¢è¦†ç›–äº†ã€‚å†ç»†çœ‹ä¸€ä¸‹ï¼Œä¸Šé¢çš„è§†å›¾éƒ½è¢«äºŒæ¬¡ç”Ÿæˆäº†ã€‚çœŸæ˜¯å“”äº†ç‹—äº†ï¼<br><img src="/img/reveal view UI hierarchy 2.png" alt="reveal view UI hierarchy"><br><img src="/img/reveal view UI hierarchy.png" alt="reveal view UI hierarchy"></p>
<p></p><h2><code>drawRect</code>æ–¹æ³•</h2><br>å¥½å§ï¼Œä¿®æ”¹ä»£ç å§ã€‚å› ä¸ºè¿™äº›è§†å›¾éƒ½æ˜¯åœ¨xibä¸Šåˆ›å»ºå¥½äº†ï¼Œå¦å¤–æ–°å»ºäº†ä¸ä¹‹å¯¹åº”çš„è‡ªå®šä¹‰ç±»ï¼Œæ‰€ä»¥éƒ½ç›´æ¥ç”¨çš„<code>drawRect</code>æ–¹æ³•å»åˆå§‹åŒ–UIå…ƒç´ ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- (void)drawRect:(CGRect)rect &#123;&#10;&#10;    [self initSubViews];&#10;&#125;</span><br></pre></td></tr></table></figure><p></p>
<blockquote><p>The default implementation of this method does nothing. Subclasses that use technologies such as Core Graphics and UIKit to draw their viewâ€™s content should override this method and implement their drawing code there. You do not need to override this method if your view sets its content in other ways. For example, you do not need to override this method if your view just displays a background color or if your view sets its content directly using the underlying layer object.</p>
<p>If you subclass UIView directly, your implementation of this method does not need to call super. However, if you are subclassing a different view class, you should call super at some point in your implementation.<br>This method is called when a view is first displayed or when an event occurs that invalidates a visible part of the view. You should never call this method directly yourself. To invalidate part of your view, and thus cause that portion to be redrawn, call the setNeedsDisplay or setNeedsDisplayInRect: method instead.</p>
<footer><strong>@Apple Develop</strong><cite><a href="https://developer.apple.com/library/prerelease/ios/documentation/UIKit/Reference/UIView_Class/index.html#//apple_ref/swift/instm/UIView/c:objc(cs)UIView(im)drawRect:" target="_blank" rel="external">developer.apple.com/library/prerelease/ios/documentation/UIKit/Reference/UIView_Class/index.html#//apple_ref/swift/instm/UIView/c:objc(cs)UIView(im)drawRect:</a></cite></footer></blockquote>
<p>è¿™é‡Œå°±å‡ºç°äº†é—®é¢˜ã€‚åœ¨æ¯æ¬¡é‡æ–°è¿”å›åˆ°é¦–é¡µåï¼Œ<code>drawRect</code>æ–¹æ³•åˆè¢«é‡æ–°è°ƒç”¨äº†ä¸€æ¬¡ï¼Œæ‰€ä»¥ç”Ÿæˆäº†æ–°çš„è§†å›¾è¦†ç›–äº†åŸæ¥çš„è§†å›¾ï¼Œä½†æ˜¯åˆæ²¡æœ‰è¯·æ±‚æ•°æ®ï¼Œæ‰€ä»¥å°±çœ‹ä¸åˆ°äº†ã€‚<br><blockquote><p>drawRectæ–¹æ³•åªè¢«é‡æ–°è°ƒç”¨äº†ä¸€æ¬¡ï¼Œåœ¨è¿™ä¹‹åå°±ä¸ä¼šå†è¢«è°ƒç”¨ã€‚</p>
</blockquote></p>
<p>å› ä¸ºä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘å°±ä¸ç”¨<code>drawRect</code>å»åˆå§‹åŒ–é¡µé¢å…ƒç´ äº†ï¼Œè€Œæ˜¯ç”¨äº†<code>initWithCorder</code>æ–¹æ³•ã€‚<br>æ³¨æ„å› ä¸ºè§†å›¾æ˜¯è¢«ç›´æ¥åˆ›å»ºåœ¨xibä¸Šçš„ï¼Œå¹¶æ²¡æœ‰æ‰§è¡Œ<code>initWithFrame</code>æ–¹æ³•ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- (instancetype)initWithCoder:(NSCoder *)aDecoder&#123;&#10;    self = [super initWithCoder:aDecoder];&#10;    if (self) &#123;&#10;        [self initSubViews];&#10;    &#125;&#10;&#10;    return self;&#10;&#125;</span><br></pre></td></tr></table></figure>
<p></p><h2>æ€»ç»“</h2><br>1.å°½é‡ä¸è¦ä½¿ç”¨drawRectæ–¹æ³•ï¼Œæ€§èƒ½ä¸‹é™å‰å®³æ’’ã€‚<br>2.å·²ç»åœ¨xibä¸Šåˆ›å»ºçš„è§†å›¾ï¼Œä¸å…¶å…³è”çš„å­ç±»ä¸­<code>initWithFrame</code>æ–¹æ³•ä¸ä¼šè¢«è°ƒç”¨ã€‚<p></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>æœ€è¿‘é‡åˆ°äº†ä¸€ä¸ªé—®é¢˜ï¼šç‚¹å‡»ã€çŒœä½ å–œæ¬¢ã€‘è§†å›¾è¿›å…¥å•†å“è¯¦æƒ…åï¼Œå†è¿”å›åˆ°é¦–é¡µæ—¶ï¼Œæ²¡æœ‰åŸå…ˆçš„æ•°æ®äº†ã€‚</p>]]>
    
    </summary>
    
      <category term="drawRect" scheme="http://koalahl.github.io/tags/drawRect/"/>
    
      <category term="xib" scheme="http://koalahl.github.io/tags/xib/"/>
    
      <category term="iOS" scheme="http://koalahl.github.io/categories/iOS/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[ç§»åŠ¨IMå¼€å‘è¦ç‚¹]]></title>
    <link href="http://koalahl.github.io/2016/02/28/%E7%A7%BB%E5%8A%A8IM%E5%BC%80%E5%8F%91%E8%A6%81%E7%82%B9/"/>
    <id>http://koalahl.github.io/2016/02/28/ç§»åŠ¨IMå¼€å‘è¦ç‚¹/</id>
    <published>2016-02-28T14:10:56.000Z</published>
    <updated>2016-02-28T14:10:56.000Z</updated>
    <content type="html"><![CDATA[<p>ä¸ªäººå¯¹äºIMå¼€å‘ä¸­å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´çš„è¿æ¥æ¯”è¾ƒæ„Ÿå…´è¶£ï¼Œç½‘æœä¸€ç¯‡å¥½æ–‡ï¼Œè®°å½•ä¸‹æ¥ã€‚<br>è½¬è½½äº <a href="http://xiangwangfeng.com/2015/05/20/%E7%A7%BB%E5%8A%A8IM%E5%BC%80%E5%8F%91%E9%82%A3%E4%BA%9B%E4%BA%8B/" target="_blank" rel="external">ç§»åŠ¨IMå¼€å‘é‚£äº›äº‹</a></p>
<a id="more"></a>
<h2>é€šè®¯æ–¹å¼é€‰æ‹©</h2><br>IMé€šè®¯æ–¹å¼æ— éä¸¤ç§é€‰æ‹©:è®¾å¤‡ç›´è¿(P2P)å’Œé€šè¿‡æœåŠ¡å™¨ä¸­è½¬ã€‚<br><h3>P2P</h3><br>P2På¤šè§äºå±€åŸŸç½‘å†…èŠå¤©å·¥å…·ï¼Œå…¸å‹çš„åº”ç”¨æœ‰:é£é¸½ä¼ ä¹¦ï¼Œå¤©ç½‘Maze(ä½ æ‡‚çš„)ç­‰ã€‚è¿™ç±»è½¯ä»¶åœ¨å¯åŠ¨åä¸€èˆ¬åšä¸¤ä»¶äº‹æƒ…<br><br><em> è¿›è¡ŒUDPå¹¿æ’­:å‘é€è‡ªå·±ä¿¡æ¯å’Œæ¥å—åŒå±€åŸŸç½‘å†…å…¶ä»–ç«¯ä¿¡æ¯
</em> å¼€å¯TCPç›‘å¬:ç­‰å¾…å…¶ä»–ç«¯è¿›è¡Œè¿æ¥<br><br>è¯¦ç»†çš„æµç¨‹å¯ä»¥å‚è€ƒ<a href="http://ipmsg.org/" target="_blank" rel="external">é£é¸½ä¼ ä¹¦æºç </a>ã€‚ä½†æ˜¯è¿™ç§æ–¹å¼åœ¨æœ‰ç§ç§é™åˆ¶å’Œä¸ä¾¿:ä¸€æ–¹é¢å®ƒåªé€‚åˆåœ¨çº¿çš„ç‚¹å¯¹ç‚¹æ¶ˆæ¯ä¼ è¾“ï¼Œå¯¹ç¦»çº¿ï¼Œç¾¤ç»„ç­‰ä¸šåŠ¡æ”¯æŒä¸å¤Ÿã€‚å¦ä¸€æ–¹é¢ç”±äº <a href="http://zh.wikipedia.org/zh-cn/%E7%BD%91%E7%BB%9C%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2" target="_blank" rel="external">NAT</a> çš„å­˜åœ¨ï¼Œä½¿å¾—ä¸åŒå±€åŸŸç½‘å†…æœºå™¨äº’è”éš¾åº¦å¤§å¤§ä¸Šå‡ï¼Œåœ¨æŸäº›ç½‘ç»œç±»å‹(å¯¹ç§°NAT)ä¸‹æ— æ³•å»ºç«‹è¿æ¥ã€‚<br><h3>æœåŠ¡å™¨ä¸­è½¬</h3><br>å‡ ä¹æ‰€æœ‰äº’è”ç½‘IMäº§å“éƒ½é‡‡ç”¨æœåŠ¡å™¨ä¸­è½¬è¿™ç§æ–¹å¼è¿›è¡Œæ¶ˆæ¯ä¼ è¾“ï¼Œç›¸å¯¹äºP2Pçš„æ–¹å¼ï¼Œå®ƒæœ‰å¦‚ä¸‹çš„ä¼˜ç‚¹:<br><br><em> èƒ½å¤Ÿæ”¯æŒæ›´å¤šP2Pæ— æ³•æ”¯æŒæˆ–æ”¯æŒä¸å¥½çš„ä¸šåŠ¡ï¼Œå¦‚ç¦»çº¿æ¶ˆæ¯ï¼Œç¾¤ç»„ï¼ŒèŠå¤©å®¤æœåŠ¡
</em> æ–¹ä¾¿ä¸šåŠ¡é€»è¾‘çš„æ‹“å±•å’Œæ–°æ—§ç‰ˆæœ¬çš„å…¼å®¹<br><br>å½“ç„¶å®ƒä¹Ÿæœ‰è‡ªå·±çš„é—®é¢˜:æœåŠ¡å™¨æ¶æ„å¤æ‚ï¼Œå¹¶å‘è¦æ±‚é«˜ã€‚<br><br><br><h2>ç½‘ç»œè¿æ¥æ–¹å¼</h2><br>IMä¸»æµç½‘ç»œè¿æ¥æ–¹å¼æœ‰ä¸¤ç§:<br><br><em> åŸºäºTCPçš„é•¿è¿æ¥
</em> åŸºäºHTTPçŸ­è¿æ¥PULLçš„æ–¹å¼<br><br>åè€…å¸¸è§äºWEB IMç³»ç»Ÿ(å½“ç„¶ç°åœ¨å¾ˆå¤šWEB IMéƒ½æ˜¯åŸºäºWebSocketå®ç°)ï¼Œå®ƒçš„ä¼˜ç‚¹æ˜¯å®ç°ç®€å•ï¼Œæ–¹ä¾¿å¼€å‘ä¸Šæ‰‹ï¼Œé—®é¢˜æ˜¯æµé‡å¤§ï¼ŒæœåŠ¡å™¨è´Ÿè½½è¾ƒå¤§ï¼Œæ¶ˆæ¯åŠæ—¶æ€§æ— æ³•å¾ˆå¥½åœ°ä¿è¯ï¼Œå¯¹å¤§è§„æ¨¡çš„ç”¨æˆ·é‡æ”¯æŒä¸å¤Ÿï¼Œæ¯”è¾ƒé€‚åˆå°å‹çš„IMç³»ç»Ÿ,å¦‚å°ç½‘ç«™çš„å®¢æˆ·ç³»ç»Ÿã€‚<br><br>åŸºäºTCPé•¿è¿æ¥åˆ™èƒ½å¤Ÿæ›´å¥½åœ°æ”¯æŒå¤§æ‰¹é‡ç”¨æˆ·ï¼Œé—®é¢˜æ˜¯å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨çš„å®ç°æ¯”è¾ƒå¤æ‚ã€‚å½“ç„¶ä¹Ÿè¿˜æœ‰ä¸€äº›å˜ç§ï¼Œå¦‚ä¸‹è¡Œä½¿ç”¨MQTTè¿›è¡ŒæœåŠ¡å™¨é€šçŸ¥/æ¶ˆæ¯çš„ä¸‹å‘ï¼Œä¸Šè¡Œä½¿ç”¨HTTPçŸ­è¿æ¥è¿›è¡ŒæŒ‡ä»¤å’Œæ¶ˆæ¯çš„ä¸Šä¼ ã€‚è¿™ç§æ–¹å¼èƒ½å¤Ÿä¿è¯ä¸‹è¡Œæ¶ˆæ¯/æŒ‡ä»¤çš„åŠæ—¶æ€§ï¼Œä½†æ˜¯åœ¨å¼±ç½‘ç»œä¸‹ä¸Šè¡Œæ…¢çš„é—®é¢˜è¿˜æ˜¯æ¯”è¾ƒä¸¥é‡ã€‚æ—©æœŸçš„æ¥å¾€å°±æ˜¯åŸºäºè¿™ç§æ–¹å¼ã€‚<br><br><h2>åè®®é€‰æ‹©</h2>

<p>IMåè®®é€‰æ‹©åŸåˆ™ä¸€èˆ¬æ˜¯:æ˜“äºæ‹“å±•ï¼Œæ–¹ä¾¿è¦†ç›–å„ç§ä¸šåŠ¡é€»è¾‘ï¼ŒåŒæ—¶åˆæ¯”è¾ƒèŠ‚çº¦æµé‡ã€‚åä¸€ç‚¹çš„éœ€æ±‚åœ¨ç§»åŠ¨ç«¯IMä¸Šå°¤å…¶é‡è¦ã€‚</p>
<p>å¸¸è§çš„åè®®æœ‰:</p>
<ul>
<li><a href="http://zh.wikipedia.org/wiki/XMPP" target="_blank" rel="external">XMPP</a></li>
<li><a href="http://zh.wikipedia.org/wiki/%E4%BC%9A%E8%AF%9D%E5%8F%91%E8%B5%B7%E5%8D%8F%E8%AE%AE" target="_blank" rel="external">SIP</a></li>
<li><a href="http://mqtt.org/" target="_blank" rel="external">MQTT</a></li>
<li>ç§æœ‰åè®®</li>
</ul>
<p>XMPPåè®®çš„ä¼˜ç‚¹åœ¨äº:åè®®å¼€æºï¼Œå¯æ‹“å±•æ€§å¼ºï¼Œåœ¨å„ä¸ªç«¯(åŒ…æ‹¬æœåŠ¡å™¨)æœ‰å„ç§è¯­è¨€çš„å®ç°ï¼Œå¼€å‘è€…æ¥å…¥æ–¹ä¾¿ã€‚ä½†æ˜¯ç¼ºç‚¹ä¹Ÿæ˜¯ä¸å°‘:XMLè¡¨ç°åŠ›å¼±ï¼Œæœ‰å¤ªå¤šå†—ä½™ä¿¡æ¯ï¼Œæµé‡å¤§ï¼Œå®é™…ä½¿ç”¨æ—¶æœ‰å¤§é‡å¤©å‘ã€‚</p>
<p>SIPåè®®å¤šç”¨äºVOIPç›¸å…³çš„æ¨¡å—ï¼Œæ˜¯ä¸€ç§æ–‡æœ¬åè®®ï¼Œç”±äºæˆ‘å¹¶æ²¡æœ‰å®é™…ç”¨è¿‡ï¼Œæ‰€ä»¥ä¸åšè¯„è®ºï¼Œä½†ä»å®ƒæ˜¯æ–‡æœ¬åè®®è¿™ä¸€ç‚¹å‡ ä¹å¯ä»¥æ–­å®šå®ƒçš„æµé‡ä¸ä¼šå°ã€‚</p>
<p>MQTTçš„ä¼˜ç‚¹æ˜¯åè®®ç®€å•ï¼Œæµé‡å°‘ï¼Œä½†æ˜¯å®ƒå¹¶ä¸æ˜¯ä¸€ä¸ªä¸“é—¨ä¸ºIMè®¾è®¡çš„åè®®ï¼Œå¤šä½¿ç”¨äºæ¨é€ã€‚</p>
<p>è€Œå¸‚é¢ä¸Šå‡ ä¹æ‰€æœ‰ä¸»æµIM APPéƒ½æ˜¯æ˜¯ä½¿ç”¨ç§æœ‰åè®®ï¼Œä¸€ä¸ªè¢«è‰¯å¥½è®¾è®¡çš„ç§æœ‰åè®®ä¸€èˆ¬æœ‰å¦‚ä¸‹ä¼˜ç‚¹:é«˜æ•ˆï¼ŒèŠ‚çº¦æµé‡(ä¸€èˆ¬ä½¿ç”¨äºŒè¿›åˆ¶åè®®)ï¼Œå®‰å…¨æ€§é«˜ï¼Œéš¾ä»¥ç ´è§£ã€‚ç¼ºç‚¹åˆ™æ˜¯åœ¨å¼€å‘åˆæœŸæ²¡æœ‰ç°æœ‰æ ·åˆ—å¯ä»¥å‚è€ƒï¼Œå¯¹äºè®¾è®¡è€…çš„è¦æ±‚æ¯”è¾ƒé«˜ã€‚</p>
<p>ä¸€ä¸ªå¥½çš„åè®®éœ€è¦æ»¡è¶³å¦‚ä¸‹æ¡ä»¶:é«˜æ•ˆï¼Œç®€æ´ï¼Œå¯è¯»æ€§å¥½ï¼ŒèŠ‚çº¦æµé‡ï¼Œæ˜“äºæ‹“å±•ï¼ŒåŒæ—¶åˆèƒ½å¤ŸåŒ¹é…å½“å‰å›¢é˜Ÿçš„æŠ€æœ¯å †æ ˆã€‚åŸºäºå¦‚ä¸ŠåŸåˆ™ï¼Œæˆ‘ä»¬å¯ä»¥æ¨å‡º:<br>å¦‚æœå›¢é˜Ÿå°ï¼Œå›¢é˜ŸæŠ€æœ¯åœ¨IMä¸Šç§¯ç´¯ä¸å¤Ÿå¯ä»¥è€ƒè™‘ä½¿ç”¨XMPPæˆ–è€…MQTT+HTTPçŸ­è¿æ¥çš„å®ç°ã€‚åä¹‹å¯ä»¥è€ƒè™‘è‡ªå·±è®¾è®¡å’Œå®ç°ç§æœ‰åè®®ã€‚</p>
<h2>ç§æœ‰åè®®çš„è®¾è®¡</h2> 

<h3>åºåˆ—åŒ–é€‰æ‹©</h3><br>ç§»åŠ¨äº’è”ç½‘ç›¸å¯¹äºæœ‰çº¿ç½‘ç»œæœ€å¤§ç‰¹ç‚¹æ˜¯:å¸¦å®½ä½ï¼Œå»¶è¿Ÿé«˜ï¼Œä¸¢åŒ…ç‡é«˜å’Œç¨³å®šæ€§å·®ï¼Œæµé‡è´¹ç”¨é«˜ã€‚æ‰€ä»¥åœ¨ç§æœ‰åè®®çš„åºåˆ—åŒ–ä¸Šä¸€èˆ¬ä½¿ç”¨äºŒè¿›åˆ¶åè®®ï¼Œè€Œä¸æ˜¯æ–‡æœ¬åè®®ã€‚å¸¸è§çš„äºŒè¿›åˆ¶åºåˆ—åŒ–åº“æœ‰<a href="https://github.com/google/protobuf" target="_blank" rel="external">protobuf</a>å’Œ<a href="http://msgpack.org/" target="_blank" rel="external">MessagePack</a>ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥è‡ªå·±å®ç°è‡ªå·±çš„äºŒè¿›åˆ¶åè®®åºåˆ—åŒ–å’Œååºåˆ—çš„è¿‡ç¨‹ï¼Œæ¯”å¦‚è˜‘è‡è¡—çš„<a href="https://github.com/mogujie/TeamTalk" target="_blank" rel="external">TeamTalk</a>ã€‚ä½†æ˜¯å‰é¢äºŒè€…æ— è®ºæ˜¯å¯æ‹“å±•æ€§è¿˜æ˜¯å¯è¯»æ€§éƒ½å®Œçˆ†TeamTalk(TeamTalkè¿Variantéƒ½ä¸æ”¯æŒï¼Œä¸€ä¸ªintä¼ è¾“æ—¶å›ºå®šå ç”¨4ä¸ªå­—èŠ‚)ï¼Œæ‰€ä»¥å¤§éƒ¨åˆ†æƒ…å†µä¸‹è¿˜æ˜¯ä¸æ¨èè‡ªå·±å»å®ç°äºŒè¿›åˆ¶åè®®çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–è¿‡ç¨‹ã€‚<br><br><h3>åè®®æ ¼å¼è®¾è®¡</h3>

<p>åŸºäºTCPçš„åº”ç”¨å±‚åè®®ä¸€èˆ¬éƒ½åˆ†ä¸ºåŒ…å¤´å’ŒåŒ…ä½“(å¦‚HTTP)ï¼ŒIMåè®®ä¹Ÿä¸ä¾‹å¤–ã€‚åŒ…å¤´ä¸€èˆ¬ç”¨äºè¡¨ç¤ºæ¯ä¸ªè¯·æ±‚/åé¦ˆçš„å…¬å…±éƒ¨åˆ†ï¼Œå¦‚åŒ…é•¿ï¼Œè¯·æ±‚ç±»å‹ï¼Œè¿”å›ç ç­‰ã€‚<br>è€ŒåŒ…å¤´åˆ™å¡«å……ä¸åŒè¯·æ±‚/åé¦ˆå¯¹åº”çš„ä¿¡æ¯ã€‚</p>
<p>ä¸€ä¸ªæœ€ç®€å•çš„åŒ…å¤´å¯ä»¥å®šä¹‰ä¸º</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> PackHeader</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int32_t</span>     length_;    <span class="comment">//åŒ…é•¿åº¦</span></span><br><span class="line">    <span class="keyword">int32_t</span>     serial_;    <span class="comment">//åŒ…åºåˆ—å·</span></span><br><span class="line">    <span class="keyword">int32_t</span>     command_;   <span class="comment">//åŒ…è¯·æ±‚ç±»å‹</span></span><br><span class="line">    <span class="keyword">int32_t</span>     code_;      <span class="comment">//è¿”å›ç </span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>ä»¥å¿ƒè·³åŒ…ä¸ºä¾‹ï¼Œå‡è®¾å½“å‰çš„serialä¸º1ï¼Œå¿ƒè·³åŒ…çš„commandä¸º10ï¼Œé‚£ä¹ˆä½¿ç”¨MessagePackåšåºåˆ—åŒ–æ—¶:length=4ï¼Œserial=1ï¼Œcommand=10ï¼Œcode=0ï¼Œæ¯ä¸ªå­—æ®µå„å ä¸€ä¸ªå­—èŠ‚ï¼ŒåŒ…ä½“ä¸ºç©ºï¼Œä»…éœ€è¦4ä¸ªå­—èŠ‚ã€‚</p>
<p>å½“ç„¶è¿™æ˜¯æœ€ç®€å•çš„ä¸€ä¸ªä¾‹å­ï¼Œé¢å¯¹çœŸæ­£çš„ä¸šåŠ¡é€»è¾‘æ—¶ï¼ŒåŒ…ä½“é‡Œé¢ä¼šéœ€è¦å¡å…¥æ›´å¤šåœ°ä¿¡æ¯ï¼Œè¿™ä¸ªéœ€è¦å¼€å‘æ ¹æ®è‡ªå·±çš„ä¸šåŠ¡é€»è¾‘æ€»ç»“å…¬å…±éƒ¨åˆ†,å¦‚ä¸ºäº†å…¼å®¹åŠ å…¥çš„åè®®ç‰ˆæœ¬å·,ä¸ºäº†è´Ÿè½½å‡è¡¡åŠ å…¥çš„æ¨¡å—idç­‰ã€‚</p>
<p></p><h2>å…¶ä»–é—®é¢˜</h2><br>ä¸Šé¢å°±æ˜¯ä¸€ä¸ªIMç³»ç»Ÿå¤§è‡´çš„é€‰å‹è¿‡ç¨‹:é€šè®¯æ–¹å¼ï¼Œè¿æ¥æ–¹å¼ï¼Œåè®®é€‰æ‹©ï¼Œåè®®è®¾è®¡ã€‚ä½†æ˜¯å®é™…å¼€å‘è¿‡ç¨‹ä¸­è¿˜æœ‰å¤§é‡çš„é—®é¢˜éœ€è¦å¤„ç†ã€‚<p></p>
<p></p><h3>åè®®åŠ å¯†</h3><br>ä¸ºäº†ä¿è¯åè®®ä¸å®¹æ˜“è¢«ç ´è§£ï¼Œå¸‚é¢ä¸Šå‡ ä¹æ‰€æœ‰ä¸»æµIMéƒ½ä¼šå¯¹åè®®è¿›è¡ŒåŠ å¯†ä¼ è¾“ã€‚å¸¸è§çš„æµç¨‹å’ŒHTTPSåŠ å¯†ç›¸ä¼¼:å»ºç«‹è¿æ¥åï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨è¿›è¡Œè¿›è¡Œåå•†ï¼Œæœ€ç»ˆå®¢æˆ·ç«¯è·å¾—ä¸€ä¸ªå½“å‰Sessinoçš„ç§˜é’¥ï¼Œåç»­çš„æ•°æ®ä¼ è¾“éƒ½é€šè¿‡è¿™ä¸ªç§˜é’¥è¿›è¡ŒåŠ è§£å¯†ã€‚ä¸€èˆ¬å‡ºäºæ•ˆç‡çš„è€ƒè™‘éƒ½ä¼šé‡‡ç”¨æµå¼åŠ å¯†ï¼Œå¦‚RC4ã€‚è€Œå‰æœŸåå•†è¿‡ç¨‹åˆ™æ¨èä½¿ç”¨RSAç­‰éå¯¹ç§°åŠ å¯†ä»¥å¢åŠ ç ´è§£éš¾åº¦ã€‚<p></p>
<p></p><h3>å¿«é€Ÿè¿æ¥(ç™»å½•)</h3><br>å¯¹iOS APPè€Œè¨€ï¼Œå› ä¸ºæ²¡æœ‰çœŸåå°çš„å­˜åœ¨ï¼ŒAPPæ¯æ¬¡å¯åŠ¨åŸºæœ¬éƒ½éœ€è¦ä¸€æ¬¡é‡è¿ç™»å½•(çŸ­æ—¶é—´å†…åˆ‡æ¢é™¤å¤–)ï¼Œæ‰€ä»¥å¦‚ä½•å¿«é€Ÿé‡è¿é‡ç™»å°±éå¸¸é‡è¦ã€‚å¸¸è§çš„ä¼˜åŒ–æ€è·¯å¦‚ä¸‹:<p></p>
<ul>
<li>æœ¬åœ°ç¼“å­˜æœåŠ¡å™¨IPå¹¶å®šæœŸåˆ·æ–°ã€‚ç§»åŠ¨ç½‘ç»œè°ƒä¼˜å¯ä»¥å‚è€ƒ<a href="http://xiangwangfeng.com/2013/10/16/iOS%E7%A7%BB%E5%8A%A8%E7%BD%91%E7%BB%9C%E8%B0%83%E4%BC%98%E9%82%A3%E4%BA%9B%E4%BA%8B/" target="_blank" rel="external">ã€ŠiOSç§»åŠ¨ç½‘ç»œè°ƒä¼˜é‚£äº›äº‹ã€‹</a>ã€‚</li>
<li>åˆå¹¶éƒ¨åˆ†è¯·æ±‚ã€‚å¦‚åŠ å¯†å’Œç™»å½•æ“ä½œå¯ä»¥åˆå¹¶ä¸ºåŒä¸€ä¸ªæ“ä½œï¼Œè¿™æ ·å°±å¯ä»¥å‡å°‘ä¸€æ¬¡ä¸å¿…è¦çš„ç½‘ç»œè¯·æ±‚æ¥å›çš„æ—¶é—´ã€‚</li>
<li>ç®€åŒ–ç™»å½•åçš„åŒæ­¥è¯·æ±‚ï¼Œéƒ¨åˆ†åŒæ­¥è¯·æ±‚å¯ä»¥æ¨è¿Ÿåˆ°UIæ“ä½œæ—¶è¿›è¡Œï¼Œå¦‚ç¾¤æˆå‘˜ä¿¡æ¯åˆ·æ–°ã€‚</li>
</ul>
<p></p><h3>è¿æ¥ä¿æŒ</h3><br>ä¸€èˆ¬APPå®ç°è¿æ¥ä¿æŒçš„æ–¹å¼æ— éæ˜¯é‡‡ç”¨åº”ç”¨å±‚çš„å¿ƒè·³ï¼Œé€šè¿‡å¿ƒè·³åŒ…çš„è¶…æ—¶å’Œå…¶ä»–æ¡ä»¶(ç½‘ç»œåˆ‡æ¢)æ¥æ‰§è¡Œé‡è¿æ“ä½œã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†:ä¸ºä»€ä¹ˆè¦ä½¿ç”¨åº”ç”¨å±‚å¿ƒè·³å’Œå¦‚ä½•è®¾è®¡åº”ç”¨å±‚å¿ƒè·³ã€‚<p></p>
<p>ä¼—æ‰€å‘¨çŸ¥TCPåè®®æ˜¯æœ‰KEEPALIVEè¿™ä¸ªè®¾ç½®é€‰é¡¹ï¼Œè®¾ç½®ä¸ºKEEPALIVEåï¼Œå®¢æˆ·ç«¯æ¯éš”Nç§’(é»˜è®¤æ˜¯7200s)ä¼šå‘æœåŠ¡å™¨å‘é€ä¸€ä¸ªå‘é€å¿ƒè·³åŒ…ã€‚ä½†å®é™…æ“ä½œä¸­æˆ‘ä»¬æ›´å¤šçš„æ—¶æ˜¯ä½¿ç”¨åº”ç”¨å±‚å¿ƒè·³ã€‚åŸå› å¦‚ä¸‹:</p>
<ul>
<li>KEEPALIVEå¯¹æœåŠ¡å™¨è´Ÿè½½å‹åŠ›æ¯”è¾ƒå¤§(æœåŠ¡å™¨å¤§å¤§æ˜¯è¿™ä¹ˆè¯´çš„â€¦)</li>
<li>socksä»£ç†å¯¹KEEPALIVEå¹¶ä¸æ”¯æŒ</li>
<li>éƒ¨åˆ†å¤æ‚æƒ…å†µä¸‹KEEPALIVEä¼šå¤±æ•ˆï¼Œå¦‚è·¯ç”±å™¨æŒ‚æ‰ï¼Œç½‘çº¿(ç§»åŠ¨ç«¯æ²¡æœ‰ç½‘çº¿â€¦)ç›´æ¥è¢«æ‹”é™¤</li>
</ul>
<p>ç§»åŠ¨ç«¯åœ¨å®é™…æ“ä½œæ—¶ä¸ºäº†èŠ‚çº¦æµé‡å’Œç”µé‡ä¸€èˆ¬ä¼šåœ¨å¿ƒè·³åŒ…ä¸Šåšä¸€äº›å°ä¼˜åŒ–</p>
<ul>
<li>ç²¾ç®€å¿ƒè·³åŒ…ï¼Œä¿è¯ä¸€ä¸ªå¿ƒè·³åŒ…å¤§å°åœ¨10å­—èŠ‚ä¹‹å†…</li>
<li>å¿ƒè·³åŒ…åªåœ¨ç©ºé—²æ—¶å‘é€ </li>
<li>æ ¹æ®APPå‰åå°çŠ¶æ€è°ƒæ•´å¿ƒè·³åŒ…é—´éš” (ä¸»è¦æ˜¯å®‰å“)</li>
</ul>
<p></p><h3>æ¶ˆæ¯å¯è¾¾</h3><br>åœ¨ç§»åŠ¨ç½‘ç»œä¸‹ï¼Œä¸¢åŒ…ï¼Œç½‘ç»œé‡è¿ç­‰æƒ…å†µéå¸¸ä¹‹å¤šï¼Œä¸ºäº†ä¿è¯æ¶ˆæ¯çš„å¯è¾¾ï¼Œä¸€èˆ¬éœ€è¦åšæ¶ˆæ¯å›æ‰§å’Œé‡å‘æœºåˆ¶ã€‚å‚è€ƒæ˜“ä¿¡ï¼Œæ¯æ¡æ¶ˆæ¯ä¼šæœ€å¤šä¼šæœ‰3æ¬¡é‡å‘ï¼Œè¶…æ—¶æ—¶é—´ä¸º15ç§’ï¼ŒåŒæ—¶åœ¨å‘é€ä¹‹å‰ä¼šæ£€æµ‹å½“å‰è¿æ¥çŠ¶æ€ï¼Œå¦‚æœå½“å‰è¿æ¥å¹¶æ²¡æœ‰æ­£ç¡®å»ºç«‹ï¼Œç¼“å­˜æ¶ˆæ¯ä¸”å®šæ—¶æ£€æŸ¥(æ¯éš”2ç§’æ£€æŸ¥ä¸€æ¬¡ï¼Œæ£€æŸ¥15æ¬¡)ã€‚æ‰€ä»¥ä¸€æ¡æ¶ˆæ¯åœ¨æœ€å·®çš„æƒ…å†µä¸‹ä¼šæœ‰2åˆ†é’Ÿå·¦å³çš„é‡è¯•æ—¶é—´ï¼Œä»¥ä¿è¯æ¶ˆæ¯çš„å¯è¾¾ã€‚<p></p>
<p>å› ä¸ºé‡å‘çš„å­˜åœ¨ï¼Œæ¥å—ç«¯å¶å°”ä¼šæ”¶åˆ°é‡å¤æ¶ˆæ¯ï¼Œè¿™ç§æƒ…å†µä¸‹å°±éœ€è¦æ¥æ”¶ç«¯è¿›è¡Œå»é‡ã€‚é€šç”¨çš„åšæ³•æ˜¯æ¯æ¡æ¶ˆæ¯éƒ½å¸¦ä¸Šè‡ªå·±å”¯ä¸€çš„message id(ä¸€èˆ¬æ˜¯uuid)ã€‚</p>
<p></p><h3>æ–‡ä»¶ä¸Šä¼ ä¼˜åŒ–</h3><br>IMæ¶ˆæ¯(åŒ…æ‹¬SNSæ¨¡å—)å†…åŒ…å«å¤§é‡çš„æ–‡ä»¶ä¸Šä¼ çš„éœ€æ±‚ï¼Œå¦‚ä½•ä¼˜åŒ–æ–‡ä»¶çš„ä¸Šä¼ å°±æˆäº†ä¸€ä¸ªæ¯”è¾ƒå¤§çš„ä¸»é¢˜ã€‚å¸¸è§æœ‰ä¸‹é¢è¿™äº›ä¼˜åŒ–æ€è·¯:<p></p>
<ul>
<li>å°†ä¸Šä¼ æµç¨‹æå‰:éŸ³é¢‘æä¾›è¾¹å½•è¾¹ä¼ ã€‚æœ‹å‹åœˆçš„å›¾ç‰‡è¿›è¡Œé¢„ä¸Šä¼ ï¼Œé€‰æ‹©å›¾ç‰‡åç”¨æˆ·ä¸€èˆ¬ä¼šè¿›è¡Œæ–‡æœ¬è¾“å…¥ï¼Œåœ¨è¿™æ®µæ—¶é—´å†…åå°å°±å¯ä»¥é»˜é»˜å°†é€‰å¥½çš„å›¾ç‰‡è¿›è¡Œä¸Šä¼ ã€‚</li>
<li>æä¾›é—ªç”µä¸Šä¼ çš„æ–¹å¼:æœåŠ¡å™¨æ ¹æ®MD5è¿›è¡Œæ–‡ä»¶å»é‡ã€‚</li>
<li>ä¼˜åŒ–å’Œä¸Šä¼ æœåŠ¡å™¨çš„è¿æ¥(å‚è€ƒå¿«é€Ÿè¿æ¥)ï¼Œæä¾›è¿æ¥é‡ç”¨çš„åŠŸèƒ½ã€‚</li>
<li>æ–‡ä»¶åˆ†å—ä¸Šä¼ :å› ä¸ºç§»åŠ¨ç½‘ç»œä¸¢åŒ…ä¸¥é‡ï¼Œå°†æ–‡ä»¶åˆ†å—ä¸Šä¼ å¯ä»¥ä½¿å¾—ä¸€ä¸ªåˆ†ç»„åŒ…å«åˆç†æ•°é‡çš„TCPåŒ…ï¼Œä½¿å¾—é‡è¯•æ¦‚ç‡ä¸‹é™ï¼Œé‡è¯•ä»£ä»·å˜å°ï¼Œæ›´å®¹æ˜“ä¸Šä¼ åˆ°æœåŠ¡å™¨ã€‚</li>
<li>åœ¨åˆ†åŒ…çš„å‰æä¸‹æ”¯æŒä¸Šä¼ çš„pipelineï¼Œé¿å…ä¸å¿…è¦çš„ç½‘ç»œç­‰å¾…æ—¶é—´ã€‚</li>
<li>æ”¯æŒæ–­ç‚¹ç»­ä¼ </li>
</ul>
<p></p><h2>æ€»ç»“</h2><br>æ­¤å¤„æ˜¯è½¯æ–‡ï¼Œè¯·å…¨é€‰é˜…è¯»:<font color="white">ä¸€ä¸ªå¤§å‹IMç³»ç»Ÿæ¶‰åŠåˆ°ä¸œè¥¿å®åœ¨å¤ªå¤šï¼Œå¦‚æœIMæ¨¡å—åªæ˜¯APPçš„é™„å±åŠŸèƒ½ï¼Œå¹¶ä¸æ¨èè‡ªå·±å»ä»å¤´å®ç°IMæ¨¡å—æˆ–è€…ä½¿ç”¨XMPPè¿™ç§æœ‰å¤©å‘çš„å¼€æºå®ç°ï¼Œç›´æ¥ä½¿ç”¨å¸‚é¢ä¸Šçš„ç¬¬ä¸‰æ–¹SDKå³å¯ï¼Œæ¯”å¦‚æˆ‘ä»¬çš„<a href="http://netease.im" target="_blank" rel="external">äº‘ä¿¡</a>ã€‚æ¯•ç«Ÿï¼Œæˆ‘ä»¬ï¼Œæ˜¯ï¼Œä¸“ä¸šçš„ï¼~~~~</font><p></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>ä¸ªäººå¯¹äºIMå¼€å‘ä¸­å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´çš„è¿æ¥æ¯”è¾ƒæ„Ÿå…´è¶£ï¼Œç½‘æœä¸€ç¯‡å¥½æ–‡ï¼Œè®°å½•ä¸‹æ¥ã€‚<br>è½¬è½½äº <a href="http://xiangwangfeng.com/2015/05/20/%E7%A7%BB%E5%8A%A8IM%E5%BC%80%E5%8F%91%E9%82%A3%E4%BA%9B%E4%BA%8B/">ç§»åŠ¨IMå¼€å‘é‚£äº›äº‹</a></p>]]>
    
    </summary>
    
      <category term="IM" scheme="http://koalahl.github.io/tags/IM/"/>
    
      <category term="xmpp" scheme="http://koalahl.github.io/tags/xmpp/"/>
    
      <category term="iOS" scheme="http://koalahl.github.io/categories/iOS/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[å¦‚ä½•åšä¸€ä¸ªåœ†å½¢çš„éŸ³é‡æ—‹é’®]]></title>
    <link href="http://koalahl.github.io/2016/01/17/%E5%A6%82%E4%BD%95%E5%81%9A%E4%B8%80%E4%B8%AA%E5%9C%86%E5%BD%A2%E7%9A%84%E9%9F%B3%E9%87%8F%E6%97%8B%E9%92%AE/"/>
    <id>http://koalahl.github.io/2016/01/17/å¦‚ä½•åšä¸€ä¸ªåœ†å½¢çš„éŸ³é‡æ—‹é’®/</id>
    <published>2016-01-17T13:47:14.000Z</published>
    <updated>2016-01-17T13:47:14.000Z</updated>
    <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨Mediumä¸Šæµè§ˆä¸€äº›å›½å¤–çš„iOSå¼€å‘ç›¸å…³çš„æ–‡ç« ï¼Œçœ‹åˆ°æ„Ÿå…´è¶£çš„ä¾¿å®è·µä¸€ç•ªï¼Œè®°å½•ä¸‹æ¥ã€‚ä¸€æ¥ç®—æ˜¯å­¦ä¹ swiftï¼Œå¦ä¸€æ–¹é¢åˆ™æ˜¯ä¸ºäº†æ‹“å®½æŠ€æœ¯é¢ã€‚</p>
<p>è¿™ç¯‡æ–‡ç« æ¥è‡ª<a href="https://medium.com/@karthikkeyan" target="_blank" rel="external">Karthik Keyan Balan</a>çš„<a href="https://medium.com/@karthikkeyan/how-to-create-a-circular-seek-bar-in-ios-edc6e2871cd0#.yqla9v503" target="_blank" rel="external">How to create a circular seek bar in iOS</a><br>ä¸»è¦å±•ç¤ºäº†ä¸€ä¸ªåœ†å½¢çš„ç±»ä¼¼éŸ³é‡æ—‹é’®çš„UIæ§ä»¶ï¼Œç”¨swiftå®ç°ã€‚å¦‚ä¸‹å›¾ï¼Œ<br><img src="/img/circle seek bar.gif" alt="circle seek bar"></p>
<a id="more"></a>
<h2 id="strokeUI">å¦‚ä½•ç”»å‡ºåœ†å½¢æ—‹é’®</h2>

<p>ä½¿ç”¨CAShapeLayerï¼Œå¹¶å°†å…¶pathè®¾ç½®ä¸ºè‡ªå®šä¹‰çš„è´å¡å°”æ›²çº¿çš„pathã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">lazy</span> <span class="keyword">var</span> seekerBarLayer = <span class="type">CAShapeLayer</span>()</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="func"><span class="keyword">func</span> <span class="title">addSeekerBar</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">let</span> center = <span class="type">CGPointMake</span>(<span class="keyword">self</span>.bounds.size.width/<span class="number">2</span>, <span class="keyword">self</span>.bounds.size.height/<span class="number">2</span>)</span><br><span class="line">    <span class="comment">//å¼§åº¦</span></span><br><span class="line">    <span class="keyword">let</span> sAngle = degreeToRadian(<span class="type">Double</span>(startAngle))</span><br><span class="line">    <span class="keyword">let</span> eAngle = degreeToRadian(<span class="type">Double</span>(endAngle))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> path = <span class="type">UIBezierPath</span>(arcCenter: center, radius: (<span class="keyword">self</span>.bounds.size.width - <span class="number">18</span>)/<span class="number">2</span>, startAngle:<span class="type">CGFloat</span>(sAngle) , endAngle:<span class="type">CGFloat</span>(eAngle) , clockwise: <span class="literal">true</span>)</span><br><span class="line">    </span><br><span class="line">    seekerBarLayer.path = path.<span class="type">CGPath</span>;</span><br><span class="line">    seekerBarLayer.lineWidth = <span class="number">4.0</span></span><br><span class="line">    seekerBarLayer.lineCap   = kCALineCapRound</span><br><span class="line">    seekerBarLayer.strokeColor = seekBarColor.<span class="type">CGColor</span></span><br><span class="line">    seekerBarLayer.fillColor = <span class="type">UIColor</span>.clearColor().<span class="type">CGColor</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> seekerBarLayer.superlayer == <span class="literal">nil</span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.layer.addSublayer(seekerBarLayer)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="touch">æ ¹æ®touchä½ç½®ç§»åŠ¨æ—‹é’®ä½ç½®</h2>

<p>é‡è½½touchç›¸å…³çš„ä¸‰ä¸ªæ–¹æ³•ï¼Œé‡ç‚¹æ˜¯åœ¨<code>continueTrackingWithTouch</code>æ–¹æ³•ä¸­ï¼Œæ ¹æ®touchçš„åæ ‡è®¡ç®—æŒ‰é’®éœ€è¦ç§»åŠ¨çš„ä½ç½®çš„<code>moveToPoint</code>æ–¹æ³•ã€‚</p>
<ul>
<li><a href="#touchLocation">è·å–touchä½ç½®</a></li>
<li><a href="#buttonPoint">è®¡ç®—æ—‹é’®å¯¹åº”çš„åæ ‡</a></li>
</ul>
<h3 id="touchLocation">è·å–touchä½ç½®</h3>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//MARK: Touch Event</span></span><br><span class="line"><span class="keyword">override</span> <span class="func"><span class="keyword">func</span> <span class="title">beginTrackingWithTouch</span><span class="params">(touch: UITouch, withEvent event: UIEvent?)</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> point = touch.locationInView(<span class="keyword">self</span>)</span><br><span class="line">    <span class="keyword">let</span> rect  = <span class="type">CGRectInset</span>(<span class="keyword">self</span>.thumbButton.frame, -<span class="number">20</span>, -<span class="number">20</span>)</span><br><span class="line">    <span class="keyword">let</span> canBegin = <span class="type">CGRectContainsPoint</span>(rect, point)</span><br><span class="line">    <span class="keyword">if</span> canBegin &#123;</span><br><span class="line">        <span class="type">UIView</span>.animateWithDuration(<span class="number">0.2</span>, delay: <span class="number">0.0</span>, options: .<span class="type">CurveEaseIn</span>, animations: &#123; () -&gt; <span class="type">Void</span> <span class="keyword">in</span></span><br><span class="line">                <span class="keyword">self</span>.thumbButton.transform = <span class="type">CGAffineTransformMakeScale</span>(<span class="number">1.2</span>, <span class="number">1.2</span>)</span><br><span class="line">            &#125;, completion: <span class="literal">nil</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> canBegin</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">override</span> <span class="func"><span class="keyword">func</span> <span class="title">continueTrackingWithTouch</span><span class="params">(touch: UITouch, withEvent event: UIEvent?)</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> #available(iOS <span class="number">9</span>,*)&#123;</span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> coalescedTouches = event?.coalescedTouchesForTouch(touch) <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> moveToPoint(touch.locationInView(<span class="keyword">self</span>))</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">let</span> result = <span class="literal">true</span></span><br><span class="line">        <span class="keyword">for</span> cTouch <span class="keyword">in</span> coalescedTouches&#123;</span><br><span class="line">            <span class="keyword">let</span> result = moveToPoint(cTouch.locationInView(<span class="keyword">self</span>))</span><br><span class="line">            <span class="keyword">if</span> result == <span class="literal">false</span> &#123;<span class="keyword">break</span>&#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">override</span> <span class="func"><span class="keyword">func</span> <span class="title">endTrackingWithTouch</span><span class="params">(touch: UITouch?, withEvent event: UIEvent?)</span></span> &#123;</span><br><span class="line">    thumbMoveDidComplete()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="buttonPoint">è®¡ç®—æ—‹é’®å¯¹åº”çš„åæ ‡</h3>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">moveToPoint</span><span class="params">(point:CGPoint)</span></span> -&gt;<span class="type">Bool</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> degree = degreeForLocation(point)</span><br><span class="line">    </span><br><span class="line">    <span class="func"><span class="keyword">func</span> <span class="title">moveToClosestEdge</span><span class="params">(degree:Double)</span></span>&#123;</span><br><span class="line">        <span class="keyword">let</span> startDistance = fabs(<span class="type">CGFloat</span>(degree) - startAngle)</span><br><span class="line">        <span class="keyword">let</span> endDistance   = fabs(<span class="type">CGFloat</span>(degree) - endAngle)</span><br><span class="line">        <span class="keyword">if</span> startDistance &lt; endDistance&#123;</span><br><span class="line">            currentAngle = startAngle</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            currentAngle = endAngle</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> startAngle &gt; endAngle &#123;</span><br><span class="line">        <span class="keyword">if</span> degree &lt; <span class="type">Double</span>(startAngle) &amp;&amp; degree &gt; <span class="type">Double</span>(endAngle)&#123;</span><br><span class="line">            moveToClosestEdge(degree)</span><br><span class="line">            thumbMoveDidComplete()</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> degree &gt; <span class="type">Double</span>(endAngle) || degree &lt; <span class="type">Double</span>(startAngle)&#123;</span><br><span class="line">            moveToClosestEdge(degree)</span><br><span class="line">            thumbMoveDidComplete()</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    currentAngle = <span class="type">CGFloat</span>(degree)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p></p><h3>æ‰‹åŠ¨å‘é€action</h3><br>ç”±äºè¿™ä¸ªæ§ä»¶æ˜¯ç»§æ‰¿è‡ªUIControlçš„ï¼Œæ­£å¦‚å…¶ä»–ç»§æ‰¿ä¸UIControlçš„æ§ä»¶ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰ä¸€ä¸ªæ§ä»¶çš„çŠ¶æ€äº‹ä»¶ã€‚ä¾‹å¦‚<code>valueChangedã€TouchUpInsideã€TouchOutSide</code>ã€‚<br>è¿™é‡Œæˆ‘ä»¬éœ€è¦çš„æ˜¯æ§ä»¶çš„ä½ç½®ä¿¡æ¯ï¼Œæ‰€ä»¥å½“endTouchçš„æ—¶å€™å‘é€ä¸€ä¸ª<code>valueChanged</code>äº‹ä»¶ï¼š<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">self</span>.sendActionsForControlEvents(.<span class="type">ValueChanged</span>)</span><br></pre></td></tr></table></figure><p></p>
<p>å…¶ä¸­æœ‰ä¸€ä¸ªå°ç»†èŠ‚ï¼Œå½“ç‚¹å‡»åˆ°æŒ‰é’®æ—¶ï¼Œä¼šæœ‰ä¸€ä¸ªå˜å¤§çš„åŠ¨ç”»æ•ˆæœï¼Œå…¶å®ä¹Ÿæ˜¯ç”¨åˆ°äº†ä¸€ä¸ªåŸºæœ¬çš„æ‹‰ä¼¸æ•ˆæœï¼š<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">UIView</span>.animateWithDuration(<span class="number">0.2</span>, delay: <span class="number">0.0</span>, options: .<span class="type">CurveEaseIn</span>, animations: &#123; () -&gt; <span class="type">Void</span> <span class="keyword">in</span></span><br><span class="line">                    <span class="keyword">self</span>.thumbButton.transform = <span class="type">CGAffineTransformMakeScale</span>(<span class="number">1.2</span>, <span class="number">1.2</span>)</span><br><span class="line">                &#125;, completion: <span class="literal">nil</span>)</span><br></pre></td></tr></table></figure></p>
<h2 id="summary">æ€»ç»“</h2>

<ul>
<li>åˆ©ç”¨CAShapeLayer+è´å¡å°”æ›²çº¿ç”»å‡ºUIã€‚</li>
<li>æ ¹æ®è§’åº¦è®¡ç®—å¼§åº¦ï¼Œå¹¶å¯¼å‡ºæŒ‰é’®å¯¹åº”çš„åæ ‡ç‚¹ã€‚</li>
<li>touchäº‹ä»¶çš„å¤„ç†ã€‚- æ‰‹åŠ¨å‘é€actionã€‚</li>
</ul>
<p>å‚è€ƒä»£ç ï¼š<a href="https://github.com/karthikkeyan/CircularSeek" target="_blank" rel="external">CircularSeek On GitHub</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>æœ€è¿‘åœ¨Mediumä¸Šæµè§ˆä¸€äº›å›½å¤–çš„iOSå¼€å‘ç›¸å…³çš„æ–‡ç« ï¼Œçœ‹åˆ°æ„Ÿå…´è¶£çš„ä¾¿å®è·µä¸€ç•ªï¼Œè®°å½•ä¸‹æ¥ã€‚ä¸€æ¥ç®—æ˜¯å­¦ä¹ swiftï¼Œå¦ä¸€æ–¹é¢åˆ™æ˜¯ä¸ºäº†æ‹“å®½æŠ€æœ¯é¢ã€‚</p>
<p>è¿™ç¯‡æ–‡ç« æ¥è‡ª<a href="https://medium.com/@karthikkeyan">Karthik Keyan Balan</a>çš„<a href="https://medium.com/@karthikkeyan/how-to-create-a-circular-seek-bar-in-ios-edc6e2871cd0#.yqla9v503">How to create a circular seek bar in iOS</a><br>ä¸»è¦å±•ç¤ºäº†ä¸€ä¸ªåœ†å½¢çš„ç±»ä¼¼éŸ³é‡æ—‹é’®çš„UIæ§ä»¶ï¼Œç”¨swiftå®ç°ã€‚å¦‚ä¸‹å›¾ï¼Œ<br><img src="/img/circle seek bar.gif" alt="circle seek bar"></p>]]>
    
    </summary>
    
      <category term="swift" scheme="http://koalahl.github.io/tags/swift/"/>
    
      <category term="iOS" scheme="http://koalahl.github.io/categories/iOS/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[NSURLSessionåˆæ¢]]></title>
    <link href="http://koalahl.github.io/2016/01/10/NSURLSession%E5%88%9D%E6%8E%A2/"/>
    <id>http://koalahl.github.io/2016/01/10/NSURLSessionåˆæ¢/</id>
    <published>2016-01-10T14:04:06.000Z</published>
    <updated>2016-01-10T14:04:06.000Z</updated>
    <content type="html"><![CDATA[<p>NSURLSessionæ˜¯Appleè‡ªiOS7.0ä¹‹ååŠ å…¥åˆ°Cocoa SDKä¸­ï¼Œç”¨ä»¥æ›¿ä»£NSURLConnectionã€‚å®ƒæ‹¥æœ‰æ›´ç®€æ´æ˜“æ‡‚çš„APIæ–¹æ³•ã€‚<br>iOSä¸­å¸¸ç”¨çš„ç½‘ç»œåº“ä¾‹å¦‚AFNetworkingåœ¨3.0ç‰ˆæœ¬ä¸­å°±å…¨éƒ¨æ›¿æ¢ä¸ºäº†NSURLSessionã€‚<br><a id="more"></a><br>ä¹‹å‰é¡¹ç›®ä¸­ä¸€ç›´ä½¿ç”¨çš„AFNetworking2.xç‰ˆæœ¬ï¼Œä¹Ÿæ²¡æœ‰èŠ±æ—¶é—´å»ä»”ç»†ç ”ç©¶NSURLSessionï¼Œç‰¹æ­¤å‘¨æœ«ç²—ç•¥çš„çœ‹äº†çœ‹ï¼Œä¸€äº›æ–¹æ³•ä¹Ÿæ˜¯è¯•äº†è¯•ã€‚</p>
<p>NSURLSessionç»§æ‰¿ç»“æ„ï¼š</p>
<ul>
<li>NSURLSession - sessionå¯¹è±¡ã€‚</li>
<li>NSURLSessionConfiguration - å½“åˆå§‹åŒ–sessionå¯¹è±¡æ—¶è®¾ç½®sessionçš„é…ç½®ä¿¡æ¯ã€‚</li>
<li>NSURLSessoinTask - taskåŸºç±»<ul>
<li>NSURLSessionDataTask - è·å–urlå†…å®¹ï¼Œè¿”å›NSDataå¯¹è±¡ã€‚<ul>
<li>NSURLSessionUploadTask - ä¸Šä¼ æ–‡ä»¶çš„taskï¼Œå¹¶å–å›å¯¹åº”urlå†…å®¹ï¼Œè¿”å›NSDataå¯¹è±¡ã€‚</li>
</ul>
</li>
<li>NSURLSessionDownloadTask - è·å–urlå†…å®¹ï¼Œå¹¶è¿”å›ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶åœ¨æ²™ç›’ä¸­ï¼ˆtmpç›®å½•ä¸‹ï¼‰ã€‚</li>
</ul>
</li>
</ul>
<p>NSURLSessionä¹Ÿæä¾›äº†å››ç»„ä»£ç†æ–¹æ³•ï¼š</p>
<ul>
<li><p>NSURLSessionDelegate â€” Defines delegate methods to handle session-level events</p>
</li>
<li><p>NSURLSessionTaskDelegate â€” Defines delegate methods to handle task-level events common to all task types</p>
</li>
<li><p>NSURLSessionDataDelegate â€” Defines delegate methods to handle task-level events specific to data and upload tasks</p>
</li>
<li><p>NSURLSessionDownloadDelegate â€” Defines delegate methods to handle task-level events specific to download tasks</p>
</li>
</ul>
<p>é¦–å…ˆæ¥çœ‹çœ‹æ™®é€šçš„sessoinè¯·æ±‚æ–¹æ³•ã€‚åœ¨completionHandlerä¸­è¿”å›çš„æ˜¯NSDataã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSURLSession</span> *session = [<span class="built_in">NSURLSession</span> sharedSession];</span><br><span class="line"><span class="built_in">NSURLSessionDataTask</span> * dataTask = [session dataTaskWithRequest:[<span class="built_in">NSURLRequest</span> requestWithURL:[<span class="built_in">NSURL</span> URLWithString:url]] completionHandler:^(<span class="built_in">NSData</span> * _Nullable data, <span class="built_in">NSURLResponse</span> * _Nullable response, <span class="built_in">NSError</span> * _Nullable error) &#123;</span><br><span class="line">    <span class="keyword">self</span><span class="variable">.fileName</span> = response<span class="variable">.suggestedFilename</span>;</span><br><span class="line">    [<span class="keyword">self</span> saveToFile];</span><br><span class="line">    [<span class="keyword">self</span><span class="variable">.fileHandler</span> seekToEndOfFile];</span><br><span class="line">    [<span class="keyword">self</span><span class="variable">.fileHandler</span> writeData:data];</span><br><span class="line">    [<span class="keyword">self</span><span class="variable">.fileHandler</span> closeFile];</span><br><span class="line">&#125;];</span><br><span class="line">[dataTask resume];<span class="comment">//å¼€å§‹ä»»åŠ¡ã€‚resumeæœ‰ç»§ç»­ã€æ¢å¤ã€é‡æ–°å¼€å§‹çš„æ„æ€ï¼Œå½“å¤„ç†æ–­ç‚¹ç»­ä¼ æ—¶å°±èƒ½ä½“ä¼šåˆ°æ­¤å«ä¹‰äº†ã€‚</span></span><br></pre></td></tr></table></figure>
<p>å†æ¥çœ‹çœ‹download taskçš„è¯·æ±‚æ–¹å¼ï¼Œä¸Šé¢æåˆ°è¿‡ï¼Œdownload taskæœ€åè¿”å›çš„æ˜¯ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ï¼Œæ‰€ä»¥éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨å°†å…¶ä¿å­˜åˆ°å…¶ä»–æ²™ç›’ç›®å½•ä¸­ï¼Œå°±éœ€è¦ç”¨åˆ°NSFileManageräº†ã€‚<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSURLSessionDownloadTask</span> * downloadTask = [session downloadTaskWithRequest:[<span class="built_in">NSURLRequest</span> requestWithURL:[<span class="built_in">NSURL</span> URLWithString:url]] completionHandler:^(<span class="built_in">NSURL</span> * _Nullable location, <span class="built_in">NSURLResponse</span> * _Nullable response, <span class="built_in">NSError</span> * _Nullable error) &#123;</span><br><span class="line">    <span class="keyword">self</span><span class="variable">.fileName</span> = response<span class="variable">.suggestedFilename</span>;</span><br><span class="line">    <span class="built_in">NSString</span> * directory = [<span class="built_in">NSSearchPathForDirectoriesInDomains</span>(<span class="built_in">NSDocumentDirectory</span>, <span class="built_in">NSUserDomainMask</span>, <span class="literal">YES</span>) lastObject];</span><br><span class="line">    <span class="built_in">NSString</span> * filePath = [directory stringByAppendingPathComponent:<span class="keyword">self</span><span class="variable">.fileName</span>];</span><br><span class="line">    <span class="built_in">NSFileManager</span> * fileManager = [<span class="built_in">NSFileManager</span> defaultManager];</span><br><span class="line">    [fileManager moveItemAtPath:location<span class="variable">.path</span> toPath:filePath error:<span class="literal">nil</span>];</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line"> [downloadTask resume];</span><br></pre></td></tr></table></figure></p>
<p>é‚£æœ‰æ—¶å€™æˆ‘ä»¬æƒ³å–å¾—ä¸‹è½½è¿›åº¦ä¿¡æ¯ï¼Œç”¨blockæ–¹å¼å°±ä¸è¡Œäº†ï¼Œæ‰€ä»¥å°±éœ€è¦ç”¨åˆ°ç³»ç»Ÿæä¾›çš„ä»£ç†æ–¹æ³•äº†ã€‚è¿™é‡Œæˆ‘ä»¬ç”¨<code>NSURLSessionDownloadDelegate</code>.<br>æ­¤æ—¶sessionçš„åˆ›å»ºæ–¹å¼å°±æ˜¯å¦ä¸€ç§æ–¹å¼ï¼Œè®¾ç½®delegateä¸ºselfã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSURLSession</span> * session = [<span class="built_in">NSURLSession</span> sessionWithConfiguration:[<span class="built_in">NSURLSessionConfiguration</span> defaultSessionConfiguration]</span><br><span class="line">                                                           delegate:<span class="keyword">self</span> delegateQueue:[<span class="built_in">NSOperationQueue</span> mainQueue]];</span><br><span class="line"></span><br><span class="line"><span class="keyword">self</span><span class="variable">.downloadTask</span> = [session downloadTaskWithRequest:[<span class="built_in">NSURLRequest</span> requestWithURL:[<span class="built_in">NSURL</span> URLWithString:url]]];</span><br><span class="line">[<span class="keyword">self</span><span class="variable">.downloadTask</span> resume];</span><br></pre></td></tr></table></figure>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#pragma mark - NSURLSessionDownloadDelegate</span></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> *  ä¸‹è½½å®Œæ¯•</span><br><span class="line"> *</span><br><span class="line"> *  @param location     æ–‡ä»¶ä¸´æ—¶åœ°å€</span><br><span class="line"> */</span></span><br><span class="line">- (<span class="keyword">void</span>)URLSession:(<span class="built_in">NSURLSession</span> *)session downloadTask:(<span class="built_in">NSURLSessionDownloadTask</span> *)downloadTask</span><br><span class="line">didFinishDownloadingToURL:(<span class="built_in">NSURL</span> *)location</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"æ–‡ä»¶å­˜æ”¾ä½ç½®%@"</span>,location<span class="variable">.path</span>);</span><br><span class="line"><span class="comment">//    [self.startOrPauseOfSession setTitle:@"å¼€å§‹" forState:UIControlStateNormal];</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">self</span><span class="variable">.fileName</span> = <span class="string">@"QQ4.1.0.dmg"</span>;</span><br><span class="line">    <span class="built_in">NSString</span> * directory = [<span class="built_in">NSSearchPathForDirectoriesInDomains</span>(<span class="built_in">NSDocumentDirectory</span>, <span class="built_in">NSUserDomainMask</span>, <span class="literal">YES</span>) lastObject];</span><br><span class="line">    <span class="built_in">NSString</span> * filePath = [directory stringByAppendingPathComponent:<span class="keyword">self</span><span class="variable">.fileName</span>];</span><br><span class="line">    <span class="built_in">NSFileManager</span> * fileManager = [<span class="built_in">NSFileManager</span> defaultManager];</span><br><span class="line"></span><br><span class="line">    [fileManager moveItemAtPath:location<span class="variable">.path</span> toPath:filePath error:<span class="literal">nil</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span><br><span class="line"> *  æ¯æ¬¡å†™å…¥æ²™ç›’å®Œæ¯•</span><br><span class="line"> *  åœ¨è¿™é‡Œé¢ç›‘å¬ä¸‹è½½è¿›åº¦ï¼ŒtotalBytesWritten/totalBytesExpectedToWrite</span><br><span class="line"> *</span><br><span class="line"> *  @param bytesWritten              è¿™æ¬¡å†™å…¥çš„å¤§å°</span><br><span class="line"> *  @param totalBytesWritten         å·²ç»å†™å…¥æ²™ç›’çš„å¤§å°</span><br><span class="line"> *  @param totalBytesExpectedToWrite æ–‡ä»¶æ€»å¤§å°</span><br><span class="line"> */</span></span><br><span class="line">- (<span class="keyword">void</span>)URLSession:(<span class="built_in">NSURLSession</span> *)session downloadTask:(<span class="built_in">NSURLSessionDownloadTask</span> *)downloadTask</span><br><span class="line">      didWriteData:(int64_t)bytesWritten</span><br><span class="line"> totalBytesWritten:(int64_t)totalBytesWritten</span><br><span class="line">totalBytesExpectedToWrite:(int64_t)totalBytesExpectedToWrite</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">self</span><span class="variable">.progressView</span><span class="variable">.progress</span> = (<span class="keyword">double</span>)totalBytesWritten/totalBytesExpectedToWrite;</span><br><span class="line">    <span class="keyword">self</span><span class="variable">.progressLabel</span><span class="variable">.text</span> = [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"%.1f%%"</span>,(<span class="keyword">double</span>)totalBytesWritten/totalBytesExpectedToWrite * <span class="number">100</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> *  æ¢å¤ä¸‹è½½åè°ƒç”¨ï¼Œ</span><br><span class="line"> */</span></span><br><span class="line">- (<span class="keyword">void</span>)URLSession:(<span class="built_in">NSURLSession</span> *)session downloadTask:(<span class="built_in">NSURLSessionDownloadTask</span> *)downloadTask</span><br><span class="line"> didResumeAtOffset:(int64_t)fileOffset</span><br><span class="line">expectedTotalBytes:(int64_t)expectedTotalBytes</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#pragma mark - PrivateMethod</span></span><br><span class="line">- (<span class="keyword">void</span>)saveToFile&#123;</span><br><span class="line">    <span class="built_in">NSString</span> * cacheDirectory = [<span class="built_in">NSSearchPathForDirectoriesInDomains</span>(<span class="built_in">NSCachesDirectory</span>, <span class="built_in">NSUserDomainMask</span>, <span class="literal">YES</span>) lastObject];</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>,cacheDirectory);</span><br><span class="line">    <span class="built_in">NSString</span> * filePath = [cacheDirectory stringByAppendingPathComponent:<span class="keyword">self</span><span class="variable">.fileName</span>];</span><br><span class="line">    <span class="built_in">NSFileManager</span> * fileManager = [<span class="built_in">NSFileManager</span> defaultManager];</span><br><span class="line">    [fileManager createFileAtPath:filePath contents:<span class="literal">nil</span> attributes:<span class="literal">nil</span>];</span><br><span class="line">    <span class="comment">//åˆ›å»ºæ“ä½œæ•°æ®çš„æ–‡ä»¶handler</span></span><br><span class="line">    <span class="keyword">self</span><span class="variable">.fileHandler</span> = [<span class="built_in">NSFileHandle</span> fileHandleForWritingAtPath:filePath];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ›´å¤šä¿¡æ¯è¯·æŸ¥çœ‹<a href="http://developer.apple.com/library/ios/documentation/Foundation/Reference/NSURLSession_class/index.html" target="_blank" rel="external">NSURLSessionå®˜æ–¹æ–‡æ¡£</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>NSURLSessionæ˜¯Appleè‡ªiOS7.0ä¹‹ååŠ å…¥åˆ°Cocoa SDKä¸­ï¼Œç”¨ä»¥æ›¿ä»£NSURLConnectionã€‚å®ƒæ‹¥æœ‰æ›´ç®€æ´æ˜“æ‡‚çš„APIæ–¹æ³•ã€‚<br>iOSä¸­å¸¸ç”¨çš„ç½‘ç»œåº“ä¾‹å¦‚AFNetworkingåœ¨3.0ç‰ˆæœ¬ä¸­å°±å…¨éƒ¨æ›¿æ¢ä¸ºäº†NSURLSessionã€‚<br>]]>
    
    </summary>
    
      <category term="NSURLSession" scheme="http://koalahl.github.io/tags/NSURLSession/"/>
    
      <category term="iOS" scheme="http://koalahl.github.io/categories/iOS/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[NS_ENUMä¸NSString]]></title>
    <link href="http://koalahl.github.io/2016/01/07/NS-ENUM%E4%B8%8ENSString/"/>
    <id>http://koalahl.github.io/2016/01/07/NS-ENUMä¸NSString/</id>
    <published>2016-01-07T09:39:07.000Z</published>
    <updated>2016-01-07T09:39:07.000Z</updated>
    <content type="html"><![CDATA[<h3>NS_ENUMä¸NSString</h3>

<p>åœ¨é¡¹ç›®ä¸­ç»å¸¸ä¼šä½¿ç”¨åˆ°æšä¸¾ç±»å‹ï¼š<code>NS_ENUM</code>,<code>enum</code>,ä½†æ˜¯ç³»ç»Ÿæä¾›çš„æšä¸¾ç±»å‹åªèƒ½è®¾ç½®ä¸ºNSIntegerç±»å‹ï¼Œä¸èƒ½ä¿å­˜å¯¹è±¡ç±»å‹å…¥<code>NSString</code>ã€‚<br>ä¼ ç»Ÿçš„ç”¨<code>#define</code> æ–¹å¼ï¼Œ<code>Switch case</code> è½¬æ¢æ–¹å¼ï¼Œå¦å¤–è¿˜å‘ç°äº†å¦‚ä¸‹å‡ ç§æ–¹å¼ï¼š</p>
<a id="more"></a>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span> &#123;value1, value2, value3&#125; myValue;</span><br><span class="line"><span class="preprocessor">#define myValueString(enum) [@[@<span class="title">"value1"</span>,@<span class="title">"value2"</span>,@<span class="title">"value3"</span>] objectAtIndex:enum]</span></span><br></pre></td></tr></table></figure>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span> &#123; a, b, c &#125; FirstThreeAlpha;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">NSString</span>*) convertToString:(FirstThreeAlpha) whichAlpha &#123;</span><br><span class="line">    <span class="built_in">NSString</span> *result = <span class="literal">nil</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">switch</span>(whichAlpha) &#123;</span><br><span class="line">        <span class="keyword">case</span> a:</span><br><span class="line">            result = <span class="string">@"a"</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> b:</span><br><span class="line">            result = <span class="string">@"b"</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> c:</span><br><span class="line">            result = <span class="string">@"c"</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            result = <span class="string">@"unknown"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="built_in">NS_ENUM</span>(<span class="built_in">NSInteger</span>,CabinetOperationType)&#123;</span><br><span class="line">    CabinetOperationTypeNothing = <span class="number">0</span>,</span><br><span class="line">    CabinetOperationTypeAdd     = <span class="number">1</span>,    <span class="comment">//åŠ å…¥é…’æŸœ</span></span><br><span class="line">    CabinetOperationTypeTake    = <span class="number">2</span>,       <span class="comment">//ä»é…’æŸœæé…’</span></span><br><span class="line">    CabinetOperationTypeAddAndSend = <span class="number">3</span> <span class="comment">//åŠ å…¥é…’æŸœä»˜æ¬¾å¹¶ç›´æ¥èµ äºˆæŸäºº</span></span><br><span class="line">    </span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">NSString</span> *<span class="keyword">const</span> CabinetOperationTypeString[] = &#123;</span><br><span class="line">    [CabinetOperationTypeNothing]    = <span class="string">@""</span>,</span><br><span class="line">    [CabinetOperationTypeAdd]        = <span class="string">@"1"</span>,</span><br><span class="line">    [CabinetOperationTypeTake]       = <span class="string">@"2"</span>,</span><br><span class="line">    [CabinetOperationTypeAddAndSend] = <span class="string">@"3"</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>æ­¤æ³•å’Œä¸Šé¢çš„å®šä¹‰NSStringæ•°ç»„ç›¸ä¼¼ï¼Œä½†æ˜¯æ˜¯ç”¨äº†å‡½æ•°æ€æƒ³ã€‚<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span> &#123;</span><br><span class="line">    <span class="built_in">UIImageOrientationUp</span> = <span class="number">0</span>,            <span class="comment">// default orientation, set to 0 so that it always starts from 0</span></span><br><span class="line">    <span class="built_in">UIImageOrientationDown</span>,          <span class="comment">// 180 deg rotation</span></span><br><span class="line">    <span class="built_in">UIImageOrientationLeft</span>,          <span class="comment">// 90 deg CCW</span></span><br><span class="line">    <span class="built_in">UIImageOrientationRight</span>,         <span class="comment">// 90 deg CW</span></span><br><span class="line">    <span class="built_in">UIImageOrientationUpMirrored</span>,    <span class="comment">// as above but image mirrored along other axis. horizontal flip</span></span><br><span class="line">    <span class="built_in">UIImageOrientationDownMirrored</span>,  <span class="comment">// horizontal flip</span></span><br><span class="line">    <span class="built_in">UIImageOrientationLeftMirrored</span>,  <span class="comment">// vertical flip</span></span><br><span class="line">    <span class="built_in">UIImageOrientationRightMirrored</span>, <span class="comment">// vertical flip</span></span><br><span class="line">&#125; <span class="built_in">UIImageOrientation</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">NSString</span> *stringWith<span class="built_in">UIImageOrientation</span>(<span class="built_in">UIImageOrientation</span> input) &#123;</span><br><span class="line">    <span class="built_in">NSArray</span> *arr = @[</span><br><span class="line">    <span class="string">@"UIImageOrientationUp"</span>,            <span class="comment">// default orientation</span></span><br><span class="line">    <span class="string">@"UIImageOrientationDown"</span>,          <span class="comment">// 180 deg rotation</span></span><br><span class="line">    <span class="string">@"UIImageOrientationLeft"</span>,          <span class="comment">// 90 deg CCW</span></span><br><span class="line">    <span class="string">@"UIImageOrientationRight"</span>,         <span class="comment">// 90 deg CW</span></span><br><span class="line">    <span class="string">@"UIImageOrientationUpMirrored"</span>,    <span class="comment">// as above but image mirrored along other axis. horizontal flip</span></span><br><span class="line">    <span class="string">@"UIImageOrientationDownMirrored"</span>,  <span class="comment">// horizontal flip</span></span><br><span class="line">    <span class="string">@"UIImageOrientationLeftMirrored"</span>,  <span class="comment">// vertical flip</span></span><br><span class="line">    <span class="string">@"UIImageOrientationRightMirrored"</span>, <span class="comment">// vertical flip</span></span><br><span class="line">    ];</span><br><span class="line">    <span class="keyword">return</span> (<span class="built_in">NSString</span> *)[arr objectAtIndex:input];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>ç»¼åˆä¼—å¤šæ–¹æ¡ˆå¾—å‡ºï¼Œè¦ç†Ÿç»ƒä½¿ç”¨<code>typedefã€#define</code> å°±å¯ä»¥æé«˜æ•ˆç‡ã€‚<br>æ›´å¤šå¯ä»¥å‚è€ƒstackoverflowï¼š<a href="http://stackoverflow.com/questions/6331762/enum-values-to-nsstring-ios" target="_blank" rel="external">enum Values to NSString (iOS)</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<h3>NS_ENUMä¸NSString</h3>

<p>åœ¨é¡¹ç›®ä¸­ç»å¸¸ä¼šä½¿ç”¨åˆ°æšä¸¾ç±»å‹ï¼š<code>NS_ENUM</code>,<code>enum</code>,ä½†æ˜¯ç³»ç»Ÿæä¾›çš„æšä¸¾ç±»å‹åªèƒ½è®¾ç½®ä¸ºNSIntegerç±»å‹ï¼Œä¸èƒ½ä¿å­˜å¯¹è±¡ç±»å‹å…¥<code>NSString</code>ã€‚<br>ä¼ ç»Ÿçš„ç”¨<code>#define</code> æ–¹å¼ï¼Œ<code>Switch case</code> è½¬æ¢æ–¹å¼ï¼Œå¦å¤–è¿˜å‘ç°äº†å¦‚ä¸‹å‡ ç§æ–¹å¼ï¼š</p>]]>
    
    </summary>
    
      <category term="NSString" scheme="http://koalahl.github.io/tags/NSString/"/>
    
      <category term="NS_ENUM" scheme="http://koalahl.github.io/tags/NS-ENUM/"/>
    
      <category term="iOS" scheme="http://koalahl.github.io/categories/iOS/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[å¦‚ä½•åœ¨swifté¡¹ç›®ä¸­åˆ›å»ºObjective-C Bridging header]]></title>
    <link href="http://koalahl.github.io/2015/12/30/%E5%A6%82%E4%BD%95%E5%9C%A8swift%E9%A1%B9%E7%9B%AE%E4%B8%AD%E5%88%9B%E5%BB%BAObjective-C-Bridging-header/"/>
    <id>http://koalahl.github.io/2015/12/30/å¦‚ä½•åœ¨swifté¡¹ç›®ä¸­åˆ›å»ºObjective-C-Bridging-header/</id>
    <published>2015-12-30T08:24:16.000Z</published>
    <updated>2015-12-30T08:24:16.000Z</updated>
    <content type="html"><![CDATA[<p>åœ¨swiftå·¥ç¨‹ä¸­ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬ä¹Ÿéœ€è¦ä½¿ç”¨OBJCä»£ç å†™çš„ç¬¬ä¸‰æ–¹åº“æˆ–è€…å·¥å…·ç±»ç­‰ï¼Œè¿™æ—¶å°±éœ€è¦åˆ›å»ºobjcæ–‡ä»¶åˆ°swiftçš„æ¡¥æ¥headerã€‚<br>ç°åœ¨æœ‰ä¸¤ç§æ–¹æ³•åˆ›å»ºObjective-C Bridging Header:<br><a id="more"></a></p>
<p></p><h3 id="header">Create Objective-C File as Header</h3><br>Go to <code>File &gt; New &gt; File</code> and Select Objective-C:<p></p>
<p><img src="/img/Swift-Create-Objective-C-Bridging-Header.png" alt="Create Objective-C File as Header"><br>ç„¶åä¸€ç›´nextï¼Œæœ€åå‡ºç°å¦‚ä¸‹å›¾æ—¶ï¼Œç‚¹å‡»yesï¼š</p>
<p><img src="/img/create-objective-c-bridging-header-question.png" alt=""></p>
<p>è¿™ç§æ–¹å¼ä¼šåˆ›å»ºå‡º.hå’Œ.mæ–‡ä»¶ã€‚</p>
<p></p><h3 id="headerDirectly"> Create Objective-C Header File Directly</h3><br>Go to <code>File &gt; New &gt; File</code> and Select Objective-C Header File:<p></p>
<p><img src="/img/Xcode-Choose-Header-File.png" alt="Create Objective-C Header File Directly"></p>
<p>æœ€åï¼Œä¸¤ç§æ–¹æ³•åˆ›å»ºçš„.hæ–‡ä»¶ä¸­importä½ å°†ä½¿ç”¨çš„ç±»ã€‚<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#import <span class="title">"xxxx"</span></span></span><br></pre></td></tr></table></figure></p>
<p>ä¸€èˆ¬åœ¨é¡¹ç›®ä¸­æˆ‘ä»¬ä½¿ç”¨ç¬¬äºŒç§æ–¹æ³•ã€‚</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>åœ¨swiftå·¥ç¨‹ä¸­ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬ä¹Ÿéœ€è¦ä½¿ç”¨OBJCä»£ç å†™çš„ç¬¬ä¸‰æ–¹åº“æˆ–è€…å·¥å…·ç±»ç­‰ï¼Œè¿™æ—¶å°±éœ€è¦åˆ›å»ºobjcæ–‡ä»¶åˆ°swiftçš„æ¡¥æ¥headerã€‚<br>ç°åœ¨æœ‰ä¸¤ç§æ–¹æ³•åˆ›å»ºObjective-C Bridging Header:<br>]]>
    
    </summary>
    
      <category term="Objc Bridging Header" scheme="http://koalahl.github.io/tags/Objc-Bridging-Header/"/>
    
      <category term="swift" scheme="http://koalahl.github.io/tags/swift/"/>
    
      <category term="iOS" scheme="http://koalahl.github.io/categories/iOS/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[ä¿®æ”¹UIBarButtonItemæ ‡é¢˜æ–‡å­—å¤§å°ã€é¢œè‰²ã€é˜´å½±ç­‰]]></title>
    <link href="http://koalahl.github.io/2015/12/29/%E4%BF%AE%E6%94%B9UIBarButtonItem%E6%A0%87%E9%A2%98%E6%96%87%E5%AD%97%E5%A4%A7%E5%B0%8F%E3%80%81%E9%A2%9C%E8%89%B2%E3%80%81%E9%98%B4%E5%BD%B1%E7%AD%89/"/>
    <id>http://koalahl.github.io/2015/12/29/ä¿®æ”¹UIBarButtonItemæ ‡é¢˜æ–‡å­—å¤§å°ã€é¢œè‰²ã€é˜´å½±ç­‰/</id>
    <published>2015-12-29T06:57:36.000Z</published>
    <updated>2015-12-29T06:57:36.000Z</updated>
    <content type="html"><![CDATA[<p></p><h3>ä¿®æ”¹UIBarButtonItemçš„æ ‡é¢˜æ–‡å­—å¤§å°ã€é¢œè‰²ã€é˜´å½±ç­‰</h3><br>æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦è®¾ç½®ä¸€ä¸‹å¯¼èˆªæ å³ä¾§æŒ‰é’®æ ‡é¢˜çš„å¤§å°ã€é¢œè‰²ç­‰ç­‰ï¼Œä½†æ˜¯UIBarButtonItemæ²¡æœ‰ç›´æ¥æä¾›ç›¸å…³æ–¹æ³•ã€‚é€šè¿‡æŸ¥çœ‹UIbarButtonItemå®˜æ–¹æ–‡æ¡£ï¼Œæ€»ç»“å‡ºæœ‰ä»¥ä¸‹ä¸¤ç§æ–¹æ³•<br>ç¬¬ä¸€ç§ï¼šä½¿ç”¨<code>initWithCustomView</code>æ–¹æ³•åˆ›å»ºUIBarButtonItemã€‚<br>ç¬¬äºŒç§ï¼šé€šè¿‡KVCæ¥ä¿®æ”¹ç›¸å…³å±æ€§ã€‚<p></p>
<a id="more"></a>
<p>é‚£ä¹ˆå…ˆçœ‹çœ‹ç¬¬ä¸€ç§æ–¹æ³•ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">UIButton</span> * edit = [<span class="built_in">UIButton</span> buttonWithType:<span class="built_in">UIButtonTypeCustom</span>];</span><br><span class="line">edit<span class="variable">.frame</span> = <span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">80</span>, <span class="number">30</span>);</span><br><span class="line">[edit setTitle:<span class="string">@"æ‰¹é‡ç®¡ç†"</span> forState:<span class="built_in">UIControlStateNormal</span>];</span><br><span class="line">[edit setTitleColor:[<span class="built_in">UIColor</span> blackColor] forState:<span class="built_in">UIControlStateNormal</span>];</span><br><span class="line">[edit addTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(edit) forControlEvents:<span class="built_in">UIControlEventTouchUpInside</span>];</span><br><span class="line">edit<span class="variable">.titleLabel</span><span class="variable">.font</span> = [<span class="built_in">UIFont</span> systemFontOfSize:<span class="number">13</span>];</span><br><span class="line">edit<span class="variable">.titleLabel</span><span class="variable">.textAlignment</span> = <span class="built_in">NSTextAlignmentRight</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">UIBarButtonItem</span> * rightBtn = [[<span class="built_in">UIBarButtonItem</span> alloc]initWithCustomView:edit];</span><br><span class="line">[rightBtn setTintColor:COLOR(black)];</span><br><span class="line"><span class="keyword">self</span><span class="variable">.navigationItem</span><span class="variable">.rightBarButtonItem</span> = rightBtn;</span><br></pre></td></tr></table></figure></p>
<p>è¿™ç§æ–¹æ³•æ¯”è¾ƒç®€ä¾¿ï¼Œèƒ½å¤Ÿå¿«é€Ÿç†è§£ã€‚</p>
<p>ç¬¬äºŒç§æ–¹æ³•ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">UIBarButtonItem</span> * submitComment = [[<span class="built_in">UIBarButtonItem</span> alloc] initWithTitle:<span class="string">@"æäº¤è¯„ä»·"</span> </span><br><span class="line">                                    style:<span class="built_in">UIBarButtonItemStylePlain</span> </span><br><span class="line">                                    target:<span class="keyword">self</span> </span><br><span class="line">                                    action:<span class="keyword">@selector</span>(submitComment:)];</span><br><span class="line">submitComment<span class="variable">.tintColor</span> = [<span class="built_in">UIColor</span> darkGrayColor];</span><br><span class="line">[[<span class="built_in">UIBarButtonItem</span> appearance] setTitleTextAttributes:</span><br><span class="line">                                [<span class="built_in">NSDictionary</span> dictionaryWithObjectsAndKeys:[<span class="built_in">UIFont</span> boldSystemFontOfSize:<span class="number">15</span>], <span class="built_in">NSFontAttributeName</span>, <span class="literal">nil</span>] </span><br><span class="line">                                forState:<span class="built_in">UIControlStateNormal</span>];</span><br></pre></td></tr></table></figure></p>
<p>Also,å¯ä»¥ä½¿ç”¨å¦‚ä¸‹æ–¹æ³•ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[[<span class="built_in">UIBarButtonItem</span> appearanceWhenContainedIn:[<span class="built_in">UINavigationController</span> class], <span class="literal">nil</span>] </span><br><span class="line">                                            setTitleTextAttributes:[<span class="built_in">NSDictionary</span> dictionaryWithObjectsAndKeys:</span><br><span class="line">                                            [<span class="built_in">UIFont</span> boldSystemFontOfSize:<span class="number">15</span>], <span class="built_in">NSFontAttributeName</span>, <span class="literal">nil</span>] </span><br><span class="line">                                            forState:<span class="built_in">UIControlStateNormal</span>];</span><br></pre></td></tr></table></figure></p>
<p>å…¶ä¸­å¯¹äºè¿™äº›keyéœ€è¦çœ‹ä¸€ä¸‹ï¼Œå¸¸ç”¨çš„å‡ ä¸ªkeyå·²ç»è¢«<code>NSFontAttributeName, NSForegroundColorAttributeName, NSShadowAttributeName</code>ä»£æ›¿:<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Keys for text attributes dictionaries.</span><br><span class="line"> These keys are superseded by the corresponding attribute name keys (NSFontAttributeName, NSForegroundColorAttributeName, NSShadowAttributeName)</span><br><span class="line"> in NSAttributedString.h.</span><br><span class="line"> */</span></span><br><span class="line"><span class="comment">// Key to the font in the text attributes dictionary. A UIFont instance is expected. Use a font with size 0.0 to get the default font size for the situation.</span></span><br><span class="line"><span class="built_in">UIKIT_EXTERN</span> <span class="built_in">NSString</span> *<span class="keyword">const</span> <span class="built_in">UITextAttributeFont</span> <span class="built_in">NS_DEPRECATED_IOS</span>(<span class="number">5</span>_0, <span class="number">7</span>_0, <span class="string">"Use NSFontAttributeName"</span>) __TVOS_PROHIBITED;</span><br><span class="line"><span class="comment">// Key to the text color in the text attributes dictionary. A UIColor instance is expected.</span></span><br><span class="line"><span class="built_in">UIKIT_EXTERN</span> <span class="built_in">NSString</span> *<span class="keyword">const</span> <span class="built_in">UITextAttributeTextColor</span> <span class="built_in">NS_DEPRECATED_IOS</span>(<span class="number">5</span>_0, <span class="number">7</span>_0, <span class="string">"Use NSForegroundColorAttributeName"</span>) __TVOS_PROHIBITED;</span><br><span class="line"><span class="comment">// Key to the text shadow color in the text attributes dictionary.  A UIColor instance is expected.</span></span><br><span class="line"><span class="built_in">UIKIT_EXTERN</span> <span class="built_in">NSString</span> *<span class="keyword">const</span> <span class="built_in">UITextAttributeTextShadowColor</span> <span class="built_in">NS_DEPRECATED_IOS</span>(<span class="number">5</span>_0, <span class="number">7</span>_0, <span class="string">"Use NSShadowAttributeName with an NSShadow instance as the value"</span>) __TVOS_PROHIBITED;</span><br><span class="line"><span class="comment">// Key to the offset used for the text shadow in the text attributes dictionary. An NSValue instance wrapping a UIOffset struct is expected.</span></span><br><span class="line"><span class="built_in">UIKIT_EXTERN</span> <span class="built_in">NSString</span> *<span class="keyword">const</span> <span class="built_in">UITextAttributeTextShadowOffset</span> <span class="built_in">NS_DEPRECATED_IOS</span>(<span class="number">5</span>_0, <span class="number">7</span>_0, <span class="string">"Use NSShadowAttributeName with an NSShadow instance as the value"</span>) __TVOS_PROHIBITED;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/************************ Attributes ************************/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Predefined character attributes for text. If the key is not in the dictionary, then use the default values as described below.</span></span><br><span class="line"><span class="built_in">UIKIT_EXTERN</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> <span class="built_in">NSFontAttributeName</span> <span class="built_in">NS_AVAILABLE</span>(<span class="number">10</span>_0, <span class="number">6</span>_0);                <span class="comment">// UIFont, default Helvetica(Neue) 12</span></span><br><span class="line"><span class="built_in">UIKIT_EXTERN</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> <span class="built_in">NSParagraphStyleAttributeName</span> <span class="built_in">NS_AVAILABLE</span>(<span class="number">10</span>_0, <span class="number">6</span>_0);      <span class="comment">// NSParagraphStyle, default defaultParagraphStyle</span></span><br><span class="line"><span class="built_in">UIKIT_EXTERN</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> <span class="built_in">NSForegroundColorAttributeName</span> <span class="built_in">NS_AVAILABLE</span>(<span class="number">10</span>_0, <span class="number">6</span>_0);     <span class="comment">// UIColor, default blackColor</span></span><br><span class="line"><span class="built_in">UIKIT_EXTERN</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> <span class="built_in">NSBackgroundColorAttributeName</span> <span class="built_in">NS_AVAILABLE</span>(<span class="number">10</span>_0, <span class="number">6</span>_0);     <span class="comment">// UIColor, default nil: no background</span></span><br><span class="line"><span class="built_in">UIKIT_EXTERN</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> <span class="built_in">NSLigatureAttributeName</span> <span class="built_in">NS_AVAILABLE</span>(<span class="number">10</span>_0, <span class="number">6</span>_0);            <span class="comment">// NSNumber containing integer, default 1: default ligatures, 0: no ligatures</span></span><br><span class="line"><span class="built_in">UIKIT_EXTERN</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> <span class="built_in">NSKernAttributeName</span> <span class="built_in">NS_AVAILABLE</span>(<span class="number">10</span>_0, <span class="number">6</span>_0);                <span class="comment">// NSNumber containing floating point value, in points; amount to modify default kerning. 0 means kerning is disabled.</span></span><br><span class="line"><span class="built_in">UIKIT_EXTERN</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> <span class="built_in">NSStrikethroughStyleAttributeName</span> <span class="built_in">NS_AVAILABLE</span>(<span class="number">10</span>_0, <span class="number">6</span>_0);  <span class="comment">// NSNumber containing integer, default 0: no strikethrough</span></span><br><span class="line"><span class="built_in">UIKIT_EXTERN</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> <span class="built_in">NSUnderlineStyleAttributeName</span> <span class="built_in">NS_AVAILABLE</span>(<span class="number">10</span>_0, <span class="number">6</span>_0);      <span class="comment">// NSNumber containing integer, default 0: no underline</span></span><br><span class="line"><span class="built_in">UIKIT_EXTERN</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> <span class="built_in">NSStrokeColorAttributeName</span> <span class="built_in">NS_AVAILABLE</span>(<span class="number">10</span>_0, <span class="number">6</span>_0);         <span class="comment">// UIColor, default nil: same as foreground color</span></span><br><span class="line"><span class="built_in">UIKIT_EXTERN</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> <span class="built_in">NSStrokeWidthAttributeName</span> <span class="built_in">NS_AVAILABLE</span>(<span class="number">10</span>_0, <span class="number">6</span>_0);         <span class="comment">// NSNumber containing floating point value, in percent of font point size, default 0: no stroke; positive for stroke alone, negative for stroke and fill (a typical value for outlined text would be 3.0)</span></span><br><span class="line"><span class="built_in">UIKIT_EXTERN</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> <span class="built_in">NSShadowAttributeName</span> <span class="built_in">NS_AVAILABLE</span>(<span class="number">10</span>_0, <span class="number">6</span>_0);              <span class="comment">// NSShadow, default nil: no shadow</span></span><br><span class="line"><span class="built_in">UIKIT_EXTERN</span> <span class="built_in">NSString</span> *<span class="keyword">const</span> <span class="built_in">NSTextEffectAttributeName</span> <span class="built_in">NS_AVAILABLE</span>(<span class="number">10</span>_10, <span class="number">7</span>_0);          <span class="comment">// NSString, default nil: no text effect</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">UIKIT_EXTERN</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> <span class="built_in">NSAttachmentAttributeName</span> <span class="built_in">NS_AVAILABLE</span>(<span class="number">10</span>_0, <span class="number">7</span>_0);          <span class="comment">// NSTextAttachment, default nil</span></span><br><span class="line"><span class="built_in">UIKIT_EXTERN</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> <span class="built_in">NSLinkAttributeName</span> <span class="built_in">NS_AVAILABLE</span>(<span class="number">10</span>_0, <span class="number">7</span>_0);                <span class="comment">// NSURL (preferred) or NSString</span></span><br><span class="line"><span class="built_in">UIKIT_EXTERN</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> <span class="built_in">NSBaselineOffsetAttributeName</span> <span class="built_in">NS_AVAILABLE</span>(<span class="number">10</span>_0, <span class="number">7</span>_0);      <span class="comment">// NSNumber containing floating point value, in points; offset from baseline, default 0</span></span><br><span class="line"><span class="built_in">UIKIT_EXTERN</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> <span class="built_in">NSUnderlineColorAttributeName</span> <span class="built_in">NS_AVAILABLE</span>(<span class="number">10</span>_0, <span class="number">7</span>_0);      <span class="comment">// UIColor, default nil: same as foreground color</span></span><br><span class="line"><span class="built_in">UIKIT_EXTERN</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> <span class="built_in">NSStrikethroughColorAttributeName</span> <span class="built_in">NS_AVAILABLE</span>(<span class="number">10</span>_0, <span class="number">7</span>_0);  <span class="comment">// UIColor, default nil: same as foreground color</span></span><br><span class="line"><span class="built_in">UIKIT_EXTERN</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> <span class="built_in">NSObliquenessAttributeName</span> <span class="built_in">NS_AVAILABLE</span>(<span class="number">10</span>_0, <span class="number">7</span>_0);         <span class="comment">// NSNumber containing floating point value; skew to be applied to glyphs, default 0: no skew</span></span><br><span class="line"><span class="built_in">UIKIT_EXTERN</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> <span class="built_in">NSExpansionAttributeName</span> <span class="built_in">NS_AVAILABLE</span>(<span class="number">10</span>_0, <span class="number">7</span>_0);           <span class="comment">// NSNumber containing floating point value; log of expansion factor to be applied to glyphs, default 0: no expansion</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">UIKIT_EXTERN</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> <span class="built_in">NSWritingDirectionAttributeName</span> <span class="built_in">NS_AVAILABLE</span>(<span class="number">10</span>_6, <span class="number">7</span>_0);    <span class="comment">// NSArray of NSNumbers representing the nested levels of writing direction overrides as defined by Unicode LRE, RLE, LRO, and RLO characters.  The control characters can be obtained by masking NSWritingDirection and NSTextWritingDirection values.  LRE: NSWritingDirectionLeftToRight|NSWritingDirectionEmbedding, RLE: NSWritingDirectionRightToLeft|NSWritingDirectionEmbedding, LRO: NSWritingDirectionLeftToRight|NSWritingDirectionOverride, RLO: NSWritingDirectionRightToLeft|NSWritingDirectionOverride,</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">UIKIT_EXTERN</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> <span class="built_in">NSVerticalGlyphFormAttributeName</span> <span class="built_in">NS_AVAILABLE</span>(<span class="number">10</span>_7, <span class="number">6</span>_0);   <span class="comment">// An NSNumber containing an integer value.  0 means horizontal text.  1 indicates vertical text.  If not specified, it could follow higher-level vertical orientation settings.  Currently on iOS, it's always horizontal.  The behavior for any other value is undefined.</span></span><br></pre></td></tr></table></figure>
]]></content>
    <summary type="html">
    <![CDATA[<p><h3>ä¿®æ”¹UIBarButtonItemçš„æ ‡é¢˜æ–‡å­—å¤§å°ã€é¢œè‰²ã€é˜´å½±ç­‰</h3><br>æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦è®¾ç½®ä¸€ä¸‹å¯¼èˆªæ å³ä¾§æŒ‰é’®æ ‡é¢˜çš„å¤§å°ã€é¢œè‰²ç­‰ç­‰ï¼Œä½†æ˜¯UIBarButtonItemæ²¡æœ‰ç›´æ¥æä¾›ç›¸å…³æ–¹æ³•ã€‚é€šè¿‡æŸ¥çœ‹UIbarButtonItemå®˜æ–¹æ–‡æ¡£ï¼Œæ€»ç»“å‡ºæœ‰ä»¥ä¸‹ä¸¤ç§æ–¹æ³•<br>ç¬¬ä¸€ç§ï¼šä½¿ç”¨<code>initWithCustomView</code>æ–¹æ³•åˆ›å»ºUIBarButtonItemã€‚<br>ç¬¬äºŒç§ï¼šé€šè¿‡KVCæ¥ä¿®æ”¹ç›¸å…³å±æ€§ã€‚</p>]]>
    
    </summary>
    
      <category term="UIBarButtonItem" scheme="http://koalahl.github.io/tags/UIBarButtonItem/"/>
    
      <category term="iOS" scheme="http://koalahl.github.io/categories/iOS/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Blockå®ç°åŸç†]]></title>
    <link href="http://koalahl.github.io/2015/12/16/Block%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86/"/>
    <id>http://koalahl.github.io/2015/12/16/Blockå®ç°åŸç†/</id>
    <published>2015-12-16T13:11:51.000Z</published>
    <updated>2015-12-16T13:11:51.000Z</updated>
    <content type="html"><![CDATA[<p>Blockä¸€ç›´æ˜¯iOSå¼€å‘ä¸­å¸¸ç”¨çš„æŠ€å·§ï¼Œç±»ä¼¼äºCè¯­è¨€ä¸­çš„æŒ‡é’ˆå‡½æ•°ã€‚å¤šç”¨äºå‚æ•°å›è°ƒï¼Œå¼‚æ­¥åŠ è½½ç­‰ã€‚ä¸‹é¢å°±æ¥æ¢ç©¶ä»¥ä¸‹blockæ˜¯å¦‚ä½•å®ç°çš„ã€‚<br>è¿™ç¯‡æ˜¯è®°å½•æ ¹æ®ç½‘ä¸Šçš„æ–‡ç« è¿›è¡Œçš„å®é™…æ“ä½œã€‚Cå‡½æ•°çš„ç”Ÿæˆä¸­é—´ç¼–è¯‘ä»£ç çš„ç¼–è¯‘æ–¹æ³•æ˜¯clang -rewrite-objc xxxx.cã€‚ç”±äºç¼–è¯‘æ–‡ä»¶ä¸­å†…å®¹è¾ƒå¤šï¼Œè¿™é‡Œæˆ‘ä»¬åªæˆªå–æœ‰å…³blockçš„éƒ¨åˆ†ã€‚</p>
<p>é¦–å…ˆï¼Œçœ‹çœ‹æ²¡æœ‰blockçš„Cå‡½æ•°ä»¥åŠç¼–è¯‘åçš„ç»“æœï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#include <span class="title">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> main()&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>ç¼–è¯‘ä»£ç ä¸­çš„blockï¼šè¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸€ä¸ªblockçš„Cå®ç°ã€‚<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#ifndef BLOCK_IMPL</span></span><br><span class="line"><span class="preprocessor">#define BLOCK_IMPL</span></span><br><span class="line"><span class="keyword">struct</span> __block_impl &#123;</span><br><span class="line">  <span class="keyword">void</span> *isa;</span><br><span class="line">  <span class="keyword">int</span> Flags;</span><br><span class="line">  <span class="keyword">int</span> Reserved;</span><br><span class="line">  <span class="keyword">void</span> *FuncPtr;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>*isaè¯´æ˜blockä¹Ÿå¯ä»¥ä½œä¸ºå¯¹è±¡ä½¿ç”¨ï¼ˆä¾‹å¦‚æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªmyBlockç±»å‹çš„block1ï¼‰ï¼ŒæŒ‡é’ˆå˜é‡FunPtråº”è¯¥å°±æ˜¯æŒ‡å‘äº†blockä»£ç å—çš„å‡½æ•°é¦–åœ°å€<br><a id="more"></a><br>æ¥ç€æˆ‘ä»¬åŠ ä¸€ä¸ªblockåˆ°.cæ–‡ä»¶ä¸­ï¼Œå¹¶è¿›è¡Œç¼–è¯‘ã€‚<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#include <span class="title">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> main()&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span>(^myBlock)(<span class="keyword">void</span>) = ^(<span class="keyword">void</span>)&#123;</span><br><span class="line">	printf(<span class="string">"hello world! %d\n"</span>,i);</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line">myBlock();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>ç¼–è¯‘åï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> __main_block_impl_0 &#123;</span><br><span class="line">  <span class="keyword">struct</span> __block_impl impl;</span><br><span class="line">  <span class="keyword">struct</span> __main_block_desc_0* Desc;</span><br><span class="line">  <span class="keyword">int</span> i;</span><br><span class="line">  __main_block_impl_0(<span class="keyword">void</span> *fp, <span class="keyword">struct</span> __main_block_desc_0 *desc, <span class="keyword">int</span> _i, <span class="keyword">int</span> flags=<span class="number">0</span>) : i(_i) &#123;</span><br><span class="line">    impl<span class="variable">.isa</span> = &amp;_<span class="built_in">NSConcreteStackBlock</span>;</span><br><span class="line">    impl<span class="variable">.Flags</span> = flags;</span><br><span class="line">    impl<span class="variable">.FuncPtr</span> = fp;</span><br><span class="line">    Desc = desc;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> __main_block_func_0(<span class="keyword">struct</span> __main_block_impl_0 *__cself) &#123;</span><br><span class="line">  <span class="keyword">int</span> i = __cself-&gt;i; <span class="comment">// bound by copy</span></span><br><span class="line"></span><br><span class="line">  printf(<span class="string">"hello world! %d\n"</span>,i);</span><br><span class="line"></span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">struct</span> __main_block_desc_0 &#123;</span><br><span class="line">  size_t reserved;</span><br><span class="line">  size_t Block_size;</span><br><span class="line">&#125; __main_block_desc_0_DATA = &#123; <span class="number">0</span>, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> __main_block_impl_0)&#125;;</span><br><span class="line"><span class="keyword">int</span> main()&#123;</span><br><span class="line"> <span class="keyword">int</span> i = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">void</span>(*myBlock)(<span class="keyword">void</span>) = (<span class="keyword">void</span> (*)())&amp;__main_block_impl_0((<span class="keyword">void</span> *)__main_block_func_0, &amp;__main_block_desc_0_DATA, i);</span><br><span class="line"></span><br><span class="line"> ((<span class="keyword">void</span> (*)(__block_impl *))((__block_impl *)myBlock)-&gt;FuncPtr)((__block_impl *)myBlock);</span><br><span class="line"></span><br><span class="line"> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>3.å‡å¦‚æˆ‘ä»¬è¦ä¿®æ”¹å‡½æ•°ä¸­å±€éƒ¨å˜é‡çš„å€¼ï¼Œåˆ™éœ€è¦åŠ ä¸Š__blockä¿®é¥°ç¬¦ï¼Œåé¢æˆ‘ä»¬æ¥çœ‹çœ‹ä¸ºä»€ä¹ˆè¿™æ ·æ‰å¯ä»¥ä¿®æ”¹ã€‚<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#include <span class="title">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> main()&#123;</span><br><span class="line">__block <span class="keyword">int</span> i = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span>(^myBlock)(<span class="keyword">void</span>) = ^(<span class="keyword">void</span>)&#123;</span><br><span class="line">i = <span class="number">12</span>;</span><br><span class="line">	printf(<span class="string">"hello world! %d\n"</span>,i);</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line">myBlock();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>ç¼–è¯‘åçš„cppä»£ç ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> __Block_byref_i_0 &#123;</span><br><span class="line">  <span class="keyword">void</span> *__isa;</span><br><span class="line">__Block_byref_i_0 *__forwarding;</span><br><span class="line"> <span class="keyword">int</span> __flags;</span><br><span class="line"> <span class="keyword">int</span> __size;</span><br><span class="line"> <span class="keyword">int</span> i;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> __main_block_impl_0 &#123;</span><br><span class="line">  <span class="keyword">struct</span> __block_impl impl;</span><br><span class="line">  <span class="keyword">struct</span> __main_block_desc_0* Desc;</span><br><span class="line">  __Block_byref_i_0 *i; <span class="comment">// by ref</span></span><br><span class="line">  __main_block_impl_0(<span class="keyword">void</span> *fp, <span class="keyword">struct</span> __main_block_desc_0 *desc, __Block_byref_i_0 *_i, <span class="keyword">int</span> flags=<span class="number">0</span>) : i(_i-&gt;__forwarding) &#123;</span><br><span class="line">    impl<span class="variable">.isa</span> = &amp;_<span class="built_in">NSConcreteStackBlock</span>;</span><br><span class="line">    impl<span class="variable">.Flags</span> = flags;</span><br><span class="line">    impl<span class="variable">.FuncPtr</span> = fp;</span><br><span class="line">    Desc = desc;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> __main_block_func_0(<span class="keyword">struct</span> __main_block_impl_0 *__cself) &#123;</span><br><span class="line">  __Block_byref_i_0 *i = __cself-&gt;i; <span class="comment">// bound by ref</span></span><br><span class="line"></span><br><span class="line">  (i-&gt;__forwarding-&gt;i) = <span class="number">12</span>;</span><br><span class="line">  printf(<span class="string">"hello world! %d\n"</span>,(i-&gt;__forwarding-&gt;i));</span><br><span class="line"></span><br><span class="line"> &#125;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> __main_block_copy_0(<span class="keyword">struct</span> __main_block_impl_0*dst, <span class="keyword">struct</span> __main_block_impl_0*src) &#123;_Block_object_assign((<span class="keyword">void</span>*)&amp;dst-&gt;i, (<span class="keyword">void</span>*)src-&gt;i, <span class="number">8</span><span class="comment">/*BLOCK_FIELD_IS_BYREF*/</span>);&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> __main_block_dispose_0(<span class="keyword">struct</span> __main_block_impl_0*src) &#123;_Block_object_dispose((<span class="keyword">void</span>*)src-&gt;i, <span class="number">8</span><span class="comment">/*BLOCK_FIELD_IS_BYREF*/</span>);&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">struct</span> __main_block_desc_0 &#123;</span><br><span class="line">  size_t reserved;</span><br><span class="line">  size_t Block_size;</span><br><span class="line">  <span class="keyword">void</span> (*<span class="keyword">copy</span>)(<span class="keyword">struct</span> __main_block_impl_0*, <span class="keyword">struct</span> __main_block_impl_0*);</span><br><span class="line">  <span class="keyword">void</span> (*dispose)(<span class="keyword">struct</span> __main_block_impl_0*);</span><br><span class="line">&#125; __main_block_desc_0_DATA = &#123; <span class="number">0</span>, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> __main_block_impl_0), __main_block_copy_0, __main_block_dispose_0&#125;;</span><br><span class="line"><span class="keyword">int</span> main()&#123;</span><br><span class="line"> __attribute__((__blocks__(<span class="keyword">byref</span>))) __Block_byref_i_0 i = &#123;(<span class="keyword">void</span>*)<span class="number">0</span>,(__Block_byref_i_0 *)&amp;i, <span class="number">0</span>, <span class="keyword">sizeof</span>(__Block_byref_i_0), <span class="number">10</span>&#125;;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">void</span>(*myBlock)(<span class="keyword">void</span>) = (<span class="keyword">void</span> (*)())&amp;__main_block_impl_0((<span class="keyword">void</span> *)__main_block_func_0, &amp;__main_block_desc_0_DATA, (__Block_byref_i_0 *)&amp;i, <span class="number">570425344</span>);</span><br><span class="line"></span><br><span class="line"> ((<span class="keyword">void</span> (*)(__block_impl *))((__block_impl *)myBlock)-&gt;FuncPtr)((__block_impl *)myBlock);</span><br><span class="line"></span><br><span class="line"> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>Blockä¸€ç›´æ˜¯iOSå¼€å‘ä¸­å¸¸ç”¨çš„æŠ€å·§ï¼Œç±»ä¼¼äºCè¯­è¨€ä¸­çš„æŒ‡é’ˆå‡½æ•°ã€‚å¤šç”¨äºå‚æ•°å›è°ƒï¼Œå¼‚æ­¥åŠ è½½ç­‰ã€‚ä¸‹é¢å°±æ¥æ¢ç©¶ä»¥ä¸‹blockæ˜¯å¦‚ä½•å®ç°çš„ã€‚<br>è¿™ç¯‡æ˜¯è®°å½•æ ¹æ®ç½‘ä¸Šçš„æ–‡ç« è¿›è¡Œçš„å®é™…æ“ä½œã€‚Cå‡½æ•°çš„ç”Ÿæˆä¸­é—´ç¼–è¯‘ä»£ç çš„ç¼–è¯‘æ–¹æ³•æ˜¯clang -rewrite-objc xxxx.cã€‚ç”±äºç¼–è¯‘æ–‡ä»¶ä¸­å†…å®¹è¾ƒå¤šï¼Œè¿™é‡Œæˆ‘ä»¬åªæˆªå–æœ‰å…³blockçš„éƒ¨åˆ†ã€‚</p>
<p>é¦–å…ˆï¼Œçœ‹çœ‹æ²¡æœ‰blockçš„Cå‡½æ•°ä»¥åŠç¼–è¯‘åçš„ç»“æœï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#include <span class="title">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> main()&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>ç¼–è¯‘ä»£ç ä¸­çš„blockï¼šè¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸€ä¸ªblockçš„Cå®ç°ã€‚<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#ifndef BLOCK_IMPL</span></span><br><span class="line"><span class="preprocessor">#define BLOCK_IMPL</span></span><br><span class="line"><span class="keyword">struct</span> __block_impl &#123;</span><br><span class="line">  <span class="keyword">void</span> *isa;</span><br><span class="line">  <span class="keyword">int</span> Flags;</span><br><span class="line">  <span class="keyword">int</span> Reserved;</span><br><span class="line">  <span class="keyword">void</span> *FuncPtr;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>*isaè¯´æ˜blockä¹Ÿå¯ä»¥ä½œä¸ºå¯¹è±¡ä½¿ç”¨ï¼ˆä¾‹å¦‚æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªmyBlockç±»å‹çš„block1ï¼‰ï¼ŒæŒ‡é’ˆå˜é‡FunPtråº”è¯¥å°±æ˜¯æŒ‡å‘äº†blockä»£ç å—çš„å‡½æ•°é¦–åœ°å€<br>]]>
    
    </summary>
    
      <category term="block" scheme="http://koalahl.github.io/tags/block/"/>
    
      <category term="iOS" scheme="http://koalahl.github.io/categories/iOS/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[TableViewCellæ ¹æ®å†…å®¹è‡ªé€‚åº”é«˜åº¦çš„æ–¹æ³•]]></title>
    <link href="http://koalahl.github.io/2015/12/16/TableViewCell%E6%A0%B9%E6%8D%AE%E5%86%85%E5%AE%B9%E8%87%AA%E9%80%82%E5%BA%94%E9%AB%98%E5%BA%A6%E7%9A%84%E6%96%B9%E6%B3%95/"/>
    <id>http://koalahl.github.io/2015/12/16/TableViewCellæ ¹æ®å†…å®¹è‡ªé€‚åº”é«˜åº¦çš„æ–¹æ³•/</id>
    <published>2015-12-16T12:49:20.000Z</published>
    <updated>2015-12-16T12:49:20.000Z</updated>
    <content type="html"><![CDATA[<p>æœ¬æ–‡åŒæ—¶å‚è€ƒ <a href="http://blog.sunnyxx.com/2015/05/17/cell-height-calculation/" target="_blank" rel="external">http://blog.sunnyxx.com/2015/05/17/cell-height-calculation/</a> </p>
<h2>ä¸€ï¼šæ ¹æ®cellå†…å®¹æ‰‹åŠ¨è®¡ç®—cellé«˜åº¦</h2>

<p>æ— è®ºä½¿ç”¨xibè¿˜æ˜¯ä»£ç å†™æ§ä»¶ï¼Œæ ¸å¿ƒæ€æƒ³éƒ½æ˜¯æ ¹æ®cellä¸­contentå†…å®¹çš„é«˜åº¦æ¥è®¡ç®—cellçš„é«˜åº¦ã€‚<br>1.åœ¨è·å–åˆ°cellæ•°æ®æºçš„æ—¶å€™è®¡ç®—å†…å®¹é«˜åº¦ã€‚å¯ä»¥è®¾ç½®ä¸€ä¸ªsizeå±æ€§ï¼Œç”¨æ¥è®°å½•ã€‚<br>2.å¦‚æœæ˜¯xibï¼Œå»æ‰autolayout<br>3.åœ¨cellForRowAtIndexPathæ–¹æ³•ä¸­å¡«å……cellæ•°æ®çš„æ—¶å€™ï¼Œæ ¹æ®å†…å®¹é«˜åº¦ï¼Œè®¾ç½®æ§ä»¶é«˜åº¦<br>4.åœ¨heightForRowAtIndexpathæ–¹æ³•ä¸­ï¼Œè®¾ç½®æ¯ä¸€ä¸ªcell çš„é«˜åº¦</p>
<h2>äºŒï¼šSelf sizing cell + autolayout</h2>

<p>Self sizing cell æ˜¯iOS8ä¸­æ·»åŠ ä¸€ä¸ªæ–°ç‰¹æ€§ï¼Œç”¨æ¥è‡ªé€‚åº”cellé«˜åº¦ã€‚<br><img src="/img/self sizing cell.jpg" alt="Self Sizing Cell"><br>åŒæ—¶æ‰“å¼€ä»¥ä¸‹å‚æ•°ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">self</span><span class="variable">.tableView</span><span class="variable">.estimatedRowHeight</span> = <span class="number">213</span>;<span class="comment">//æ·»åŠ ä¼°ç®—é«˜åº¦ï¼Œè¦ä¸ç„¶è‡ªåŠ¨ç®—é«˜å¤±æ•ˆï¼Ÿ</span></span><br><span class="line"><span class="keyword">self</span><span class="variable">.tableView</span><span class="variable">.rowHeight</span> = <span class="built_in">UITableViewAutomaticDimension</span>;</span><br></pre></td></tr></table></figure></p>
<h2>ä¸‰ï¼šUITableView+FDTemplateLayoutCell</h2>

<p>ä½¿ç”¨çš„API:<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#import <span class="title">&lt;UITableView+FDTemplateLayoutCell.h&gt;</span> </span></span><br><span class="line">- (<span class="built_in">CGFloat</span>)tableView:(<span class="built_in">UITableView</span> *)tableView heightForRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath &#123; </span><br><span class="line">	<span class="keyword">return</span> [tableView fd_heightForCellWithIdentifier:<span class="string">@"identifer"</span> cacheByIndexPath:indexPath configuration:^(<span class="keyword">id</span> cell)</span><br><span class="line"> 			&#123;</span><br><span class="line">  			<span class="comment">// é…ç½® cell çš„æ•°æ®æºï¼Œå’Œ "cellForRow" å¹²çš„äº‹ä¸€è‡´ï¼Œæ¯”å¦‚ï¼š </span></span><br><span class="line">			  cell<span class="variable">.entity</span> = <span class="keyword">self</span><span class="variable">.feedEntities</span>[indexPath<span class="variable">.row</span>]; </span><br><span class="line">  			&#125;]; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><a href="https://github.com/forkingdog/UITableView-FDTemplateLayoutCell" target="_blank" rel="external">https://github.com/forkingdog/UITableView-FDTemplateLayoutCell</a><br><a id="more"></a></p>
<p>ä¸‹é¢ç»™å‡ºç¬¬ä¸€ç§æ‰‹åŠ¨è®¡ç®—é«˜åº¦çš„ä»£ç æ€è·¯ï¼š<br>è¯¦ç»†æ­¥éª¤ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">HLComment *comment = [HLComment new];</span><br><span class="line"></span><br><span class="line"> comment<span class="variable">.floor</span> = obj[<span class="string">@"floor"</span>];</span><br><span class="line"></span><br><span class="line"> comment<span class="variable">.commentId</span> = obj[<span class="string">@"id"</span>];</span><br><span class="line"></span><br><span class="line"> comment<span class="variable">.content</span> = obj[<span class="string">@"content"</span>];</span><br></pre></td></tr></table></figure>
<p> //è®¡ç®—contentå†…å®¹é«˜åº¦<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> <span class="built_in">NSDictionary</span> *atrri = @&#123;<span class="built_in">NSFontAttributeName</span>: [<span class="built_in">UIFont</span> systemFontOfSize:<span class="number">15</span>]&#125;;</span><br><span class="line"></span><br><span class="line"> <span class="built_in">CGRect</span> rect = [comment<span class="variable">.content</span> boundingRectWithSize:<span class="built_in">CGSizeMake</span>(<span class="number">220</span>, <span class="number">1000</span>) options:<span class="built_in">NSStringDrawingUsesLineFragmentOrigin</span> attributes:atrri context:<span class="literal">nil</span>];</span><br><span class="line"></span><br><span class="line">comment<span class="variable">.size</span> = rect<span class="variable">.size</span>;<span class="comment">//ä¿å­˜è¿™ä¸ªé«˜åº¦</span></span><br></pre></td></tr></table></figure></p>
<p>//å¡«å……cellå†…å®¹æ—¶ï¼Œæ ¹æ®contenté«˜åº¦æ¥è®¾ç½®labelé«˜åº¦<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)fillCellWithModel:(HLItem *)item&#123;</span><br><span class="line"></span><br><span class="line">	â€¦.</span><br><span class="line"></span><br><span class="line">    <span class="built_in">CGRect</span> frame = _content<span class="variable">.frame</span>;<span class="comment">//_content æ˜¯å†…å®¹label</span></span><br><span class="line"></span><br><span class="line">    frame<span class="variable">.size</span> = item<span class="variable">.size</span>;</span><br><span class="line"></span><br><span class="line">    _content<span class="variable">.frame</span> = frame;</span><br><span class="line"></span><br><span class="line">	â€¦..</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>å¦å¤–åœ¨heightForRowAtIndexPath ä¸­æ·»åŠ ä¸€å®šçš„ä½™é‡ã€‚<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è‡ªé€‚åº”cellé«˜åº¦</span></span><br><span class="line"></span><br><span class="line">- (<span class="built_in">CGFloat</span>)tableView:(<span class="built_in">UITableView</span> *)tableView heightForRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//NSLog(@"è®¡ç®—cellé«˜åº¦");;</span></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (indexPath<span class="variable">.row</span> == <span class="number">0</span>) &#123;</span><br><span class="line"></span><br><span class="line">         <span class="keyword">return</span> <span class="keyword">self</span><span class="variable">.item</span><span class="variable">.size</span><span class="variable">.height</span>+<span class="number">140</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    HLComment *item = _dataSource[indexPath<span class="variable">.row</span>-<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> item<span class="variable">.size</span><span class="variable">.height</span>+<span class="number">60</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>æœ¬æ–‡åŒæ—¶å‚è€ƒ <a href="http://blog.sunnyxx.com/2015/05/17/cell-height-calculation/">http://blog.sunnyxx.com/2015/05/17/cell-height-calculation/</a> </p>
<h2>ä¸€ï¼šæ ¹æ®cellå†…å®¹æ‰‹åŠ¨è®¡ç®—cellé«˜åº¦</h2>

<p>æ— è®ºä½¿ç”¨xibè¿˜æ˜¯ä»£ç å†™æ§ä»¶ï¼Œæ ¸å¿ƒæ€æƒ³éƒ½æ˜¯æ ¹æ®cellä¸­contentå†…å®¹çš„é«˜åº¦æ¥è®¡ç®—cellçš„é«˜åº¦ã€‚<br>1.åœ¨è·å–åˆ°cellæ•°æ®æºçš„æ—¶å€™è®¡ç®—å†…å®¹é«˜åº¦ã€‚å¯ä»¥è®¾ç½®ä¸€ä¸ªsizeå±æ€§ï¼Œç”¨æ¥è®°å½•ã€‚<br>2.å¦‚æœæ˜¯xibï¼Œå»æ‰autolayout<br>3.åœ¨cellForRowAtIndexPathæ–¹æ³•ä¸­å¡«å……cellæ•°æ®çš„æ—¶å€™ï¼Œæ ¹æ®å†…å®¹é«˜åº¦ï¼Œè®¾ç½®æ§ä»¶é«˜åº¦<br>4.åœ¨heightForRowAtIndexpathæ–¹æ³•ä¸­ï¼Œè®¾ç½®æ¯ä¸€ä¸ªcell çš„é«˜åº¦</p>
<h2>äºŒï¼šSelf sizing cell + autolayout</h2>

<p>Self sizing cell æ˜¯iOS8ä¸­æ·»åŠ ä¸€ä¸ªæ–°ç‰¹æ€§ï¼Œç”¨æ¥è‡ªé€‚åº”cellé«˜åº¦ã€‚<br><img src="/img/self sizing cell.jpg" alt="Self Sizing Cell"><br>åŒæ—¶æ‰“å¼€ä»¥ä¸‹å‚æ•°ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">self</span><span class="variable">.tableView</span><span class="variable">.estimatedRowHeight</span> = <span class="number">213</span>;<span class="comment">//æ·»åŠ ä¼°ç®—é«˜åº¦ï¼Œè¦ä¸ç„¶è‡ªåŠ¨ç®—é«˜å¤±æ•ˆï¼Ÿ</span></span><br><span class="line"><span class="keyword">self</span><span class="variable">.tableView</span><span class="variable">.rowHeight</span> = <span class="built_in">UITableViewAutomaticDimension</span>;</span><br></pre></td></tr></table></figure></p>
<h2>ä¸‰ï¼šUITableView+FDTemplateLayoutCell</h2>

<p>ä½¿ç”¨çš„API:<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#import <span class="title">&lt;UITableView+FDTemplateLayoutCell.h&gt;</span> </span></span><br><span class="line">- (<span class="built_in">CGFloat</span>)tableView:(<span class="built_in">UITableView</span> *)tableView heightForRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath &#123; </span><br><span class="line">	<span class="keyword">return</span> [tableView fd_heightForCellWithIdentifier:<span class="string">@"identifer"</span> cacheByIndexPath:indexPath configuration:^(<span class="keyword">id</span> cell)</span><br><span class="line"> 			&#123;</span><br><span class="line">  			<span class="comment">// é…ç½® cell çš„æ•°æ®æºï¼Œå’Œ "cellForRow" å¹²çš„äº‹ä¸€è‡´ï¼Œæ¯”å¦‚ï¼š </span></span><br><span class="line">			  cell<span class="variable">.entity</span> = <span class="keyword">self</span><span class="variable">.feedEntities</span>[indexPath<span class="variable">.row</span>]; </span><br><span class="line">  			&#125;]; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><a href="https://github.com/forkingdog/UITableView-FDTemplateLayoutCell">https://github.com/forkingdog/UITableView-FDTemplateLayoutCell</a><br>]]>
    
    </summary>
    
      <category term="cellé«˜åº¦" scheme="http://koalahl.github.io/tags/cell%E9%AB%98%E5%BA%A6/"/>
    
      <category term="tableViewCell" scheme="http://koalahl.github.io/tags/tableViewCell/"/>
    
      <category term="iOS" scheme="http://koalahl.github.io/categories/iOS/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[ç†è§£Objective-Cä¸­çš„æ¶ˆæ¯å‘é€]]></title>
    <link href="http://koalahl.github.io/2015/12/16/%E7%90%86%E8%A7%A3Objective-C%E4%B8%AD%E7%9A%84%E6%B6%88%E6%81%AF%E5%8F%91%E9%80%81/"/>
    <id>http://koalahl.github.io/2015/12/16/ç†è§£Objective-Cä¸­çš„æ¶ˆæ¯å‘é€/</id>
    <published>2015-12-16T12:32:25.000Z</published>
    <updated>2015-12-16T12:32:25.000Z</updated>
    <content type="html"><![CDATA[<h2>æ¶ˆæ¯å‘é€</h2><br>é¦–å…ˆæ¥çœ‹çœ‹æ€ä¹ˆç†è§£å‘é€æ¶ˆæ¯çš„å«ä¹‰ï¼š<br><br>é¢å¯¹ç€ Cocoa ä¸­å¤§é‡ APIï¼ŒåªçŸ¥é“ç®€å•çš„æŸ¥æ–‡æ¡£å’Œè°ƒç”¨ã€‚è¿˜è®°å¾—åˆå­¦ Objective-C æ—¶æŠŠ<code>[receiver message]</code>å½“æˆç®€å•çš„æ–¹æ³•è°ƒç”¨ï¼Œè€Œæ— è§†äº†â€œå‘é€æ¶ˆæ¯â€è¿™å¥è¯çš„æ·±åˆ»å«ä¹‰ã€‚äºæ˜¯<code>[receiver message]</code>ä¼šè¢«ç¼–è¯‘å™¨è½¬åŒ–ä¸ºï¼š<br>    <code>objc_msgSend(receiver, selector)</code><br>å¦‚æœæ¶ˆæ¯å«æœ‰å‚æ•°ï¼Œåˆ™ä¸ºï¼š<br>    <code>objc_msgSend(receiver, selector, arg1, arg2, ...)</code><br>å¦‚æœæ¶ˆæ¯çš„æ¥æ”¶è€…èƒ½å¤Ÿæ‰¾åˆ°å¯¹åº”çš„selectorï¼Œé‚£ä¹ˆå°±ç›¸å½“äºç›´æ¥æ‰§è¡Œäº†æ¥æ”¶è€…è¿™ä¸ªå¯¹è±¡çš„ç‰¹å®šæ–¹æ³•ï¼›å¦åˆ™ï¼Œæ¶ˆæ¯è¦ä¹ˆè¢«è½¬å‘ï¼Œæˆ–æ˜¯ä¸´æ—¶å‘æ¥æ”¶è€…åŠ¨æ€æ·»åŠ è¿™ä¸ªselectorå¯¹åº”çš„å®ç°å†…å®¹ï¼Œè¦ä¹ˆå°±å¹²è„†ç©å®Œå´©æºƒæ‰ã€‚<br><br>ç°åœ¨å¯ä»¥çœ‹å‡º[receiver message]çœŸçš„ä¸æ˜¯ä¸€ä¸ªç®€ç®€å•å•çš„æ–¹æ³•è°ƒç”¨ã€‚å› ä¸ºè¿™åªæ˜¯åœ¨ç¼–è¯‘é˜¶æ®µç¡®å®šäº†è¦å‘æ¥æ”¶è€…å‘é€messageè¿™æ¡æ¶ˆæ¯ï¼Œè€Œreceiveå°†è¦å¦‚ä½•å“åº”è¿™æ¡æ¶ˆæ¯ï¼Œé‚£å°±è¦çœ‹è¿è¡Œæ—¶å‘ç”Ÿçš„æƒ…å†µæ¥å†³å®šäº†ã€‚<br><br>Objective-C çš„ Runtime é“¸å°±äº†å®ƒåŠ¨æ€è¯­è¨€çš„ç‰¹æ€§ï¼Œè¿™äº›æ·±å±‚æ¬¡çš„çŸ¥è¯†è™½ç„¶å¹³æ—¶å†™ä»£ç ç”¨çš„å°‘ä¸€äº›ï¼Œä½†æ˜¯å´æ˜¯æ¯ä¸ª Objc ç¨‹åºå‘˜éœ€è¦äº†è§£çš„ã€‚<br><br>Objc Runtimeä½¿å¾—Cå…·æœ‰äº†é¢å‘å¯¹è±¡èƒ½åŠ›ï¼Œåœ¨ç¨‹åºè¿è¡Œæ—¶åˆ›å»ºï¼Œæ£€æŸ¥ï¼Œä¿®æ”¹ç±»ã€å¯¹è±¡å’Œå®ƒä»¬çš„æ–¹æ³•ã€‚å¯ä»¥ä½¿ç”¨runtimeçš„ä¸€ç³»åˆ—æ–¹æ³•å®ç°ã€‚<br><br><h3>Cè¯­è¨€ä¸­çš„åŠ¨æ€æ–¹æ³•</h3><br><br>ç”±äºObjective-Cæ˜¯Cè¯­è¨€çš„è¶…é›†ï¼Œæ‰€ä»¥æœ€å¥½å…ˆç†è§£Cè¯­è¨€çš„å‡½æ•°è°ƒç”¨æ–¹å¼ã€‚Cè¯­è¨€ä½¿ç”¨â€œé™æ€ç»‘å®šï¼ˆstatic bindingï¼‰â€ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ç¼–è¯‘å™¨å°±èƒ½å†³å®šè¿è¡Œæ—¶æ‰€åº”è°ƒç”¨çš„å‡½æ•°ã€‚<br><br><a id="more"></a><br>ç¤ºä¾‹ä»£ç ï¼š<br><br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#import &lt;stdio.h&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printHello</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Hello,world\n"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printGoodBye</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"GoodBye,world\n"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">doThings</span><span class="params">(<span class="keyword">int</span> type)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(type == <span class="number">0</span>)&#123;</span><br><span class="line">        printHello();</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        printGoodBye();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><br>ç¼–è¯‘å™¨åœ¨ç¼–è¯‘ä»£ç çš„æ—¶å€™å°±çŸ¥é“ç¨‹åºä¸­æœ‰<code>printHello</code>,<code>printGoodBye</code>ä¸¤ä¸ªå‡½æ•°äº†ï¼Œå‡½æ•°åœ°å€ä¹Ÿç¡¬ç¼–ç åœ¨æŒ‡ä»¤ä¹‹ä¸­ã€‚<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#import &lt;stdio.h&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printHello</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Hello,world\n"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printGoodBye</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"GoodBye,world\n"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">doThings</span><span class="params">(<span class="keyword">int</span> type)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">void</span> (*func)();</span><br><span class="line">    <span class="keyword">if</span>(type == <span class="number">0</span>)&#123;</span><br><span class="line">        func = printHello;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        func = printGoodBye;</span><br><span class="line">    &#125;</span><br><span class="line">    func();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><br>è¿™æ ·å°±æ˜¯åŠ¨æ€ç»‘å®šï¼ˆdynamic bindingï¼‰äº†ï¼Œå› ä¸ºç´¢è¦è°ƒç”¨çš„å‡½æ•°ç›´åˆ°è¿è¡ŒæœŸæ‰èƒ½ç¡®å®šã€‚<br><br><h3>é¡ºä¾¿é™„ä¸ŠOCä¸­ä¸€ä¸ªç±»çš„åº•å±‚æ•°æ®ç»“æ„</h3><br>macç”µè„‘ä¸Šçš„è·¯å¾„/usr/include/objc/runtime.h<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">struct</span> objc_class &#123;</span><br><span class="line">	Class isa OBJC_ISA_<span class="built_in">AVAILABILITY</span>; <span class="comment">//isaæŒ‡é’ˆæŒ‡å‘Meta Classï¼Œå› ä¸ºObjcçš„ç±»çš„æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªObjectï¼Œä¸ºäº†å¤„ç†è¿™ä¸ªå…³ç³»ï¼Œr		untimeå°±åˆ›é€ äº†Meta Classï¼Œå½“ç»™ç±»å‘é€[NSObject alloc]è¿™æ ·æ¶ˆæ¯æ—¶ï¼Œå®é™…ä¸Šæ˜¯æŠŠè¿™ä¸ªæ¶ˆæ¯å‘ç»™äº†Class Object</span></span><br><span class="line"></span><br><span class="line">	<span class="preprocessor">#if !__OBJC2__</span></span><br><span class="line">	Class super_class OBJC2_UN<span class="built_in">AVAILABLE</span>; <span class="comment">// çˆ¶ç±»</span></span><br><span class="line">	<span class="keyword">const</span> <span class="keyword">char</span> *name OBJC2_UN<span class="built_in">AVAILABLE</span>; <span class="comment">// ç±»å</span></span><br><span class="line">	<span class="keyword">long</span> version OBJC2_UN<span class="built_in">AVAILABLE</span>; <span class="comment">// ç±»çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œé»˜è®¤ä¸º0</span></span><br><span class="line">	<span class="keyword">long</span> info OBJC2_UN<span class="built_in">AVAILABLE</span>; <span class="comment">// ç±»ä¿¡æ¯ï¼Œä¾›è¿è¡ŒæœŸä½¿ç”¨çš„ä¸€äº›ä½æ ‡è¯†</span></span><br><span class="line">	<span class="keyword">long</span> instance_size OBJC2_UN<span class="built_in">AVAILABLE</span>; <span class="comment">// è¯¥ç±»çš„å®ä¾‹å˜é‡å¤§å°</span></span><br><span class="line">	<span class="keyword">struct</span> objc_ivar_list *ivars OBJC2_UN<span class="built_in">AVAILABLE</span>; <span class="comment">// è¯¥ç±»çš„æˆå‘˜å˜é‡é“¾è¡¨</span></span><br><span class="line">	<span class="keyword">struct</span> objc_method_list **methodLists OBJC2_UN<span class="built_in">AVAILABLE</span>; <span class="comment">// æ–¹æ³•å®šä¹‰çš„é“¾è¡¨</span></span><br><span class="line">	<span class="keyword">struct</span> objc_cache *cache OBJC2_UN<span class="built_in">AVAILABLE</span>; <span class="comment">// æ–¹æ³•ç¼“å­˜ï¼Œå¯¹è±¡æ¥åˆ°ä¸€ä¸ªæ¶ˆæ¯ä¼šæ ¹æ®isaæŒ‡é’ˆæŸ¥æ‰¾æ¶ˆæ¯å¯¹è±¡ï¼Œè¿™æ—¶ä¼šåœ¨method		Listsä¸­éå†ï¼Œå¦‚æœcacheäº†ï¼Œå¸¸ç”¨çš„æ–¹æ³•è°ƒç”¨æ—¶å°±èƒ½å¤Ÿæé«˜è°ƒç”¨çš„æ•ˆç‡ã€‚</span></span><br><span class="line">	<span class="keyword">struct</span> objc_protocol_list *protocols OBJC2_UN<span class="built_in">AVAILABLE</span>; <span class="comment">// åè®®é“¾è¡¨</span></span><br><span class="line">	<span class="preprocessor">#endif</span></span><br><span class="line"></span><br><span class="line">&#125; OBJC2_UN<span class="built_in">AVAILABLE</span>;</span><br></pre></td></tr></table></figure><br><br><!--more--><br>OCä¸­ä¸€ä¸ªç±»çš„å¯¹è±¡å®ä¾‹çš„æ•°æ®ç»“æ„ï¼ˆ/usr/include/objc/objc.hï¼‰ï¼Œå°±æ˜¯å®šä¹‰äº†ä¸€ä¸ª<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> objc_class *Class;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// Represents an instance of a class.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> objc_object &#123;</span><br><span class="line"></span><br><span class="line">    Class isa  OBJC_ISA_<span class="built_in">AVAILABILITY</span>;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// A pointer to an instance of a class.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> objc_object *<span class="keyword">id</span>;</span><br></pre></td></tr></table></figure><br><br>å‘objectå‘é€æ¶ˆæ¯æ—¶ï¼ŒRuntimeåº“ä¼šæ ¹æ®objectçš„isaæŒ‡é’ˆæ‰¾åˆ°è¿™ä¸ªå®ä¾‹objectæ‰€å±äºçš„ç±»ï¼Œç„¶ååœ¨ç±»çš„æ–¹æ³•åˆ—è¡¨ä»¥åŠçˆ¶ç±»æ–¹æ³•åˆ—è¡¨å¯»æ‰¾å¯¹åº”çš„æ–¹æ³•è¿è¡Œã€‚idæ˜¯ä¸€ä¸ªobjc_objectç»“æ„ç±»å‹çš„æŒ‡é’ˆï¼Œè¿™ä¸ªç±»å‹çš„å¯¹è±¡èƒ½å¤Ÿè½¬æ¢æˆä»»ä½•ä¸€ç§å¯¹è±¡ã€‚<br><br><h3>ç„¶åå†æ¥çœ‹çœ‹æ¶ˆæ¯å‘é€çš„å‡½æ•°ï¼š<code>objc_msgSend</code>å‡½æ•°</h3><br><br>åœ¨å¼•è¨€ä¸­å·²ç»å¯¹objc_msgSendè¿›è¡Œäº†ä¸€ç‚¹ä»‹ç»ï¼Œçœ‹èµ·æ¥åƒæ˜¯objc_msgSendè¿”å›äº†æ•°æ®ï¼Œå…¶å®objc_msgSendä»ä¸è¿”å›æ•°æ®è€Œæ˜¯ä½ çš„æ–¹æ³•è¢«è°ƒç”¨åè¿”å›äº†æ•°æ®ã€‚ä¸‹é¢è¯¦ç»†å™è¿°ä¸‹æ¶ˆæ¯å‘é€æ­¥éª¤ï¼š<br><br>1.æ£€æµ‹è¿™ä¸ª selector æ˜¯ä¸æ˜¯è¦å¿½ç•¥çš„ã€‚æ¯”å¦‚ Mac OS X å¼€å‘ï¼Œæœ‰äº†åƒåœ¾å›æ”¶å°±ä¸ç†ä¼š retain,release è¿™äº›å‡½æ•°äº†ã€‚<br>2.æ£€æµ‹è¿™ä¸ª target æ˜¯ä¸æ˜¯ nil å¯¹è±¡ã€‚ObjC çš„ç‰¹æ€§æ˜¯å…è®¸å¯¹ä¸€ä¸ª nil å¯¹è±¡æ‰§è¡Œä»»ä½•ä¸€ä¸ªæ–¹æ³•ä¸ä¼š Crashï¼Œå› ä¸ºä¼šè¢«å¿½ç•¥æ‰ã€‚<br>3.å¦‚æœä¸Šé¢ä¸¤ä¸ªéƒ½è¿‡äº†ï¼Œé‚£å°±å¼€å§‹æŸ¥æ‰¾è¿™ä¸ªç±»çš„ IMPï¼Œå…ˆä» cache é‡Œé¢æ‰¾ï¼Œå®Œäº†        æ‰¾å¾—åˆ°å°±è·³åˆ°å¯¹åº”çš„å‡½æ•°å»æ‰§è¡Œã€‚<br>4.å¦‚æœ cache æ‰¾ä¸åˆ°å°±æ‰¾ä¸€ä¸‹æ–¹æ³•åˆ†å‘è¡¨ã€‚<br>5.å¦‚æœåˆ†å‘è¡¨æ‰¾ä¸åˆ°å°±åˆ°è¶…ç±»çš„åˆ†å‘è¡¨å»æ‰¾ï¼Œä¸€ç›´æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°NSObjectç±»ä¸ºæ­¢ã€‚<br>6.å¦‚æœè¿˜æ‰¾ä¸åˆ°å°±è¦å¼€å§‹è¿›å…¥åŠ¨æ€æ–¹æ³•è§£æäº†ï¼Œåé¢ä¼šæåˆ°ã€‚<br><br>è¿™ä¹ˆä¸€æƒ³ï¼Œè°ƒç”¨ä¸€ä¸ªæ–¹æ³•ä¼¼ä¹éœ€è¦å¾ˆå¤šæ­¥éª¤ã€‚ä¸è¿‡objc_msgSendä¼šå°†åŒ¹é…ç»“æœç¼“å­˜åœ¨<code>fast map</code>å¿«é€Ÿæ˜ å°„è¡¨é‡Œé¢ï¼Œæ¯ä¸ªç±»éƒ½æœ‰è¿™æ ·ä¸€å—ç¼“å­˜ã€‚å½“ç„¶è¿™ç§fast path è¿˜æ˜¯ä¸å¦‚é™æ€ç»‘å®šçš„å‡½æ•°è°ƒç”¨é‚£æ ·è¿…é€Ÿï¼Œä¸è¿‡åªè¦æŠŠSelector<br>ç¼“å­˜èµ·æ¥ï¼Œä¹Ÿå°±ä¸ä¼šæ…¢å¾ˆå¤šï¼Œå®é™…ä¸Šï¼Œè¿™å¹¶ä¸æ˜¯ç“¶é¢ˆã€‚<br><br><h2>æ¶ˆæ¯è½¬å‘æœºåˆ¶</h2>

<p>å½“ä¸€ä¸ªå¯¹è±¡æ¥æ”¶åˆ°æ— æ³•è§£è¯»çš„æ¶ˆæ¯æ—¶ï¼Œå°±ä¼šå¯åŠ¨<code>æ¶ˆæ¯è½¬å‘ï¼ˆmessage forwordingï¼‰</code>æœºåˆ¶ã€‚coderå¯ç»ç”±æ­¤è¿‡ç¨‹å‘Šè¯‰å¯¹è±¡åº”è¯¥å¦‚ä½•å¤„ç†ä½ç½®æ¶ˆæ¯ã€‚<br>ä¾‹å¦‚ç»™æŸä¸€ä¸ªå¯¹è±¡å®ä¾‹å‘é€äº†ä¸€ä¸ªè¯¥å¯¹è±¡ä¸å­˜åœ¨çš„æ–¹æ³•ï¼Œæœ€åå°±ä¼šcrashæ‰ã€‚<br><code>-[NSCFDictionary indexOfObject:]: unrecognized selector sent to instance 0x10773929356</code><br>æ¶ˆæ¯è½¬å‘åˆ†ä¸ºä¸¤å¤§é˜¶æ®µã€‚</p>
<ol>
<li>ç¬¬ä¸€é˜¶æ®µå…ˆè¯¢é—®æ¥å—å¯¹è±¡æ‰€å±çš„ç±»æ˜¯å¦èƒ½å¤ŸåŠ¨æ€æ·»åŠ æ–¹æ³•ï¼Œä»¥å¤„ç†è¿™ä¸ªunknown selectorï¼Œè¿™å«åšåŠ¨æ€æ–¹æ³•è§£æï¼ˆdynamic method resolutionï¼‰.</li>
<li>ç¬¬äºŒé˜¶æ®µè®¾è®¡å®Œæ•´çš„æ¶ˆæ¯è½¬å‘æœºåˆ¶ï¼ˆfull forwording mechanismï¼‰ã€‚<br>å¦‚æœåœ¨è¿è¡ŒæœŸï¼Œç³»ç»Ÿå·²ç»æŠŠç¬¬ä¸€é˜¶æ®µæ‰§è¡Œå®Œäº†ï¼Œé‚£ä¹ˆæ¥å—è€…è‡ªå·±å°±æ— æ³•å†ä»¥åŠ¨æ€æ·»åŠ æ–¹æ³•çš„æ–¹å¼æ¥å“åº”åŒ…å«è¯¥unknown selectorçš„æ¶ˆæ¯äº†ã€‚æ­¤æ—¶ï¼Œè¿è¡ŒæœŸç³»ç»Ÿä¼šè¯·æ±‚æ¥å—è€…ä»¥<br>å…¶ä»–æ‰‹æ®µæ¥å¤„ç†ä¸æ¶ˆæ¯ç›¸å…³çš„æ–¹æ³•è°ƒç”¨ã€‚è¿™é‡Œåˆåˆ†ä¸ºä¸¤å°æ­¥ï¼š<br> 2.1 é¦–å…ˆï¼Œæ¥å—è€…æŸ¥çœ‹æ˜¯å¦æœ‰å…¶ä»–å¯¹è±¡èƒ½å¤„ç†è¿™æ¡æ¶ˆæ¯ï¼Œè‹¥æœ‰ï¼Œåˆ™è¿è¡Œæ—¶ç³»ç»Ÿä¼šå°†æ¶ˆæ¯è½¬ç»™é‚£ä¸ªå¯¹è±¡ï¼Œä¸€åˆ‡å¦‚å¸¸ã€‚<br> 2.2 è‹¥æ²¡æœ‰å¯æ›¿ä»£çš„æ¥å—è€…ï¼ˆreplacement receiverï¼‰ï¼Œåˆ™å¯åŠ¨å®Œæ•´çš„æ¶ˆæ¯è½¬å‘æœºåˆ¶ï¼Œè¿è¡Œæ—¶ç³»ç»Ÿä¼šæŠŠä¸æ¶ˆæ¯æœ‰å…³çš„å…¨éƒ¨ç»†èŠ‚éƒ½å°è£…åˆ°NSInvocationå¯¹è±¡ä¸­ï¼Œå†ç»™æ¥å—è€…æœ€åä¸€æ¬¡æœºä¼šï¼Œä»¤å…¶è®¾æ³•è§£å†³å½“å‰è¿˜æœªå¤„ç†çš„æ¶ˆæ¯ã€‚</li>
</ol>
<p>a.åŠ¨æ€æ–¹æ³•è§£æ<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">+ (Bool)resolveInstanceMethod:(SEL)Selector</span><br><span class="line">+ (Bool)resolveClassMethod:(SEL)Selector</span><br></pre></td></tr></table></figure></p>
<p>b.æ¶ˆæ¯è½¬å‘ç»™å¯æ›¿ä»£æ¥å—è€…ï¼Œå°è¯•æ‰¾åˆ°ä¸€ä¸ªèƒ½å“åº”è¯¥æ¶ˆæ¯çš„å¯¹è±¡ï¼ˆreplacement receiverï¼‰<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">id</span>)forwardingTargetForSelector:(SEL)Selector</span><br></pre></td></tr></table></figure></p>
<p>c.ä¸‹ä¸€æ­¥ï¼Œæ„é€ NSInvocationå¯¹è±¡<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å°è¯•è·å¾—ä¸€ä¸ªæ–¹æ³•ç­¾å</span></span><br><span class="line">- (<span class="keyword">id</span>)methodSignatureForSelector:(SEL)selector </span><br><span class="line"><span class="comment">//å°†ä¸Šä¸€æ­¥è·å–åˆ°çš„æ–¹æ³•ç­¾ååŒ…è£…æˆ Invocation ä¼ å…¥ï¼Œå¦‚ä½•å¤„ç†å°±åœ¨è¿™é‡Œé¢äº†ï¼Œå¹¶è¿”å›éni</span></span><br><span class="line">- (<span class="keyword">id</span>)forwardInvocation:(<span class="built_in">NSInvocation</span> *)invocation</span><br></pre></td></tr></table></figure></p>
<p><img src="/img/message forwarding.png" alt="å®Œæ•´çš„æ¶ˆæ¯è½¬å‘æµç¨‹å›¾"></p>
<p></p><h2>æ€»ç»“</h2><p></p>
<ul>
<li>æ¶ˆæ¯ç”±æ¥å—è€…ã€é€‰æ‹©å™¨åŠå‚æ•°æ„æˆã€‚ç»™æŸå¯¹è±¡å‘é€æ¶ˆæ¯ï¼ˆinvoke a messageï¼‰ï¼Œä¹Ÿå°±ç›¸å½“äºåœ¨è¯¥å¯¹è±¡ä¸Šè°ƒç”¨æ–¹æ³•ï¼ˆcalla methodï¼‰</li>
<li><p>å‘ç»™æŸå¯¹è±¡çš„å…¨éƒ¨æ¶ˆæ¯éƒ½è¦æœ‰åŠ¨æ€æ¶ˆæ¯æ´¾å‘ç³»ç»Ÿï¼ˆdynamic message dispatch systemï¼‰æ¥å¤„ç†ï¼Œè¯¥ç³»ç»Ÿä¼šæŸ¥å‡ºå¯¹åº”çš„æ–¹æ³•ï¼Œå¹¶æ‰§è¡Œå…¶ä»£ç ã€‚</p>
</li>
<li><p>è‹¥å¯¹è±¡æ— æ³•å“åº”æŸä¸ªé€‰æ‹©å™¨ä¸­çš„æ¶ˆæ¯ï¼Œåˆ™è¿›å…¥æ¶ˆæ¯è½¬å‘è¿‡ç¨‹ã€‚</p>
</li>
<li>é€šè¿‡è¿è¡ŒæœŸçš„åŠ¨æ€æ–¹æ³•è§£ææœºåˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨éœ€è¦ç”¨åˆ°æŸä¸ªæ–¹æ³•æ—¶å†å°†å…¶åŠ å…¥ç±»ä¸­ã€‚</li>
<li>å¯¹è±¡å¯ä»¥æŠŠå…¶æ— æ³•è§£è¯»çš„æ¶ˆæ¯è½¬äº¤ç»™å…¶ä»–å¯¹è±¡æ¥å¤„ç†ã€‚</li>
<li>è‹¥ç»è¿‡ä¸Šè¿°ä¸¤æ­¥è¿˜æ˜¯æ²¡åŠæ³•å¤„ç†æ¶ˆæ¯ï¼Œåˆ™å¯åŠ¨å®Œæ•´çš„æ¶ˆæ¯è½¬å‘æœºåˆ¶ã€‚</li>
</ul>
<p>è¯¦æƒ…å¯å‚è€ƒ  <a href="http://blog.jobbole.com/79545/" title="Objective-C Runtime" target="_blank" rel="external">Objective-C Runtime</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<h2>æ¶ˆæ¯å‘é€</h2><br>é¦–å…ˆæ¥çœ‹çœ‹æ€ä¹ˆç†è§£å‘é€æ¶ˆæ¯çš„å«ä¹‰ï¼š<br><br>é¢å¯¹ç€ Cocoa ä¸­å¤§é‡ APIï¼ŒåªçŸ¥é“ç®€å•çš„æŸ¥æ–‡æ¡£å’Œè°ƒç”¨ã€‚è¿˜è®°å¾—åˆå­¦ Objective-C æ—¶æŠŠ<code>[receiver message]</code>å½“æˆç®€å•çš„æ–¹æ³•è°ƒç”¨ï¼Œè€Œæ— è§†äº†â€œå‘é€æ¶ˆæ¯â€è¿™å¥è¯çš„æ·±åˆ»å«ä¹‰ã€‚äºæ˜¯<code>[receiver message]</code>ä¼šè¢«ç¼–è¯‘å™¨è½¬åŒ–ä¸ºï¼š<br>    <code>objc_msgSend(receiver, selector)</code><br>å¦‚æœæ¶ˆæ¯å«æœ‰å‚æ•°ï¼Œåˆ™ä¸ºï¼š<br>    <code>objc_msgSend(receiver, selector, arg1, arg2, ...)</code><br>å¦‚æœæ¶ˆæ¯çš„æ¥æ”¶è€…èƒ½å¤Ÿæ‰¾åˆ°å¯¹åº”çš„selectorï¼Œé‚£ä¹ˆå°±ç›¸å½“äºç›´æ¥æ‰§è¡Œäº†æ¥æ”¶è€…è¿™ä¸ªå¯¹è±¡çš„ç‰¹å®šæ–¹æ³•ï¼›å¦åˆ™ï¼Œæ¶ˆæ¯è¦ä¹ˆè¢«è½¬å‘ï¼Œæˆ–æ˜¯ä¸´æ—¶å‘æ¥æ”¶è€…åŠ¨æ€æ·»åŠ è¿™ä¸ªselectorå¯¹åº”çš„å®ç°å†…å®¹ï¼Œè¦ä¹ˆå°±å¹²è„†ç©å®Œå´©æºƒæ‰ã€‚<br><br>ç°åœ¨å¯ä»¥çœ‹å‡º[receiver message]çœŸçš„ä¸æ˜¯ä¸€ä¸ªç®€ç®€å•å•çš„æ–¹æ³•è°ƒç”¨ã€‚å› ä¸ºè¿™åªæ˜¯åœ¨ç¼–è¯‘é˜¶æ®µç¡®å®šäº†è¦å‘æ¥æ”¶è€…å‘é€messageè¿™æ¡æ¶ˆæ¯ï¼Œè€Œreceiveå°†è¦å¦‚ä½•å“åº”è¿™æ¡æ¶ˆæ¯ï¼Œé‚£å°±è¦çœ‹è¿è¡Œæ—¶å‘ç”Ÿçš„æƒ…å†µæ¥å†³å®šäº†ã€‚<br><br>Objective-C çš„ Runtime é“¸å°±äº†å®ƒåŠ¨æ€è¯­è¨€çš„ç‰¹æ€§ï¼Œè¿™äº›æ·±å±‚æ¬¡çš„çŸ¥è¯†è™½ç„¶å¹³æ—¶å†™ä»£ç ç”¨çš„å°‘ä¸€äº›ï¼Œä½†æ˜¯å´æ˜¯æ¯ä¸ª Objc ç¨‹åºå‘˜éœ€è¦äº†è§£çš„ã€‚<br><br>Objc Runtimeä½¿å¾—Cå…·æœ‰äº†é¢å‘å¯¹è±¡èƒ½åŠ›ï¼Œåœ¨ç¨‹åºè¿è¡Œæ—¶åˆ›å»ºï¼Œæ£€æŸ¥ï¼Œä¿®æ”¹ç±»ã€å¯¹è±¡å’Œå®ƒä»¬çš„æ–¹æ³•ã€‚å¯ä»¥ä½¿ç”¨runtimeçš„ä¸€ç³»åˆ—æ–¹æ³•å®ç°ã€‚<br><br><h3>Cè¯­è¨€ä¸­çš„åŠ¨æ€æ–¹æ³•</h3><br><br>ç”±äºObjective-Cæ˜¯Cè¯­è¨€çš„è¶…é›†ï¼Œæ‰€ä»¥æœ€å¥½å…ˆç†è§£Cè¯­è¨€çš„å‡½æ•°è°ƒç”¨æ–¹å¼ã€‚Cè¯­è¨€ä½¿ç”¨â€œé™æ€ç»‘å®šï¼ˆstatic bindingï¼‰â€ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ç¼–è¯‘å™¨å°±èƒ½å†³å®šè¿è¡Œæ—¶æ‰€åº”è°ƒç”¨çš„å‡½æ•°ã€‚<br><br>]]>
    
    </summary>
    
      <category term="Runtime" scheme="http://koalahl.github.io/tags/Runtime/"/>
    
      <category term="iOS" scheme="http://koalahl.github.io/categories/iOS/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[å…³äºCoreDataå’ŒSQLiteå¤šçº¿ç¨‹è®¿é—®æ—¶çš„çº¿ç¨‹å®‰å…¨é—®é¢˜]]></title>
    <link href="http://koalahl.github.io/2015/12/14/%E5%85%B3%E4%BA%8ECoreData%E5%92%8CSQLite%E5%A4%9A%E7%BA%BF%E7%A8%8B%E8%AE%BF%E9%97%AE%E6%97%B6%E7%9A%84%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8%E9%97%AE%E9%A2%98/"/>
    <id>http://koalahl.github.io/2015/12/14/å…³äºCoreDataå’ŒSQLiteå¤šçº¿ç¨‹è®¿é—®æ—¶çš„çº¿ç¨‹å®‰å…¨é—®é¢˜/</id>
    <published>2015-12-14T10:51:37.000Z</published>
    <updated>2015-12-14T10:51:37.000Z</updated>
    <content type="html"><![CDATA[<p>æ•°æ®åº“è¯»å–æ“ä½œä¸€èˆ¬éƒ½æ˜¯å¤šçº¿ç¨‹è®¿é—®çš„ã€‚åœ¨å¯¹æ•°æ®è¿›è¡Œè¯»å–æ—¶ï¼Œæˆ‘ä»¬è¦ä¿è¯å…¶å½“å‰çŠ¶æ€ä¸èƒ½è¢«ä¿®æ”¹ï¼Œå³è¯»å–æ—¶åŠ é”ï¼Œå¦åˆ™å°±ä¼šå‡ºç°æ•°æ®é”™è¯¯æ··ä¹±ã€‚<br>IOSä¸­å¸¸ç”¨çš„ä¸¤ç§æ•°æ®æŒä¹…åŒ–å­˜å‚¨æ–¹å¼ï¼šCoreDataå’ŒSQLiteï¼Œä¸¤è€…éƒ½éœ€è¦è®¾ç½®çº¿ç¨‹å®‰å…¨ï¼Œåœ¨è¿™é‡Œä»¥FMDBæ¥è§£é‡Šå¯¹SQLiteçš„çº¿ç¨‹å®‰å…¨è®¿é—®ã€‚</p>
<a id="more"></a>
<h3>ä¸€:FMDBçš„çº¿ç¨‹å®‰å…¨ï¼šï¼ˆä»¥è¯»å–å›¾ç‰‡ä¸ºä¾‹ï¼‰</h3>

<p>1.æ²¡æœ‰çº¿ç¨‹å®‰å…¨çš„æ‰§è¡Œæ–¹å¼ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//************** æ•°æ®åº“ä¿å­˜å›¾ç‰‡  ******************//</span></span><br><span class="line"></span><br><span class="line"> FMDatabase *database = [FMDatabase databaseWithPath:[<span class="keyword">self</span> getDatabasePath]];</span><br><span class="line"></span><br><span class="line"> <span class="comment">//æ‰“å¼€æ•°æ®åº“</span></span><br><span class="line"></span><br><span class="line"> [database open];</span><br><span class="line"></span><br><span class="line"> <span class="built_in">NSString</span> *sql = <span class="string">@"create table if not exists Test (id integer primary key autoincrement,name text,image blob);"</span>;</span><br><span class="line"></span><br><span class="line"> <span class="comment">//åˆ›å»ºè¡¨</span></span><br><span class="line"></span><br><span class="line"> [database executeUpdate:sql];</span><br><span class="line"></span><br><span class="line"> <span class="comment">//æŠŠUIImageå¯¹è±¡è½¬åŒ–ä¸ºNSData</span></span><br><span class="line"></span><br><span class="line"> <span class="built_in">NSData</span> *data = <span class="built_in">UIImagePNGRepresentation</span>([<span class="built_in">UIImage</span> imageNamed:<span class="string">@"user_browse"</span>]);    </span><br><span class="line"></span><br><span class="line"> <span class="comment">//å†™å…¥æ•°æ®</span></span><br><span class="line"></span><br><span class="line"> sql = <span class="string">@"insert into Test (name,image) values (?,?)"</span>;</span><br><span class="line"></span><br><span class="line"> [database executeUpdate:sql,<span class="string">@"å¼ ä¸‰"</span>,data];</span><br><span class="line"></span><br><span class="line"> <span class="comment">//è¯»å–æ˜¾ç¤º</span></span><br><span class="line"></span><br><span class="line"> sql = <span class="string">@"select * from Test;"</span>;</span><br><span class="line"></span><br><span class="line"> FMResultSet *resultSet = [database executeQuery:sql];</span><br><span class="line"></span><br><span class="line"> <span class="keyword">while</span> (resultSet<span class="variable">.next</span>)</span><br><span class="line"></span><br><span class="line"> &#123;</span><br><span class="line"></span><br><span class="line">     <span class="comment">//[resultSet dataForColumn:@"image"];</span></span><br><span class="line"></span><br><span class="line">     <span class="built_in">NSData</span> *imageData = [resultSet dataForColumnIndex:<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">     <span class="built_in">UIImageView</span> *imageView = [[<span class="built_in">UIImageView</span> alloc] initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">300</span>, <span class="number">300</span>)];</span><br><span class="line"></span><br><span class="line">     imageView<span class="variable">.image</span> = [<span class="built_in">UIImage</span> imageWithData:imageData];</span><br><span class="line"></span><br><span class="line">     [<span class="keyword">self</span><span class="variable">.view</span> addSubview:imageView];</span><br><span class="line"></span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><br>2ï¼Œä½¿ç”¨çº¿ç¨‹é˜Ÿåˆ—<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//************** æ•°æ®åº“çº¿ç¨‹å®‰å…¨ ***********//</span></span><br><span class="line">    FMDatabaseQueue *queue = [[FMDatabaseQueue alloc] initWithPath:[<span class="keyword">self</span> getDatabasePath]];</span><br><span class="line"></span><br><span class="line">    [queue inDatabase:^(FMDatabase *db) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//çº¿ç¨‹å®‰å…¨çš„</span></span><br><span class="line"></span><br><span class="line">        __block <span class="built_in">NSString</span> *sql = <span class="string">@"create table if not exists Test (id integer primary key autoincrement,name text,image blob);"</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ›å»ºè¡¨</span></span><br><span class="line"></span><br><span class="line">        [database executeUpdate:sql];</span><br><span class="line"></span><br><span class="line">    &#125;];</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ’å…¥æ•°æ®</span></span><br><span class="line"></span><br><span class="line">    [queue inDatabase:^(FMDatabase *db) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å†™å…¥æ•°æ®</span></span><br><span class="line"></span><br><span class="line">        sql = <span class="string">@"insert into Test (name,image) values (?,?)"</span>;</span><br><span class="line"></span><br><span class="line">        [database executeUpdate:sql,<span class="string">@"å¼ ä¸‰"</span>,data];</span><br><span class="line"></span><br><span class="line">    &#125;];</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è¯»å–</span></span><br><span class="line">    [queue inDatabase:^(FMDatabase *db) &#123;</span><br><span class="line">        <span class="comment">//è¯»å–æ˜¾ç¤º</span></span><br><span class="line">        sql = <span class="string">@"select * from Test;"</span>;</span><br><span class="line">        FMResultSet *resultSet = [database executeQuery:sql];</span><br><span class="line">        <span class="keyword">while</span> (resultSet<span class="variable">.next</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//[resultSet dataForColumn:@"image"];</span></span><br><span class="line"></span><br><span class="line">            <span class="built_in">NSData</span> *imageData = [resultSet dataForColumnIndex:<span class="number">2</span>];</span><br><span class="line">            <span class="built_in">UIImageView</span> *imageView = [[<span class="built_in">UIImageView</span> alloc] initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">300</span>, <span class="number">300</span>)];</span><br><span class="line"></span><br><span class="line">            imageView<span class="variable">.image</span> = [<span class="built_in">UIImage</span> imageWithData:imageData];</span><br><span class="line">            [<span class="keyword">self</span><span class="variable">.view</span> addSubview:imageView];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;];</span><br></pre></td></tr></table></figure></p>
<p>åˆ†æä¸€ä¸‹çº¿ç¨‹å®‰å…¨ä¸‹çš„FMDBçš„å®ç°ï¼š<br>åœ¨å½“ä½¿ç”¨FMDBDatabaseQueueåˆ›å»ºæ•°æ®åº“æ—¶ï¼Œä¼šä½¿ç”¨GCDåˆ›å»ºä¸€ä¸ªçº¿ç¨‹é˜Ÿåˆ—ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ã€‚ã€‚ã€‚</span><br><span class="line"> _queue = dispatch_queue_create([[<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"fmdb.%@"</span>, <span class="keyword">self</span>] UTF8String], <span class="literal">NULL</span>);</span><br><span class="line">        dispatch_queue_set_specific(_queue, kDispatchQueueSpecificKey, (__bridge <span class="keyword">void</span> *)<span class="keyword">self</span>, <span class="literal">NULL</span>);</span><br><span class="line">        _openFlags = openFlags;</span><br><span class="line">ã€‚ã€‚ã€‚</span><br></pre></td></tr></table></figure></p>
<p>ç„¶ååœ¨è¯»å–æ—¶è°ƒç”¨<code>[queue inDatabase:^(FMDatabase *db)</code>æ–¹æ³•ï¼Œåœ¨blockä¸­ä¼šé”å®šå½“å‰æ•°æ®åº“<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">dispatch_sync</span>(_queue, ^() &#123;</span><br><span class="line">        FMDatabase *db = [<span class="keyword">self</span> database];</span><br><span class="line">        block(db);</span><br><span class="line">	â€¦â€¦</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®é™…ä¸Šè¿™é‡Œæ˜¯å¯¹æ•´ä¸ªæ•°æ®åº“è¿›è¡ŒåŠ é”ï¼Œä»¥æ­¤æ¥ä¿è¯çº¿ç¨‹å®‰å…¨çš„ã€‚</p>
<h3>äºŒã€CoreDataçš„çº¿ç¨‹å®‰å…¨</h3>

<p>1.æ²¡æœ‰çº¿ç¨‹å®‰å…¨çš„coredataæ•°æ®è¯»å–ï¼š</p>
<p>NSManagedObjectContextå¯¹è±¡çš„åˆ›å»ºï¼š<code>_managedObjectContext = [[NSManagedObjectContext alloc] init];</code></p>
<p>æ’å…¥æ•°æ®æ“ä½œï¼šï¼ˆAppDetailModalä¸ºæ•°æ®æ¨¡å‹ï¼‰</p>
<p>context ä¸ºè¿”å›çš„ _managedObjectContext<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AppDetailModal *newapp = [<span class="built_in">NSEntityDescription</span> insertNewObjectForEntityForName:TableName inManagedObjectContext:context];</span><br></pre></td></tr></table></figure></p>
<p>å…¶ä»–æŸ¥è¯¢ã€æ›´æ–°ã€åˆ é™¤æ“ä½œ<br>//è·å–Entity<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSEntityDescription</span> *entity = [<span class="built_in">NSEntityDescription</span> entityForName:TableName inManagedObjectContext:context];</span><br></pre></td></tr></table></figure></p>
<p>2.çº¿ç¨‹å®‰å…¨çš„coreDataæ“ä½œï¼š</p>
<p>é¦–å…ˆåˆ›å»ºå¹¶è¡Œçš„NSManagedObjectContextå¯¹è±¡<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSManagedObjectContext</span>* context=[[<span class="built_in">NSManagedObjectContext</span> alloc] initWithConcurrencyType:<span class="built_in">NSPrivateQueueConcurrencyType</span>];</span><br></pre></td></tr></table></figure></p>
<p>ç„¶ååœ¨æ‰§è¡Œè¯»å–æ“ä½œæ—¶ä½¿ç”¨ä¸€ä¸‹ä¸¤ä¸ªæ–¹æ³•ï¼š</p>
<ul>
<li><p>-(void)performBlock:(void (^)(void))block</p>
</li>
<li><p>-(void)performBlockAndWait:(void (^)(void))block   </p>
</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[context performBlock:^&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è¦æ‰§è¡Œçš„è¯»å–æ“ä½œ</span></span><br><span class="line"></span><br><span class="line"> &#125;];</span><br></pre></td></tr></table></figure>
]]></content>
    <summary type="html">
    <![CDATA[<p>æ•°æ®åº“è¯»å–æ“ä½œä¸€èˆ¬éƒ½æ˜¯å¤šçº¿ç¨‹è®¿é—®çš„ã€‚åœ¨å¯¹æ•°æ®è¿›è¡Œè¯»å–æ—¶ï¼Œæˆ‘ä»¬è¦ä¿è¯å…¶å½“å‰çŠ¶æ€ä¸èƒ½è¢«ä¿®æ”¹ï¼Œå³è¯»å–æ—¶åŠ é”ï¼Œå¦åˆ™å°±ä¼šå‡ºç°æ•°æ®é”™è¯¯æ··ä¹±ã€‚<br>IOSä¸­å¸¸ç”¨çš„ä¸¤ç§æ•°æ®æŒä¹…åŒ–å­˜å‚¨æ–¹å¼ï¼šCoreDataå’ŒSQLiteï¼Œä¸¤è€…éƒ½éœ€è¦è®¾ç½®çº¿ç¨‹å®‰å…¨ï¼Œåœ¨è¿™é‡Œä»¥FMDBæ¥è§£é‡Šå¯¹SQLiteçš„çº¿ç¨‹å®‰å…¨è®¿é—®ã€‚</p>]]>
    
    </summary>
    
      <category term="CoreData" scheme="http://koalahl.github.io/tags/CoreData/"/>
    
      <category term="SQLite" scheme="http://koalahl.github.io/tags/SQLite/"/>
    
      <category term="iOS" scheme="http://koalahl.github.io/categories/iOS/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[ã€ŠiOSå¼€å‘è¿›é˜¶ã€‹é˜…è¯»ç¬”è®°ï¼ˆäºŒï¼‰â€”â€”å¼€å‘æŠ€å·§]]></title>
    <link href="http://koalahl.github.io/2015/12/13/%E3%80%8AiOS%E5%BC%80%E5%8F%91%E8%BF%9B%E9%98%B6%E3%80%8B%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89%E2%80%94%E2%80%94%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7/"/>
    <id>http://koalahl.github.io/2015/12/13/ã€ŠiOSå¼€å‘è¿›é˜¶ã€‹é˜…è¯»ç¬”è®°ï¼ˆäºŒï¼‰â€”â€”å¼€å‘æŠ€å·§/</id>
    <published>2015-12-13T11:24:48.000Z</published>
    <updated>2015-12-13T11:24:48.000Z</updated>
    <content type="html"><![CDATA[<h3 id="keyboard">æ”¶èµ·é”®ç›˜</h3>

<p>åœ¨UIViewControllerä¸­æ”¶èµ·é”®ç›˜ï¼Œå¤„äº†è°ƒç”¨ç›¸åº”æ§ä»¶çš„resignFirstResponderæ–¹æ³•å¤–ï¼Œè¿˜æœ‰å¦å¤–ä¸‰ç§æ–¹æ³•ï¼š</p>
<ul>
<li>é‡è½½UIViewControllerçš„touchBeginæ–¹æ³•ï¼Œç„¶ååœ¨é‡Œé¢æ‰§è¡Œ<code>[self.view endEditing:YES];</code>,è¿™æ ·å•å‡»UIViewControllerçš„ä»»æ„åœ°æ–¹ï¼Œå°±å¯ä»¥æ”¶èµ·é”®ç›˜ï¼›</li>
<li>ç›´æ¥æ‰§è¡Œ<code>[[UIApplicatoin sharedApplication] sendAction:@selector(resignFirstResponder) to:nil from:nil forEvent:nil];</code>,ç”¨äºåœ¨è·å¾—å½“å‰UIViewControlleræ¯”è¾ƒå›°éš¾çš„æ—¶å€™ä½¿ç”¨ã€‚</li>
<li>ç›´æ¥æ‰§è¡Œ<code>[[[UIApplicatoin sharedApplication] keyWindow] endEditing:YES];</code>ã€‚</li>
</ul>
<a id="more"></a>
<h3 id="json">NSJSONSerializationæ¯”NSKeyedArchiveræ›´å¥½</h3>

<p>åœ¨é€‰æ‹©æŒä¹…åŒ–æ–¹æ¡ˆæ—¶ï¼Œç³»ç»Ÿæä¾›çš„<code>NSJSONSerialization</code>æ¯”<code>NSKeyedArchiver</code>åœ¨æ•ˆç‡å’Œä½“ç§¯ä¸Šéƒ½æ›´ä¼˜ï¼Œæ›´è¯¦ç»†çš„æµ‹è¯•å‚è€ƒï¼š<a href="https://github.com/randomsequence/NSSerialisationTests" target="_blank" rel="external">https://github.com/randomsequence/NSSerialisationTests</a>;</p>
<h3 id="language">è®¾ç½®åº”ç”¨å†…çš„ç³»ç»Ÿæ§ä»¶è¯­è¨€</h3>

<p>åœ¨å·¥ç¨‹çš„info.plistæ–‡ä»¶ä¸­å¢åŠ å¦‚ä¸‹å†…å®¹ï¼š<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">key</span>&gt;</span>CFBundleLocalizations<span class="tag">&lt;/<span class="title">key</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">array</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">string</span>&gt;</span>zh_CN<span class="tag">&lt;/<span class="title">string</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">string</span>&gt;</span>en<span class="tag">&lt;/<span class="title">string</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">array</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="snapshot">å·§ç”¨ç³»ç»Ÿçš„æˆªå±åŠŸèƒ½</h3>

<p>iOS7ä»¥åï¼Œappleæä¾›çš„ç³»ç»Ÿçš„æˆªå±APIï¼š<code>- (UIView *)snapshotViewAfterScreenUpdates:(BOOL)afterUpdates</code>æ¥å®ç°æˆªå±åŠŸèƒ½ã€‚è€Œå¯¹äºiOS7ä»¥å‰çš„ç³»ç»Ÿï¼Œå¯ä»¥ç”¨è¿‡ä»£ç æ¥å®ç°æˆªå±åŠŸèƒ½ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">+ (<span class="built_in">UIImage</span> *)captureImageFromView:(<span class="built_in">UIView</span> *)view&#123;</span><br><span class="line">	<span class="built_in">CGRect</span> screenRect = [view bounds];</span><br><span class="line">	<span class="built_in">UIGraphicsBeginImageContext</span>(screenRect<span class="variable">.size</span>);</span><br><span class="line">	<span class="built_in">CGContextRef</span> ctx = <span class="built_in">UIGraphicsGetCurrentContext</span>();</span><br><span class="line">	[view<span class="variable">.layer</span> renderInContext:ctx];</span><br><span class="line">	<span class="built_in">UIImage</span> *image = <span class="built_in">UIGraphicsGetImageFromCurrentImageContext</span>();</span><br><span class="line">	<span class="built_in">UIGraphicsEndImageContext</span>();</span><br><span class="line">	<span class="keyword">return</span> image;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="js">Javascriptæ–‡ä»¶è®¾ç½®è°ƒæ•´</h3>

<p>Javascriptçš„jsåç¼€çš„æ–‡ä»¶é»˜è®¤è¢«æ‹–åŠ¨åˆ°å·¥ç¨‹ä¸­åï¼Œæ˜¯åœ¨ç¼–è¯‘åˆ—è¡¨ä¸­ï¼Œè€Œä¸æ˜¯èµ„æºåˆ—è¡¨ä¸­ã€‚éœ€è¦æ‰‹åŠ¨è°ƒæ•´æœŸä½ç½®ï¼Œå¦åˆ™å®ƒå°±ä¸èƒ½æ‰“åŒ…åˆ°ipaæ–‡ä»¶ä¸­ã€‚</p>
<p>æ³¨ï¼šxcode7å·²ç»ä¿®æ”¹æ­¤é—®é¢˜ï¼Œå¦‚ä¸‹å›¾ï¼š<br><img src="/img/xcode7_js.png" alt="xcode7_js"></p>
<h3 id="warning">å¿½ç•¥ç¼–è¯‘è­¦å‘Š</h3>

<p>åœ¨Build Phaseä¸­å¯¹åº”çš„æ–‡ä»¶ä¸­æ·»åŠ  <code>-w</code>å‚æ•°ã€‚</p>
<p></p><h3 id="NSLog">å®šåˆ¶NSLog</h3><br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#ifdef DEBUG</span></span><br><span class="line"><span class="preprocessor">#define NSLog(args,...) NSLog(@<span class="title">"-%d%s:%@"</span>,__LINE__,__FUNCTION__,[NSString stringWithFormat:(args), ##__VA_ARGS__])</span></span><br><span class="line"><span class="preprocessor">#else</span></span><br><span class="line"><span class="preprocessor">#define NSLog(...)</span></span><br><span class="line"><span class="preprocessor">#endif</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><h3 id="hideNav">å¯¼èˆªæ ä¸Šçš„ä¸€äº›è®¾ç½®</h3><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#21435;&#25481;&#23548;&#33322;&#26639;&#38452;&#24433;&#40657;&#32447;&#12290;setBackGroundImage&#20013;&#20063;&#21487;&#20197;&#30452;&#25509;&#20351;&#29992;[UIImage new]&#10;UINavigationBar *navBar = self.navigationController.navigationBar;&#10;[navBar setBackgroundImage:[UIImage imageNamed:@&#34;white_backgroud&#34;] forBarPosition:UIBarPositionAny barMetrics:UIBarMetricsDefault];&#10;[navBar setShadowImage:[UIImage new]];&#10;&#10;&#21435;&#25481;searchBar&#30340;&#38452;&#24433;&#10;[self.searchBar setBackgroundImage:[UIImage new]];</span><br></pre></td></tr></table></figure><p></p>
]]></content>
    <summary type="html">
    <![CDATA[<h3 id = "keyboard">æ”¶èµ·é”®ç›˜</h3>

<p>åœ¨UIViewControllerä¸­æ”¶èµ·é”®ç›˜ï¼Œå¤„äº†è°ƒç”¨ç›¸åº”æ§ä»¶çš„resignFirstResponderæ–¹æ³•å¤–ï¼Œè¿˜æœ‰å¦å¤–ä¸‰ç§æ–¹æ³•ï¼š</p>
<ul>
<li>é‡è½½UIViewControllerçš„touchBeginæ–¹æ³•ï¼Œç„¶ååœ¨é‡Œé¢æ‰§è¡Œ<code>[self.view endEditing:YES];</code>,è¿™æ ·å•å‡»UIViewControllerçš„ä»»æ„åœ°æ–¹ï¼Œå°±å¯ä»¥æ”¶èµ·é”®ç›˜ï¼›</li>
<li>ç›´æ¥æ‰§è¡Œ<code>[[UIApplicatoin sharedApplication] sendAction:@selector(resignFirstResponder) to:nil from:nil forEvent:nil];</code>,ç”¨äºåœ¨è·å¾—å½“å‰UIViewControlleræ¯”è¾ƒå›°éš¾çš„æ—¶å€™ä½¿ç”¨ã€‚</li>
<li>ç›´æ¥æ‰§è¡Œ<code>[[[UIApplicatoin sharedApplication] keyWindow] endEditing:YES];</code>ã€‚</li>
</ul>]]>
    
    </summary>
    
      <category term="ã€ŠiOSå¼€å‘è¿›é˜¶ã€‹é˜…è¯»ç¬”è®°" scheme="http://koalahl.github.io/tags/%E3%80%8AiOS%E5%BC%80%E5%8F%91%E8%BF%9B%E9%98%B6%E3%80%8B%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/"/>
    
      <category term="iOS" scheme="http://koalahl.github.io/categories/iOS/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[ã€ŠiOSå¼€å‘è¿›é˜¶ã€‹é˜…è¯»ç¬”è®°ï¼ˆä¸€ï¼‰å†…å­˜ç®¡ç†é‡Šç–‘]]></title>
    <link href="http://koalahl.github.io/2015/12/12/%E3%80%8AiOS%E5%BC%80%E5%8F%91%E8%BF%9B%E9%98%B6%E3%80%8B%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E9%87%8A%E7%96%91/"/>
    <id>http://koalahl.github.io/2015/12/12/ã€ŠiOSå¼€å‘è¿›é˜¶ã€‹é˜…è¯»ç¬”è®°ï¼ˆä¸€ï¼‰å†…å­˜ç®¡ç†é‡Šç–‘/</id>
    <published>2015-12-12T11:15:32.000Z</published>
    <updated>2015-12-12T11:15:32.000Z</updated>
    <content type="html"><![CDATA[<h3 id="arc">ARC</h3>

<p>ARCèƒ½å¤Ÿè§£å†³iOSå¼€å‘ä¸­90%çš„å†…å­˜ç®¡ç†é—®é¢˜ï¼Œä½†æ˜¯å¦å¤–è¿˜æœ‰10%çš„å†…å­˜ç®¡ç†æ˜¯éœ€è¦æ‰‹åŠ¨ç®¡ç†çš„ï¼Œä¸»è¦å°±æ˜¯ä¸åº•å±‚Core Foundationå¯¹è±¡äº¤äº’çš„éƒ¨åˆ†ï¼Œå› ä¸ºåº•å±‚Core Foundationå¯¹è±¡ç”±äºä¸åœ¨ARCçš„ç®¡ç†ä¸‹ã€‚</p>
<p>ä½¿ç”¨ARCéœ€è¦é¢å¤–æ³¨æ„çš„ä¸¤ä¸ªé—®é¢˜ï¼š<br>    1.è¿‡åº¦ä½¿ç”¨blockäº§ç”Ÿçš„å¾ªç¯å¼•ç”¨é—®é¢˜ã€‚<br>    2.åº•å±‚Core Foundationå¯¹è±¡éœ€è¦æ‰‹åŠ¨è¿›è¡Œå†…å­˜ç®¡ç†ã€‚<br><a id="more"></a></p>
<h3 id="corefoundation">Core Foundationå¯¹è±¡çš„å†…å­˜ç®¡ç†</h3>

<p>åº•å±‚çš„Core Foundationå¯¹è±¡çš„åˆ›å»ºï¼Œå¤§å¤šæ•°ä»¥XxxCreateWithXxxè¿™æ ·çš„æ–¹å¼åˆ›å»ºï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åˆ›å»ºä¸€ä¸ªCFStringRefå¯¹è±¡</span></span><br><span class="line">	<span class="built_in">CFStringRef</span> str = <span class="built_in">CFStringCreateWithCString</span>(k<span class="built_in">CFAllocatorDefault</span>,<span class="string">"hello world"</span>,k<span class="built_in">CFStringEncodingUTF8</span>);</span><br></pre></td></tr></table></figure>
<p>æˆ–è€…<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è®¾ç½®å­—é—´è·</span></span><br><span class="line">+ (<span class="built_in">NSAttributedString</span> *)setLabelAttributeString:(<span class="built_in">NSString</span>*)labelText withCharactorSpace:(<span class="built_in">CGFloat</span>)charactorSpace&#123;</span><br><span class="line">    <span class="built_in">NSMutableAttributedString</span> * string =[[<span class="built_in">NSMutableAttributedString</span> alloc]initWithString:labelText];</span><br><span class="line">    <span class="keyword">long</span> number = charactorSpace;</span><br><span class="line">    <span class="built_in">CFNumberRef</span> num = <span class="built_in">CFNumberCreate</span>(k<span class="built_in">CFAllocatorDefault</span>,k<span class="built_in">CFNumberSInt8Type</span>,&amp;number);</span><br><span class="line">    [string addAttribute:(<span class="keyword">id</span>)kCTKernAttributeName value:(__bridge <span class="keyword">id</span>)num range:<span class="built_in">NSMakeRange</span>(<span class="number">0</span>,[string length])];</span><br><span class="line">    <span class="built_in">CFRelease</span>(num);</span><br><span class="line">    <span class="keyword">return</span> string;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>å¯¹äºè¿™ç§å¯¹è±¡çš„ä¿®æ”¹å’Œé‡Šæ”¾ï¼Œéœ€è¦ç›¸åº”çš„ä½¿ç”¨CFRetainå’ŒCFReleaseã€‚<br>é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰å¦å¤–ä¸€ä¸ªé—®é¢˜éœ€è¦è§£å†³ã€‚åœ¨ARCä¸‹ï¼Œæˆ‘ä»¬æœ‰æ—¶éœ€è¦å°†ä¸€ä¸ªCore Foundationå¯¹è±¡è½¬æ¢æˆObjective-Cå¯¹è±¡ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬éœ€è¦å‘Šè¯‰ç¼–è¯‘å™¨ï¼Œè½¬æ¢è¿‡ç¨‹ä¸­çš„å¼•ç”¨è®¡æ•°å¦‚ä½•è°ƒæ•´ã€‚è¿™å°±å¼•å…¥äº†ä¸bridgeç›¸å…³çš„å…³é”®å­—ï¼š</p>
<ul>
<li><code>__bridge</code>:åªåšç±»å‹è½¬æ¢ï¼Œä¸ä¿®æ”¹ç›¸å…³å¯¹è±¡çš„å¼•ç”¨è®¡æ•°ï¼ŒåŸæ¥çš„Core Foundationå¯¹è±¡åœ¨ä¸ç”¨æ—¶ï¼Œéœ€è¦è°ƒç”¨CFReleaseæ–¹æ³•ã€‚</li>
<li><code>__bridge_retained</code>:ç±»å‹è½¬æ¢åï¼Œå°†ç›¸å…³å¯¹è±¡çš„å¼•ç”¨è®¡æ•°+1ï¼ŒåŸæ¥çš„Core Foundationå¯¹è±¡åœ¨ä¸ç”¨æ—¶ï¼Œéœ€è¦è°ƒç”¨CFReleaseæ–¹æ³•ã€‚</li>
<li><code>__bridge_transfer</code>:ç±»å‹è½¬æ¢åï¼Œå°†è¯¥å¯¹è±¡çš„å¼•ç”¨è®¡æ•°äº¤ç»™ARCç®¡ç†ï¼ŒCore Foundationå¯¹è±¡åœ¨ä¸ç”¨æ—¶ï¼Œä¸å†éœ€è¦è°ƒç”¨CFReleaseæ–¹æ³•ã€‚</li>
</ul>
<p>æˆ‘ä»¬æ ¹æ®ä¸šåŠ¡é€»è¾‘ï¼Œåˆç†ä½¿ç”¨ä¸Šé¢ä¸‰ç§è½¬æ¢å…³é”®å­—ï¼Œå°±å¯ä»¥è§£å†³Core Foundationå¯¹è±¡ä¸Objcå¯¹è±¡ç›¸äº’è½¬æ¢çš„é—®é¢˜äº†ã€‚</p>
]]></content>
    <summary type="html">
    <![CDATA[<h3 id="arc">ARC</h3>

<p>ARCèƒ½å¤Ÿè§£å†³iOSå¼€å‘ä¸­90%çš„å†…å­˜ç®¡ç†é—®é¢˜ï¼Œä½†æ˜¯å¦å¤–è¿˜æœ‰10%çš„å†…å­˜ç®¡ç†æ˜¯éœ€è¦æ‰‹åŠ¨ç®¡ç†çš„ï¼Œä¸»è¦å°±æ˜¯ä¸åº•å±‚Core Foundationå¯¹è±¡äº¤äº’çš„éƒ¨åˆ†ï¼Œå› ä¸ºåº•å±‚Core Foundationå¯¹è±¡ç”±äºä¸åœ¨ARCçš„ç®¡ç†ä¸‹ã€‚</p>
<p>ä½¿ç”¨ARCéœ€è¦é¢å¤–æ³¨æ„çš„ä¸¤ä¸ªé—®é¢˜ï¼š<br>    1.è¿‡åº¦ä½¿ç”¨blockäº§ç”Ÿçš„å¾ªç¯å¼•ç”¨é—®é¢˜ã€‚<br>    2.åº•å±‚Core Foundationå¯¹è±¡éœ€è¦æ‰‹åŠ¨è¿›è¡Œå†…å­˜ç®¡ç†ã€‚<br>]]>
    
    </summary>
    
      <category term="ã€ŠiOSå¼€å‘è¿›é˜¶ã€‹é˜…è¯»ç¬”è®°" scheme="http://koalahl.github.io/tags/%E3%80%8AiOS%E5%BC%80%E5%8F%91%E8%BF%9B%E9%98%B6%E3%80%8B%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/"/>
    
      <category term="iOS" scheme="http://koalahl.github.io/categories/iOS/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[iOSä¸­å¤„ç†å››èˆäº”å…¥çš„é—®é¢˜]]></title>
    <link href="http://koalahl.github.io/2015/12/05/iOS%E4%B8%AD%E5%A4%84%E7%90%86%E5%9B%9B%E8%88%8D%E4%BA%94%E5%85%A5%E7%9A%84%E9%97%AE%E9%A2%98/"/>
    <id>http://koalahl.github.io/2015/12/05/iOSä¸­å¤„ç†å››èˆäº”å…¥çš„é—®é¢˜/</id>
    <published>2015-12-05T14:45:34.000Z</published>
    <updated>2015-12-05T14:45:34.000Z</updated>
    <content type="html"><![CDATA[<p>å¤„ç†å››èˆäº”å…¥ä¸»è¦ä½¿ç”¨ä¸‹é¢è¿™ä¸ªæ–¹æ³•ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">-(<span class="built_in">NSString</span> *)notRounding:(<span class="keyword">float</span>)price afterPoint:(<span class="keyword">int</span>)position&#123;</span><br><span class="line">Â Â Â Â <span class="built_in">NSDecimalNumberHandler</span>* roundingBehavior = [<span class="built_in">NSDecimalNumberHandler</span> decimalNumberHandlerWithRoundingMode:<span class="built_in">NSRoundDown</span> scale:position raiseOnExactness:<span class="literal">NO</span> raiseOnOverflow:<span class="literal">NO</span> raiseOnUnderflow:<span class="literal">NO</span> raiseOnDivideByZero:<span class="literal">NO</span>];</span><br><span class="line">Â Â Â Â <span class="built_in">NSDecimalNumber</span> *ouncesDecimal;</span><br><span class="line">Â Â Â Â <span class="built_in">NSDecimalNumber</span> *roundedOunces;</span><br><span class="line">Â Â Â Â </span><br><span class="line">Â Â Â Â ouncesDecimal = [[<span class="built_in">NSDecimalNumber</span> alloc] initWithFloat:price];</span><br><span class="line">Â Â Â Â roundedOunces = [ouncesDecimal decimalNumberByRoundingAccordingToBehavior:roundingBehavior];</span><br><span class="line">Â Â Â Â [ouncesDecimal release];</span><br><span class="line">Â Â Â Â <span class="keyword">return</span> [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"%@"</span>,roundedOunces];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>ä»‹ç»ä¸€ä¸‹å‚æ•°ï¼š<br><code>price</code>:éœ€è¦å¤„ç†çš„æ•°å­—ï¼Œ<br><code>position</code>ï¼šä¿ç•™å°æ•°ç‚¹ç¬¬å‡ ä½ï¼Œ<br>ç„¶åè°ƒç”¨<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">float</span> s =<span class="number">0.126</span>;</span><br><span class="line">Â Â Â Â <span class="built_in">NSString</span> *sb = [<span class="keyword">self</span> notRounding:s afterPoint:<span class="number">2</span>];</span><br><span class="line">Â Â Â Â <span class="built_in">NSLog</span>(<span class="string">@"sb = %@"</span>,sb);</span><br><span class="line">è¾“å‡ºç»“æœä¸ºï¼šsb = <span class="number">0.12</span></span><br></pre></td></tr></table></figure></p>
<p>æ¥ä¸‹æ¥ä»‹ç»NSDecimalNumberHandleråˆå§‹åŒ–æ—¶çš„å…³é”®å‚æ•°ï¼šdecimalNumberHandlerWithRoundingModeï¼šNSRoundDownï¼Œ<br><code>NSRoundDown</code>ä»£è¡¨çš„å°±æ˜¯ åªèˆä¸å…¥ã€‚<br>scaleçš„å‚æ•°<code>position</code>ä»£è¡¨ä¿ç•™å°æ•°ç‚¹åå‡ ä½ã€‚</p>
<a id="more"></a>]]></content>
    <summary type="html">
    <![CDATA[<p>å¤„ç†å››èˆäº”å…¥ä¸»è¦ä½¿ç”¨ä¸‹é¢è¿™ä¸ªæ–¹æ³•ï¼š<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">-(<span class="built_in">NSString</span> *)notRounding:(<span class="keyword">float</span>)price afterPoint:(<span class="keyword">int</span>)position&#123;</span><br><span class="line">Â Â Â Â <span class="built_in">NSDecimalNumberHandler</span>* roundingBehavior = [<span class="built_in">NSDecimalNumberHandler</span> decimalNumberHandlerWithRoundingMode:<span class="built_in">NSRoundDown</span> scale:position raiseOnExactness:<span class="literal">NO</span> raiseOnOverflow:<span class="literal">NO</span> raiseOnUnderflow:<span class="literal">NO</span> raiseOnDivideByZero:<span class="literal">NO</span>];</span><br><span class="line">Â Â Â Â <span class="built_in">NSDecimalNumber</span> *ouncesDecimal;</span><br><span class="line">Â Â Â Â <span class="built_in">NSDecimalNumber</span> *roundedOunces;</span><br><span class="line">Â Â Â Â </span><br><span class="line">Â Â Â Â ouncesDecimal = [[<span class="built_in">NSDecimalNumber</span> alloc] initWithFloat:price];</span><br><span class="line">Â Â Â Â roundedOunces = [ouncesDecimal decimalNumberByRoundingAccordingToBehavior:roundingBehavior];</span><br><span class="line">Â Â Â Â [ouncesDecimal release];</span><br><span class="line">Â Â Â Â <span class="keyword">return</span> [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"%@"</span>,roundedOunces];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>ä»‹ç»ä¸€ä¸‹å‚æ•°ï¼š<br><code>price</code>:éœ€è¦å¤„ç†çš„æ•°å­—ï¼Œ<br><code>position</code>ï¼šä¿ç•™å°æ•°ç‚¹ç¬¬å‡ ä½ï¼Œ<br>ç„¶åè°ƒç”¨<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">float</span> s =<span class="number">0.126</span>;</span><br><span class="line">Â Â Â Â <span class="built_in">NSString</span> *sb = [<span class="keyword">self</span> notRounding:s afterPoint:<span class="number">2</span>];</span><br><span class="line">Â Â Â Â <span class="built_in">NSLog</span>(<span class="string">@"sb = %@"</span>,sb);</span><br><span class="line">è¾“å‡ºç»“æœä¸ºï¼šsb = <span class="number">0.12</span></span><br></pre></td></tr></table></figure></p>
<p>æ¥ä¸‹æ¥ä»‹ç»NSDecimalNumberHandleråˆå§‹åŒ–æ—¶çš„å…³é”®å‚æ•°ï¼šdecimalNumberHandlerWithRoundingModeï¼šNSRoundDownï¼Œ<br><code>NSRoundDown</code>ä»£è¡¨çš„å°±æ˜¯ åªèˆä¸å…¥ã€‚<br>scaleçš„å‚æ•°<code>position</code>ä»£è¡¨ä¿ç•™å°æ•°ç‚¹åå‡ ä½ã€‚</p>]]>
    
    </summary>
    
      <category term="skills" scheme="http://koalahl.github.io/tags/skills/"/>
    
      <category term="iOS" scheme="http://koalahl.github.io/categories/iOS/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Categoryæ·»åŠ å±æ€§æ‰€æƒ³åˆ°çš„]]></title>
    <link href="http://koalahl.github.io/2015/12/03/Category%E6%B7%BB%E5%8A%A0%E5%B1%9E%E6%80%A7%E6%89%80%E6%83%B3%E5%88%B0%E7%9A%84/"/>
    <id>http://koalahl.github.io/2015/12/03/Categoryæ·»åŠ å±æ€§æ‰€æƒ³åˆ°çš„/</id>
    <published>2015-12-03T14:34:41.000Z</published>
    <updated>2016-01-17T13:49:20.000Z</updated>
    <content type="html"><![CDATA[<p>iOSä¸­categoryå’Œextensionç›¸è¾…ç›¸æˆï¼Œé•¿å¾—ä¹Ÿå¾ˆç›¸ä¼¼ã€‚categoryä¸extensionçš„ä¸»è¦åŒºåˆ«ï¼š</p>
<p>Categoryï¼šåˆ†ç±»ã€ç±»åˆ«</p>
<ul>
<li>categoryä¸»è¦ç”¨æ¥å¢åŠ ç±»çš„æ–¹æ³•ï¼Œå¹¶ä¸”é€‚ç”¨äºå­ç±»ã€‚</li>
<li>categoryä¸èƒ½æ·»åŠ å®ä¾‹å˜é‡ï¼ˆè¿™ä¸ªå¹¶ä¸æ˜¯å±æ€§ï¼‰ï¼Œå¯ä»¥æ·»åŠ readonlyçš„å±æ€§ã€‚</li>
<li>å¦‚æœè¦æ·»åŠ readwriteçš„å±æ€§çš„è¯ï¼Œéœ€è¦ç”¨åˆ°runtimeæ–¹æ³•ã€‚</li>
</ul>
<p>Extensionï¼šæ‰©å±•</p>
<ul>
<li>å¯ä»¥å¢åŠ è¢«æ‰©å±•ç±»çš„å±æ€§å’Œæ–¹æ³•ã€‚</li>
<li>Extensionå¯ä»¥ç†è§£ä¸ºåŒ¿åç±»åˆ«ã€‚</li>
<li>å®šä¹‰çš„æ–¹æ³•å¿…é¡»åœ¨implementationä¸­å®ç°ã€‚</li>
</ul>
<a id="more"></a>
<p>ä¸‹é¢ä¸»è¦çœ‹çœ‹categoryçš„ä½¿ç”¨ï¼š<br>1.æ·»åŠ readonlyå±æ€§</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">UITableViewCell</span> (<span class="title">AccessoryView</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">///åœ¨Cellå³ä¾§æ·»åŠ çš„ä¸€ä¸ªè‡ªå®šä¹‰label</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">strong</span>,<span class="keyword">readonly</span>)<span class="built_in">UILabel</span> *accessoryLabel;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">strong</span>,<span class="keyword">readonly</span>)<span class="built_in">UIImageView</span> *accessoryImageView;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p>.mæ–‡ä»¶ä¸­é‡å†™getteræ–¹æ³•</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">UITableViewCell</span> (<span class="title">AccessoryView</span>)</span></span><br><span class="line"></span><br><span class="line">- (<span class="built_in">UILabel</span> *)accessoryLabel&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">id</span> obj <span class="keyword">in</span> <span class="keyword">self</span><span class="variable">.subviews</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> ([obj class] == [<span class="built_in">UILabel</span> class]) &#123;</span><br><span class="line">            [obj removeFromSuperview];<span class="comment">//å› ä¸ºaccessoryLabelæ˜¯æ·»åŠ åœ¨cellä¸Šçš„ï¼Œè€Œæ²¡æœ‰åœ¨cell.contentViewä¸Šã€‚</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">UILabel</span> * accessoryLabel = [[<span class="built_in">UILabel</span> alloc]initWithFrame:<span class="built_in">CGRectMake</span>(kWidth-<span class="number">200</span>, <span class="number">0</span>, <span class="number">160</span>, <span class="built_in">CGRectGetHeight</span>(<span class="keyword">self</span><span class="variable">.frame</span>))];</span><br><span class="line">    accessoryLabel<span class="variable">.textColor</span> = [<span class="built_in">UIColor</span> lightGrayColor];</span><br><span class="line">    accessoryLabel<span class="variable">.font</span>      = [<span class="built_in">UIFont</span> systemFontOfSize:<span class="number">12</span>];</span><br><span class="line">    accessoryLabel<span class="variable">.textAlignment</span> = <span class="built_in">NSTextAlignmentRight</span>;</span><br><span class="line">    [<span class="keyword">self</span> addSubview:accessoryLabel];</span><br><span class="line">    <span class="keyword">return</span>  accessoryLabel;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">UIImageView</span> *)accessoryImageView&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">id</span> obj <span class="keyword">in</span> <span class="keyword">self</span><span class="variable">.subviews</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> ([obj class] == [<span class="built_in">UIImageView</span> class]) &#123;</span><br><span class="line">            [obj removeFromSuperview];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">UIImageView</span> *accessoryImageView = [[<span class="built_in">UIImageView</span> alloc]initWithFrame:<span class="built_in">CGRectMake</span>(kWidth-<span class="number">100</span>, <span class="number">10</span>, <span class="number">60</span>, <span class="number">60</span>)];</span><br><span class="line">    accessoryImageView<span class="variable">.layer</span><span class="variable">.cornerRadius</span> = <span class="number">30</span>;</span><br><span class="line">    accessoryImageView<span class="variable">.layer</span><span class="variable">.masksToBounds</span> = <span class="literal">YES</span>;</span><br><span class="line">    [<span class="keyword">self</span> addSubview:accessoryImageView];</span><br><span class="line">    <span class="keyword">return</span> accessoryImageView;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p>å¦‚æœæˆ‘ä»¬æ·»åŠ ä¸€ä¸ªæ™®é€šçš„å±æ€§<code>@property (nonatomic,strong)NSString * name;</code>,é‚£ä¹ˆimplementationä¸­ä¼šæŠ¥warningï¼š</p>
<p><img src="/img/category_1.png" alt="category"></p>
<p>2.è¿è¡Œæ—¶æ·»åŠ å±æ€§ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">NSError</span> (<span class="title">Message</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">copy</span>)<span class="built_in">NSString</span> * errorMsg;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p>.m</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> * strKey = &amp;strKey;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">NSError</span> (<span class="title">Message</span>)</span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)setErrorMsg:(<span class="built_in">NSString</span> *)errorMsg&#123;</span><br><span class="line">    objc_setAssociatedObject(<span class="keyword">self</span>, &amp; strKey, errorMsg, OBJC_ASSO<span class="built_in">CIATION_COPY_NONATOMIC</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">NSString</span> *)errorMsg&#123;</span><br><span class="line">    <span class="keyword">return</span> objc_getAssociatedObject(<span class="keyword">self</span>, &amp;strKey);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p>åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œå¤§å¤šæ•°æ—¶å€™è¿˜æ˜¯ç”¨çš„categoryè¾ƒå¤šã€‚åé¢ä¼šç»™å‡ºä¸€äº›å¸¸ç”¨çš„ç±»çš„categoryã€‚</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>iOSä¸­categoryå’Œextensionç›¸è¾…ç›¸æˆï¼Œé•¿å¾—ä¹Ÿå¾ˆç›¸ä¼¼ã€‚categoryä¸extensionçš„ä¸»è¦åŒºåˆ«ï¼š</p>
<p>Categoryï¼šåˆ†ç±»ã€ç±»åˆ«</p>
<ul>
<li>categoryä¸»è¦ç”¨æ¥å¢åŠ ç±»çš„æ–¹æ³•ï¼Œå¹¶ä¸”é€‚ç”¨äºå­ç±»ã€‚</li>
<li>categoryä¸èƒ½æ·»åŠ å®ä¾‹å˜é‡ï¼ˆè¿™ä¸ªå¹¶ä¸æ˜¯å±æ€§ï¼‰ï¼Œå¯ä»¥æ·»åŠ readonlyçš„å±æ€§ã€‚</li>
<li>å¦‚æœè¦æ·»åŠ readwriteçš„å±æ€§çš„è¯ï¼Œéœ€è¦ç”¨åˆ°runtimeæ–¹æ³•ã€‚</li>
</ul>
<p>Extensionï¼šæ‰©å±•</p>
<ul>
<li>å¯ä»¥å¢åŠ è¢«æ‰©å±•ç±»çš„å±æ€§å’Œæ–¹æ³•ã€‚</li>
<li>Extensionå¯ä»¥ç†è§£ä¸ºåŒ¿åç±»åˆ«ã€‚</li>
<li>å®šä¹‰çš„æ–¹æ³•å¿…é¡»åœ¨implementationä¸­å®ç°ã€‚</li>
</ul>]]>
    
    </summary>
    
      <category term="category" scheme="http://koalahl.github.io/tags/category/"/>
    
      <category term="iOS" scheme="http://koalahl.github.io/categories/iOS/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[å¸¸ç”¨æ’åºç®—æ³•]]></title>
    <link href="http://koalahl.github.io/2015/11/30/%E5%B8%B8%E7%94%A8%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/"/>
    <id>http://koalahl.github.io/2015/11/30/å¸¸ç”¨æ’åºç®—æ³•/</id>
    <published>2015-11-30T02:02:57.000Z</published>
    <updated>2016-11-28T05:46:49.000Z</updated>
    <content type="html"><![CDATA[<p>åœ¨æ­¤æ€»ç»“ä¸€ä¸‹å¸¸ç”¨æ’åºç®—æ³•çš„ä»£ç å®ç°</p>
<p><code>#include &lt;iostream&gt;</code><br><code>using namespace std;</code><br><code>typedef int ElemType;</code></p>
<p>/*<br>1ã€æ’å…¥æ’åº<br>ï¼ˆ1ï¼‰ç›´æ¥æ’å…¥æ’åºç®—æ³•<br>ç®—æ³•æ€æƒ³ï¼šå°†ç­‰æ’åºåˆ—åˆ’åˆ†ä¸ºæœ‰åºä¸æ— åºä¸¤éƒ¨åˆ†ï¼Œç„¶åå†ä¾æ¬¡å°†æ— åºéƒ¨åˆ†æ’å…¥åˆ°å·²ç»æœ‰åºçš„éƒ¨åˆ†ï¼Œæœ€å</p>
<p>å°±å¯ä»¥å½¢æˆæœ‰åºåºåˆ—ã€‚<br>æ“ä½œæ­¥éª¤å¦‚ä¸‹ï¼š<br>1ï¼‰æŸ¥æ‰¾å‡ºå…ƒç´ Lï¼ˆiï¼‰åœ¨è¡¨ä¸­çš„æ’å…¥ä½ç½®Kï¼›<br>2ï¼‰å°†è¡¨ä¸­çš„ç¬¬Kä¸ªå…ƒç´ ä¹‹å‰çš„å…ƒç´ ä¾æ¬¡åç§»ä¸€ä¸ªä½ç½®ï¼›<br>3ï¼‰å°†Lï¼ˆiï¼‰å¤åˆ¶åˆ°Lï¼ˆKï¼‰ã€‚<br> */<br>æ—¶é—´å¤æ‚åº¦ä¸ºï¼šO(n^2)</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">InsertSort</span><span class="params">(ElemType arr[], <span class="keyword">int</span> length)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i, j;</span><br><span class="line">    ElemType guard; <span class="comment">// å“¨å…µ</span></span><br><span class="line"></span><br><span class="line"> <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt; length; ++i)</span><br><span class="line"> &#123;</span><br><span class="line">   <span class="keyword">if</span> (arr[i]() &lt; arr[i-<span class="number">1</span>]()) <span class="comment">// åœ¨æ— åºéƒ¨åˆ†å¯»æ‰¾ä¸€ä¸ªå…ƒç´ ï¼Œä½¿ä¹‹æ’å…¥åˆ°æœ‰åºéƒ¨åˆ†åä»ç„¶æœ‰åº</span></span><br><span class="line"> 	&#123;</span><br><span class="line">	guard = arr[i]();<span class="comment">// å¤åˆ¶åˆ°â€œå“¨å…µâ€</span></span><br><span class="line">	<span class="comment">// å°†ç¬¬iä¸ªå…ƒç´ ä¹‹å‰çš„å…ƒç´ ä¾æ¬¡åç§»ä¸€ä¸ªä½ç½®</span></span><br><span class="line">	<span class="keyword">for</span> (j = i - <span class="number">1</span>; arr[j]() &gt; guard; j--)</span><br><span class="line">	&#123;</span><br><span class="line">		arr[j + <span class="number">1</span>]() = arr[j]();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	arr[j + <span class="number">1</span>]() = guard; <span class="comment">// å¤åˆ¶åˆ°æ’å…¥ä½ç½®</span></span><br><span class="line">	&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<a id="more"></a>
<p>2ã€æŠ˜åŠæ’å…¥æ’åº<br>  ä½¿ç”¨äºæ’åºè¡¨ä¸ºé¡ºåºå­˜å‚¨çš„çº¿æ€§è¡¨<br>  åœ¨æŸ¥æ‰¾æ’å…¥ä½ç½®æ—¶ï¼Œé‡‡ç”¨æŠ˜åŠæŸ¥æ‰¾<br>  ç®—æ³•æ€æƒ³æ˜¯ï¼š<br>  1ï¼‰è®¾ç½®æŠ˜åŠæŸ¥æ‰¾èŒƒå›´ï¼›<br>  2ï¼‰æŠ˜åŠæŸ¥æ‰¾<br>  3ï¼‰ç§»åŠ¨å…ƒç´ <br>  4ï¼‰æ’å…¥å…ƒç´ <br>  5ï¼‰ç»§ç»­æ“ä½œ1ï¼‰ã€2ï¼‰ã€3ï¼‰ã€4ï¼‰æ­¥ï¼Œç›´åˆ°è¡¨æˆæœ‰åºã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">BinaryInsertSort</span><span class="params">(ElemType arr[], <span class="keyword">int</span> length)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i, j, low, high, mid;</span><br><span class="line">    ElemType tmp;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">1</span>; i &lt; length; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      tmp = arr[i](); <span class="comment">// å¤åˆ¶åˆ°å“¨å…µ</span></span><br><span class="line">      <span class="comment">// è®¾ç½®æŠ˜åŠæŸ¥æ‰¾èŒƒå›´</span></span><br><span class="line">      low = <span class="number">0</span>;</span><br><span class="line">      high = i;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">while</span> (low &lt;= high) <span class="comment">// æŠ˜åŠæŸ¥æ‰¾</span></span><br><span class="line">      &#123;</span><br><span class="line">        mid = (low + high) / <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (arr[mid]() &gt; tmp) <span class="comment">// åœ¨å·¦åŠéƒ¨åˆ†æŸ¥æ‰¾</span></span><br><span class="line">        &#123;</span><br><span class="line">          high = mid - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">          low = mid + <span class="number">1</span>; <span class="comment">// åœ¨å³åŠéƒ¨åˆ†æŸ¥æ‰¾</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// ç§»åŠ¨å…ƒç´ </span></span><br><span class="line">      <span class="keyword">for</span> ( j = i - <span class="number">1</span>; j &gt;= high + <span class="number">1</span>; --j )</span><br><span class="line">      &#123;</span><br><span class="line">        arr[j + <span class="number">1</span>]() = arr[j]();</span><br><span class="line">      &#125;</span><br><span class="line">      arr[j + <span class="number">1</span>]() = tmp;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>/*<br>3ã€å¸Œå°”(Shell)æ’åº<br>   åŸºæœ¬æ€æƒ³ï¼š<br>   å…ˆå°†å¾…æ’åºçš„è¡¨åˆ†å‰²æˆè‹¥å¹²ä¸ªå½¢è‹¥L[i, i+d, i+2d, â€¦, i+kd]çš„â€œç‰¹æ®Šâ€å­è¡¨ï¼Œåˆ†åˆ«è¿›è¡Œç›´æ¥æ’å…¥æ’åºï¼Œ<br>   å½“æ•´ä¸ªè¡¨å·²å‘ˆâ€œåŸºæœ¬æœ‰åºâ€æ—¶ï¼Œå†å¯¹å…¨ä½“è®°å½•è¿›è¡Œä¸€æ¬¡ç›´æ¥æ’å…¥æ’åºã€‚<br>   ç®—æ³•è¿‡ç¨‹ï¼š<br>   1ï¼‰å…ˆå–ä¸€ä¸ªå°äºnçš„æ­¥é•¿d1,æŠŠè¡¨ä¸­å…¨éƒ¨è®°å½•åˆ†æˆd1ä¸ªç»„ï¼Œæ‰€æœ‰è·ç¦»ä¸ºd1çš„å€æ•°çš„è®°å½•æ”¾åœ¨åŒä¸€ç»„ä¸­ï¼Œåœ¨å„<br>  ç»„ä¸­è¿›è¡Œç›´æ¥æ’å…¥æ’åºï¼›<br>   2ï¼‰ç„¶åå–ç¬¬äºŒä¸ªæ­¥é•¿d2 \&lt; d1, é‡å¤æ­¥éª¤1<br>   3ï¼‰ç›´åˆ°dk = 1ï¼Œå†è¿›è¡Œæœ€åä¸€æ¬¡ç›´æ¥æ’å…¥æ’åº<br>*/</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ShellSort</span><span class="params">(ElemType arr[], <span class="keyword">int</span> length)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i, j, dk = length / <span class="number">2</span>;</span><br><span class="line">    ElemType tmp;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (dk &gt;= <span class="number">1</span>)<span class="comment">// æ§åˆ¶æ­¥é•¿</span></span><br><span class="line">    &#123;</span><br><span class="line">    	<span class="keyword">for</span> (i = dk; i &lt; length; ++i)</span><br><span class="line">    	&#123;</span><br><span class="line">      	<span class="keyword">if</span> (arr[i]() &lt; arr[i - dk]())</span><br><span class="line">      	 &#123;</span><br><span class="line">      		tmp = arr[i](); <span class="comment">// æš‚å­˜</span></span><br><span class="line"></span><br><span class="line">      		<span class="comment">// åç§»</span></span><br><span class="line">      		<span class="keyword">for</span> (j = i - dk; j &gt;= <span class="number">0</span> &amp;&amp; tmp &lt; arr[j](); j -= dk)</span><br><span class="line">      		&#123;</span><br><span class="line">      		  arr[j + dk]() = arr[j]();</span><br><span class="line">      		&#125;</span><br><span class="line">          arr[j + dk]() = tmp;</span><br><span class="line">      	&#125;</span><br><span class="line">    	&#125;</span><br><span class="line"></span><br><span class="line">    	dk /= <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>*<br>4ã€å†’æ³¡æ’åºç®—æ³•<br>   åŸºæœ¬æ€æƒ³ï¼š<br>   å‡è®¾å¾…æ’åºçš„è¡¨é•¿ä¸ºnï¼Œ ä»åå‘å‰æˆ–ä»å‰å‘åä¸¤ä¸¤æ¯”è¾ƒç›¸é‚»å…ƒç´ çš„å€¼ï¼Œè‹¥ä¸ºé€†åºï¼Œåˆ™äº¤æ¢ä¹‹ï¼Œç›´åˆ°åºåˆ—æ¯”è¾ƒå®Œã€‚<br>   è¿™æ ·ä¸€å›å°±ç§°ä¸ºä¸€è¶Ÿå†’æ³¡ã€‚è¿™æ ·å€¼è¾ƒå¤§çš„å…ƒç´ å¾€ä¸‹â€œæ²‰â€ï¼Œè€Œå€¼è¾ƒå°çš„å…ƒç´ å…¥ä¸Šâ€œæµ®â€ã€‚<br>   æ—¶é—´å¤æ‚åº¦ä¸ºO(n^2)<br>*/</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">BubbleSort</span><span class="params">(ElemType arr[], <span class="keyword">int</span> length)</span></span><br><span class="line"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i, j,k;</span><br><span class="line">  ElemType tmp;</span><br><span class="line">  <span class="keyword">for</span> (k = <span class="number">0</span>; k &lt; length; ++i)<span class="comment">// è¶Ÿæ¬¡æ€»å…±å¾ªç¯lengthæ¬¡</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; length - <span class="number">1</span>; ++i)<span class="comment">//ä¸¤ä¸¤æ¯”è¾ƒ</span></span><br><span class="line">      &#123;</span><br><span class="line">        j = i + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (arr[j]() &gt; arr[i]())</span><br><span class="line">        &#123;</span><br><span class="line">          tmp = arr[i]();</span><br><span class="line">          arr[i]() = arr[j]();</span><br><span class="line">          arr[j]() = tmp;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>/*<br>5ã€å¿«é€Ÿæ’åºç®—æ³•<br>   åŸºæœ¬æ€æƒ³ï¼šåŸºäºåˆ†æ²»æ³•ï¼Œåœ¨å¾…æ’åºçš„nä¸ªå…ƒç´ ä¸­ä»»å–ä¸€ä¸ªå…ƒç´ pivotä½œä¸ºåŸºå‡†ï¼Œé€šè¿‡ä¸€è¶Ÿæ’åºå°†å¾…æ’åºè¡¨åˆ’åˆ†ä¸ºç‹¬ç«‹çš„<br>   ä¸¤éƒ¨åˆ†L[1..k-1]å’ŒL[k+1 .. n],ä½¿å¾—ç¬¬ä¸€éƒ¨åˆ†ä¸­çš„æ‰€æœ‰å…ƒç´ å€¼éƒ½å°äºpivotï¼Œè€Œç¬¬äºŒéƒ¨åˆ†ä¸­çš„æ‰€æœ‰å…ƒç´ å€¼éƒ½å¤§äºpivotï¼Œ<br>   åˆ™åŸºå‡†å…ƒç´ æ”¾åœ¨äº†å…¶æœ€ç»ˆä½ç½®Lï¼ˆKï¼‰ä¸Šï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸ºä¸€è¶Ÿå¿«é€Ÿæ’åºã€‚è€Œååˆ†åˆ«é€’å½’åœ°å¯¹ä¸¤ä¸ªå­è¡¨é‡å¤ä¸Šè¿°è¿‡ç¨‹ï¼Œç›´åˆ°æ¯<br>   éƒ¨åˆ†å†…åªæœ‰ä¸€ä¸ªå…ƒç´ æˆ–ä¸ºç©ºä¸ºæ­¢ï¼Œå³æ‰€æœ‰å…ƒç´ éƒ½æ”¾åœ¨äº†å…¶æœ€ç»ˆä½ç½®ä¸Šã€‚<br>*/</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Partition</span><span class="params">(ElemType arr[], <span class="keyword">int</span> left, <span class="keyword">int</span> right)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    ElemType pivot = arr[left]; <span class="comment">// ä»¥å½“å‰è¡¨ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ ä¸ºæ¢è½´å€¼</span></span><br><span class="line"></span><br><span class="line">     <span class="keyword">while</span> (left \&lt; right)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// ä»å³å‘å·¦æ‰¾ä¸€ä¸ªæ¯”æ¢è½´å€¼å°çš„å…ƒç´ çš„ä½ç½®</span></span><br><span class="line">        <span class="keyword">while</span> (left \&lt; right &amp;&amp; arr[right]() \&gt;= pivot)</span><br><span class="line">        &#123;</span><br><span class="line">          --right;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        arr[left]() = arr[right](); <span class="comment">// å°†æ¯”æ¢è½´å€¼å°çš„å…ƒç´ ç§»åŠ¨åˆ°å·¦ç«¯</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä»å·¦å‘å³æŸ¥æ‰¾æ¯”æ¢è½´å€¼å¤§çš„å…ƒç´ çš„ä½ç½®</span></span><br><span class="line">        <span class="keyword">while</span> (left \&lt; right &amp;&amp; arr[left]() \&lt;= pivot)</span><br><span class="line">        &#123;</span><br><span class="line">          ++left;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">       arr[right]() = arr[left]();<span class="comment">// å°†æ¯”æ¢è½´å€¼å¤§çš„å…ƒç´ ç§»åŠ¨åˆ°å³ç«¯</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    arr[left]() = pivot; <span class="comment">// å°†æ¢è½´å…ƒç´ æ”¾åœ¨æœ€ç»ˆä½ç½®</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> left;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">QuickSort</span><span class="params">(ElemType arr[], <span class="keyword">int</span> left, <span class="keyword">int</span> right)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (left \&lt; right)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> pivotPos = Partition(arr, left, right); <span class="comment">// åˆ’åˆ†</span></span><br><span class="line">        QuickSort(arr, left, pivotPos - <span class="number">1</span>); <span class="comment">// å¿«é€Ÿæ’åºå·¦åŠéƒ¨åˆ†</span></span><br><span class="line">        QuickSort(arr, pivotPos + <span class="number">1</span>, right); <span class="comment">// å¿«é€Ÿæ’åºå³åŠéƒ¨åˆ†</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>/*<br>6ã€ç®€å•é€‰æ‹©æ’åºç®—æ³•<br>   åŸºæœ¬æ€æƒ³ï¼š<br>   å‡è®¾æ’åºè¡¨ä¸ºL[1â€¦n],ç¬¬iè¶Ÿæ’åºä»è¡¨ä¸­é€‰æ‹©å…³é”®å­—æœ€å°çš„å…ƒç´ ä¸Liäº¤æ¢ï¼Œç¬¬ä¸€è¶Ÿæ’åºå¯ä»¥ç¡®å®šä¸€ä¸ªå…ƒç´ çš„<br>   æœ€ç»ˆä½ç½®ï¼Œè¿™æ ·ç»è¿‡n-1è¶Ÿæ’åºå°±å¯ä»¥ä½¿å¾—æ•´ä¸ªæ’åºè¡¨æœ‰åºã€‚<br>*/</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SelectSort</span><span class="params">(ElemType arr[], <span class="keyword">int</span> length)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i, j, min;</span><br><span class="line">    ElemType tmp;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i \&lt; length - <span class="number">1</span>; ++i) <span class="comment">// éœ€è¦n-1è¶Ÿ</span></span><br><span class="line">    &#123;</span><br><span class="line">    min = i;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (j = i + <span class="number">1</span>; j \&lt; length; ++j)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> (arr[j]() \&lt; arr[min]()) <span class="comment">// æ¯ä¸€è¶Ÿé€‰æ‹©å…ƒç´ å€¼æœ€å°çš„ä¸‹æ ‡</span></span><br><span class="line">      &#123;</span><br><span class="line">        min = j;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (min != i) <span class="comment">// å¦‚æœç¬¬iè¶Ÿçš„Liå…ƒç´ å€¼è¯¥è¶Ÿæ‰¾åˆ°çš„æœ€å°å…ƒç´ å€¼ï¼Œåˆ™äº¤æ¢ï¼Œä»¥ä½¿Liå€¼æœ€å°</span></span><br><span class="line">    &#123;</span><br><span class="line">          tmp = arr[i]();</span><br><span class="line">          arr[i]() = arr[min]();</span><br><span class="line">          arr[min]() = tmp;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>/*<br>7ã€å †æ’åºç®—æ³•<br> å †çš„å®šä¹‰å¦‚ä¸‹ï¼šnä¸ªå…³é”®å­—åºåˆ—å·L<a href="">1..n</a>ç§°ä¸ºå †ï¼Œä»…å½“è¯¥åºåˆ—æ»¡è¶³ï¼š<br>1ï¼‰L(i) \&lt;= L(2i)ä¸”L(i) \&lt;= L(2i+1) æˆ– 2)L(i) >= L(2i)ä¸”L(i) >= L(2i+1)<br>æ»¡è¶³ç¬¬ä¸€ç§æƒ…å†µçš„å †ï¼Œç§°ä¸ºå°æ ¹å †ï¼ˆå°é¡¶å †ï¼‰ï¼›<br>æ»¡è¶³ç¬¬äºŒç§æƒ…å†µçš„å †ï¼Œç§°ä¸ºå¤§æ ¹å †ï¼ˆå¤§é¡¶å †ï¼‰ã€‚<br>*/</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">HeapAdjust</span><span class="params">(ElemType \*a,<span class="keyword">int</span> i,<span class="keyword">int</span> size)</span>  <span class="comment">//è°ƒæ•´å †</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> lchild = <span class="number">2</span> \* i;       <span class="comment">//içš„å·¦å­©å­èŠ‚ç‚¹åºå·</span></span><br><span class="line">    <span class="keyword">int</span> rchild = <span class="number">2</span> \* i + <span class="number">1</span>;     <span class="comment">//içš„å³å­©å­èŠ‚ç‚¹åºå·</span></span><br><span class="line">    <span class="keyword">int</span> max = i;            <span class="comment">//ä¸´æ—¶å˜é‡</span></span><br><span class="line">   <span class="keyword">if</span>(i \&lt;= size / <span class="number">2</span>)          <span class="comment">//å¦‚æœiæ˜¯å¶èŠ‚ç‚¹å°±ä¸ç”¨è¿›è¡Œè°ƒæ•´</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (lchild \&lt;= size &amp;&amp; a[lchild]() \&gt; a[max]())</span><br><span class="line">&#123;</span><br><span class="line">max = lchild; <span class="comment">// å·¦å­©å­æ¯”åŒäº²å€¼è¿˜å¤§ï¼Œéœ€è¦è°ƒæ•´</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (rchild \&lt;= size &amp;&amp; a[rchild]() \&gt; a[max]())</span><br><span class="line">&#123;</span><br><span class="line">max = rchild;<span class="comment">// å³å­©å­æ¯”åŒäº²å€¼è¿˜å¤§ï¼Œéœ€è¦è°ƒæ•´</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (max != i) <span class="comment">// éœ€è¦è°ƒæ•´</span></span><br><span class="line">&#123;</span><br><span class="line">ElemType tmp = a[max]();</span><br><span class="line">a[max]() = a[i]();</span><br><span class="line">a[i]() = tmp;</span><br><span class="line"></span><br><span class="line">HeapAdjust(a, max, size);    <span class="comment">//é¿å…è°ƒæ•´ä¹‹åä»¥maxä¸ºçˆ¶èŠ‚ç‚¹çš„å­æ ‘ä¸æ˜¯å †</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">BuildHeap</span><span class="params">(ElemType \*a,<span class="keyword">int</span> size)</span>    <span class="comment">//å»ºç«‹å †</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = size / <span class="number">2</span>; i \&gt;= <span class="number">0</span>; i--)    <span class="comment">//éå¶èŠ‚ç‚¹æœ€å¤§åºå·å€¼ä¸ºsize/2</span></span><br><span class="line">    &#123;</span><br><span class="line">        HeapAdjust(a, i, size);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">HeapSort</span><span class="params">(ElemType \*a, <span class="keyword">int</span> size)</span>    <span class="comment">//å †æ’åº</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    BuildHeap(a,size);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = size - <span class="number">1</span>; i \&gt;= <span class="number">0</span>; i--)</span><br><span class="line">&#123;</span><br><span class="line">swap(a[<span class="number">0</span>](), a[i]());           <span class="comment">//äº¤æ¢å †é¡¶å’Œæœ€åä¸€ä¸ªå…ƒç´ ï¼Œå³æ¯æ¬¡å°†å‰©ä½™å…ƒç´ ä¸­çš„æœ€å¤§è€…æ”¾åˆ°æœ€åé¢</span></span><br><span class="line">BuildHeap(a, i-<span class="number">1</span>);        <span class="comment">//å°†ä½™ä¸‹å…ƒç´ é‡æ–°å»ºç«‹ä¸ºå¤§é¡¶å †</span></span><br><span class="line">HeapAdjust(a,<span class="number">1</span>,i-<span class="number">1</span>);      <span class="comment">//é‡æ–°è°ƒæ•´å †é¡¶èŠ‚ç‚¹æˆä¸ºå¤§é¡¶å †</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Display</span><span class="params">(ElemType arr[], <span class="keyword">int</span> length)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> ( <span class="keyword">int</span> i = <span class="number">0</span>; i \&lt; length; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">cout</span> \&lt;\&lt; arr[i] \&lt;\&lt; <span class="string">" "</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"> <span class="built_in">cout</span> \&lt;\&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    ElemType arr[] = &#123;<span class="number">2</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">9</span>, -<span class="number">1</span>, <span class="number">4</span>, <span class="number">12</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//InsertSort(arr, sizeof(arr) / sizeof(ElemType));</span></span><br><span class="line"><span class="comment">//BinaryInsertSort(arr, sizeof(arr) / sizeof(ElemType));</span></span><br><span class="line"><span class="comment">//ShellSort(arr, sizeof(arr) / sizeof(ElemType));</span></span><br><span class="line"><span class="comment">//BubbleSort(arr, sizeof(arr) / sizeof(ElemType));</span></span><br><span class="line"><span class="comment">//QuickSort(arr, 0,  sizeof(arr) / sizeof(ElemType) - 1);</span></span><br><span class="line">HeapSort(arr, <span class="keyword">sizeof</span>(arr) / <span class="keyword">sizeof</span>(ElemType));</span><br><span class="line">Display(arr, <span class="keyword">sizeof</span>(arr) / <span class="keyword">sizeof</span>(ElemType));</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
    <summary type="html">
    <![CDATA[<p>åœ¨æ­¤æ€»ç»“ä¸€ä¸‹å¸¸ç”¨æ’åºç®—æ³•çš„ä»£ç å®ç°</p>
<p><code>#include &lt;iostream&gt;</code><br><code>using namespace std;</code><br><code>typedef int ElemType;</code></p>
<p>/*<br>1ã€æ’å…¥æ’åº<br>ï¼ˆ1ï¼‰ç›´æ¥æ’å…¥æ’åºç®—æ³•<br>ç®—æ³•æ€æƒ³ï¼šå°†ç­‰æ’åºåˆ—åˆ’åˆ†ä¸ºæœ‰åºä¸æ— åºä¸¤éƒ¨åˆ†ï¼Œç„¶åå†ä¾æ¬¡å°†æ— åºéƒ¨åˆ†æ’å…¥åˆ°å·²ç»æœ‰åºçš„éƒ¨åˆ†ï¼Œæœ€å</p>
<p>å°±å¯ä»¥å½¢æˆæœ‰åºåºåˆ—ã€‚<br>æ“ä½œæ­¥éª¤å¦‚ä¸‹ï¼š<br>1ï¼‰æŸ¥æ‰¾å‡ºå…ƒç´ Lï¼ˆiï¼‰åœ¨è¡¨ä¸­çš„æ’å…¥ä½ç½®Kï¼›<br>2ï¼‰å°†è¡¨ä¸­çš„ç¬¬Kä¸ªå…ƒç´ ä¹‹å‰çš„å…ƒç´ ä¾æ¬¡åç§»ä¸€ä¸ªä½ç½®ï¼›<br>3ï¼‰å°†Lï¼ˆiï¼‰å¤åˆ¶åˆ°Lï¼ˆKï¼‰ã€‚<br> */<br>æ—¶é—´å¤æ‚åº¦ä¸ºï¼šO(n^2)</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">InsertSort</span><span class="params">(ElemType arr[], <span class="keyword">int</span> length)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i, j;</span><br><span class="line">    ElemType guard; <span class="comment">// å“¨å…µ</span></span><br><span class="line"></span><br><span class="line"> <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt; length; ++i)</span><br><span class="line"> &#123;</span><br><span class="line">   <span class="keyword">if</span> (arr[i]() &lt; arr[i-<span class="number">1</span>]()) <span class="comment">// åœ¨æ— åºéƒ¨åˆ†å¯»æ‰¾ä¸€ä¸ªå…ƒç´ ï¼Œä½¿ä¹‹æ’å…¥åˆ°æœ‰åºéƒ¨åˆ†åä»ç„¶æœ‰åº</span></span><br><span class="line"> 	&#123;</span><br><span class="line">	guard = arr[i]();<span class="comment">// å¤åˆ¶åˆ°â€œå“¨å…µâ€</span></span><br><span class="line">	<span class="comment">// å°†ç¬¬iä¸ªå…ƒç´ ä¹‹å‰çš„å…ƒç´ ä¾æ¬¡åç§»ä¸€ä¸ªä½ç½®</span></span><br><span class="line">	<span class="keyword">for</span> (j = i - <span class="number">1</span>; arr[j]() &gt; guard; j--)</span><br><span class="line">	&#123;</span><br><span class="line">		arr[j + <span class="number">1</span>]() = arr[j]();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	arr[j + <span class="number">1</span>]() = guard; <span class="comment">// å¤åˆ¶åˆ°æ’å…¥ä½ç½®</span></span><br><span class="line">	&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]>
    
    </summary>
    
      <category term="ç®—æ³•" scheme="http://koalahl.github.io/tags/%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
</feed>
